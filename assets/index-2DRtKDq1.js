const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginPage-Lbv75vD2.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/LoginPage-CyOiVeEu.css","assets/RegisterPage-DY-lMGyp.js","assets/RegisterPage-jWXPWIIz.css","assets/DashboardPage-CY5k7_dd.js","assets/campaigns-DDFTsJkA.js","assets/DashboardPage-BB3d_PfE.css","assets/CampaignPage-BFzve2pE.js","assets/CampaignPage-CiiUdwbQ.css"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function df(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Le={},ii=[],xn=()=>{},fy=()=>!1,ll=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),pf=t=>t.startsWith("onUpdate:"),dt=Object.assign,mf=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Xw=Object.prototype.hasOwnProperty,Pe=(t,e)=>Xw.call(t,e),ie=Array.isArray,oi=t=>ca(t)==="[object Map]",ul=t=>ca(t)==="[object Set]",$p=t=>ca(t)==="[object Date]",he=t=>typeof t=="function",Je=t=>typeof t=="string",Tn=t=>typeof t=="symbol",Ve=t=>t!==null&&typeof t=="object",dy=t=>(Ve(t)||he(t))&&he(t.then)&&he(t.catch),py=Object.prototype.toString,ca=t=>py.call(t),Jw=t=>ca(t).slice(8,-1),my=t=>ca(t)==="[object Object]",hl=t=>Je(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,To=df(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),fl=t=>{const e=Object.create(null);return(n=>e[n]||(e[n]=t(n)))},Zw=/-\w/g,cn=fl(t=>t.replace(Zw,e=>e.slice(1).toUpperCase())),eA=/\B([A-Z])/g,Ur=fl(t=>t.replace(eA,"-$1").toLowerCase()),dl=fl(t=>t.charAt(0).toUpperCase()+t.slice(1)),Ru=fl(t=>t?`on${dl(t)}`:""),js=(t,e)=>!Object.is(t,e),rc=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},gy=(t,e,n,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:n})},pl=t=>{const e=parseFloat(t);return isNaN(e)?t:e},tA=t=>{const e=Je(t)?Number(t):NaN;return isNaN(e)?t:e};let Gp;const ml=()=>Gp||(Gp=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function gf(t){if(ie(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],r=Je(s)?iA(s):gf(s);if(r)for(const i in r)e[i]=r[i]}return e}else if(Je(t)||Ve(t))return t}const nA=/;(?![^(]*\))/g,sA=/:([^]+)/,rA=/\/\*[^]*?\*\//g;function iA(t){const e={};return t.replace(rA,"").split(nA).forEach(n=>{if(n){const s=n.split(sA);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function _f(t){let e="";if(Je(t))e=t;else if(ie(t))for(let n=0;n<t.length;n++){const s=_f(t[n]);s&&(e+=s+" ")}else if(Ve(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const oA="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",aA=df(oA);function _y(t){return!!t||t===""}function cA(t,e){if(t.length!==e.length)return!1;let n=!0;for(let s=0;n&&s<t.length;s++)n=gl(t[s],e[s]);return n}function gl(t,e){if(t===e)return!0;let n=$p(t),s=$p(e);if(n||s)return n&&s?t.getTime()===e.getTime():!1;if(n=Tn(t),s=Tn(e),n||s)return t===e;if(n=ie(t),s=ie(e),n||s)return n&&s?cA(t,e):!1;if(n=Ve(t),s=Ve(e),n||s){if(!n||!s)return!1;const r=Object.keys(t).length,i=Object.keys(e).length;if(r!==i)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!gl(t[o],e[o]))return!1}}return String(t)===String(e)}function lA(t,e){return t.findIndex(n=>gl(n,e))}const yy=t=>!!(t&&t.__v_isRef===!0),uA=t=>Je(t)?t:t==null?"":ie(t)||Ve(t)&&(t.toString===py||!he(t.toString))?yy(t)?uA(t.value):JSON.stringify(t,Ey,2):String(t),Ey=(t,e)=>yy(e)?Ey(t,e.value):oi(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,r],i)=>(n[Cu(s,i)+" =>"]=r,n),{})}:ul(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Cu(n))}:Tn(e)?Cu(e):Ve(e)&&!ie(e)&&!my(e)?String(e):e,Cu=(t,e="")=>{var n;return Tn(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};let At;class vy{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=At,!e&&At&&(this.index=(At.scopes||(At.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=At;try{return At=this,e()}finally{At=n}}}on(){++this._on===1&&(this.prevScope=At,At=this)}off(){this._on>0&&--this._on===0&&(At=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function Ty(t){return new vy(t)}function Iy(){return At}function hA(t,e=!1){At&&At.cleanups.push(t)}let Fe;const Su=new WeakSet;class wy{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,At&&At.active&&At.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Su.has(this)&&(Su.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ry(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Kp(this),Cy(this);const e=Fe,n=yn;Fe=this,yn=!0;try{return this.fn()}finally{Sy(this),Fe=e,yn=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)vf(e);this.deps=this.depsTail=void 0,Kp(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Su.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){lh(this)&&this.run()}get dirty(){return lh(this)}}let Ay=0,Io,wo;function Ry(t,e=!1){if(t.flags|=8,e){t.next=wo,wo=t;return}t.next=Io,Io=t}function yf(){Ay++}function Ef(){if(--Ay>0)return;if(wo){let e=wo;for(wo=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Io;){let e=Io;for(Io=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=n}}if(t)throw t}function Cy(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Sy(t){let e,n=t.depsTail,s=n;for(;s;){const r=s.prevDep;s.version===-1?(s===n&&(n=r),vf(s),fA(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=r}t.deps=e,t.depsTail=n}function lh(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(by(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function by(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Bo)||(t.globalVersion=Bo,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!lh(t))))return;t.flags|=2;const e=t.dep,n=Fe,s=yn;Fe=t,yn=!0;try{Cy(t);const r=t.fn(t._value);(e.version===0||js(r,t._value))&&(t.flags|=128,t._value=r,e.version++)}catch(r){throw e.version++,r}finally{Fe=n,yn=s,Sy(t),t.flags&=-3}}function vf(t,e=!1){const{dep:n,prevSub:s,nextSub:r}=t;if(s&&(s.nextSub=r,t.prevSub=void 0),r&&(r.prevSub=s,t.nextSub=void 0),n.subs===t&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)vf(i,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function fA(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let yn=!0;const Py=[];function ls(){Py.push(yn),yn=!1}function us(){const t=Py.pop();yn=t===void 0?!0:t}function Kp(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Fe;Fe=void 0;try{e()}finally{Fe=n}}}let Bo=0;class dA{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Tf{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Fe||!yn||Fe===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Fe)n=this.activeLink=new dA(Fe,this),Fe.deps?(n.prevDep=Fe.depsTail,Fe.depsTail.nextDep=n,Fe.depsTail=n):Fe.deps=Fe.depsTail=n,Ny(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=Fe.depsTail,n.nextDep=void 0,Fe.depsTail.nextDep=n,Fe.depsTail=n,Fe.deps===n&&(Fe.deps=s)}return n}trigger(e){this.version++,Bo++,this.notify(e)}notify(e){yf();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Ef()}}}function Ny(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)Ny(s)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Ec=new WeakMap,br=Symbol(""),uh=Symbol(""),jo=Symbol("");function Ct(t,e,n){if(yn&&Fe){let s=Ec.get(t);s||Ec.set(t,s=new Map);let r=s.get(n);r||(s.set(n,r=new Tf),r.map=s,r.key=n),r.track()}}function Jn(t,e,n,s,r,i){const o=Ec.get(t);if(!o){Bo++;return}const a=l=>{l&&l.trigger()};if(yf(),e==="clear")o.forEach(a);else{const l=ie(t),u=l&&hl(n);if(l&&n==="length"){const h=Number(s);o.forEach((d,m)=>{(m==="length"||m===jo||!Tn(m)&&m>=h)&&a(d)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),u&&a(o.get(jo)),e){case"add":l?u&&a(o.get("length")):(a(o.get(br)),oi(t)&&a(o.get(uh)));break;case"delete":l||(a(o.get(br)),oi(t)&&a(o.get(uh)));break;case"set":oi(t)&&a(o.get(br));break}}Ef()}function pA(t,e){const n=Ec.get(t);return n&&n.get(e)}function zr(t){const e=Se(t);return e===t?e:(Ct(e,"iterate",jo),en(t)?e:e.map(In))}function _l(t){return Ct(t=Se(t),"iterate",jo),t}function Os(t,e){return hs(t)?rs(t)?_i(In(e)):_i(e):In(e)}const mA={__proto__:null,[Symbol.iterator](){return bu(this,Symbol.iterator,t=>Os(this,t))},concat(...t){return zr(this).concat(...t.map(e=>ie(e)?zr(e):e))},entries(){return bu(this,"entries",t=>(t[1]=Os(this,t[1]),t))},every(t,e){return Gn(this,"every",t,e,void 0,arguments)},filter(t,e){return Gn(this,"filter",t,e,n=>n.map(s=>Os(this,s)),arguments)},find(t,e){return Gn(this,"find",t,e,n=>Os(this,n),arguments)},findIndex(t,e){return Gn(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Gn(this,"findLast",t,e,n=>Os(this,n),arguments)},findLastIndex(t,e){return Gn(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Gn(this,"forEach",t,e,void 0,arguments)},includes(...t){return Pu(this,"includes",t)},indexOf(...t){return Pu(this,"indexOf",t)},join(t){return zr(this).join(t)},lastIndexOf(...t){return Pu(this,"lastIndexOf",t)},map(t,e){return Gn(this,"map",t,e,void 0,arguments)},pop(){return so(this,"pop")},push(...t){return so(this,"push",t)},reduce(t,...e){return zp(this,"reduce",t,e)},reduceRight(t,...e){return zp(this,"reduceRight",t,e)},shift(){return so(this,"shift")},some(t,e){return Gn(this,"some",t,e,void 0,arguments)},splice(...t){return so(this,"splice",t)},toReversed(){return zr(this).toReversed()},toSorted(t){return zr(this).toSorted(t)},toSpliced(...t){return zr(this).toSpliced(...t)},unshift(...t){return so(this,"unshift",t)},values(){return bu(this,"values",t=>Os(this,t))}};function bu(t,e,n){const s=_l(t),r=s[e]();return s!==t&&!en(t)&&(r._next=r.next,r.next=()=>{const i=r._next();return i.done||(i.value=n(i.value)),i}),r}const gA=Array.prototype;function Gn(t,e,n,s,r,i){const o=_l(t),a=o!==t&&!en(t),l=o[e];if(l!==gA[e]){const d=l.apply(t,i);return a?In(d):d}let u=n;o!==t&&(a?u=function(d,m){return n.call(this,Os(t,d),m,t)}:n.length>2&&(u=function(d,m){return n.call(this,d,m,t)}));const h=l.call(o,u,s);return a&&r?r(h):h}function zp(t,e,n,s){const r=_l(t);let i=n;return r!==t&&(en(t)?n.length>3&&(i=function(o,a,l){return n.call(this,o,a,l,t)}):i=function(o,a,l){return n.call(this,o,Os(t,a),l,t)}),r[e](i,...s)}function Pu(t,e,n){const s=Se(t);Ct(s,"iterate",jo);const r=s[e](...n);return(r===-1||r===!1)&&yl(n[0])?(n[0]=Se(n[0]),s[e](...n)):r}function so(t,e,n=[]){ls(),yf();const s=Se(t)[e].apply(t,n);return Ef(),us(),s}const _A=df("__proto__,__v_isRef,__isVue"),ky=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Tn));function yA(t){Tn(t)||(t=String(t));const e=Se(this);return Ct(e,"has",t),e.hasOwnProperty(t)}class Dy{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,s){if(n==="__v_skip")return e.__v_skip;const r=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!r;if(n==="__v_isReadonly")return r;if(n==="__v_isShallow")return i;if(n==="__v_raw")return s===(r?i?bA:My:i?Vy:xy).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=ie(e);if(!r){let l;if(o&&(l=mA[n]))return l;if(n==="hasOwnProperty")return yA}const a=Reflect.get(e,n,Ye(e)?e:s);if((Tn(n)?ky.has(n):_A(n))||(r||Ct(e,"get",n),i))return a;if(Ye(a)){const l=o&&hl(n)?a:a.value;return r&&Ve(l)?fh(l):l}return Ve(a)?r?fh(a):la(a):a}}class Oy extends Dy{constructor(e=!1){super(!1,e)}set(e,n,s,r){let i=e[n];const o=ie(e)&&hl(n);if(!this._isShallow){const u=hs(i);if(!en(s)&&!hs(s)&&(i=Se(i),s=Se(s)),!o&&Ye(i)&&!Ye(s))return u||(i.value=s),!0}const a=o?Number(n)<e.length:Pe(e,n),l=Reflect.set(e,n,s,Ye(e)?e:r);return e===Se(r)&&(a?js(s,i)&&Jn(e,"set",n,s):Jn(e,"add",n,s)),l}deleteProperty(e,n){const s=Pe(e,n);e[n];const r=Reflect.deleteProperty(e,n);return r&&s&&Jn(e,"delete",n,void 0),r}has(e,n){const s=Reflect.has(e,n);return(!Tn(n)||!ky.has(n))&&Ct(e,"has",n),s}ownKeys(e){return Ct(e,"iterate",ie(e)?"length":br),Reflect.ownKeys(e)}}class EA extends Dy{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const vA=new Oy,TA=new EA,IA=new Oy(!0);const hh=t=>t,Ha=t=>Reflect.getPrototypeOf(t);function wA(t,e,n){return function(...s){const r=this.__v_raw,i=Se(r),o=oi(i),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,u=r[t](...s),h=n?hh:e?_i:In;return!e&&Ct(i,"iterate",l?uh:br),{next(){const{value:d,done:m}=u.next();return m?{value:d,done:m}:{value:a?[h(d[0]),h(d[1])]:h(d),done:m}},[Symbol.iterator](){return this}}}}function Wa(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function AA(t,e){const n={get(r){const i=this.__v_raw,o=Se(i),a=Se(r);t||(js(r,a)&&Ct(o,"get",r),Ct(o,"get",a));const{has:l}=Ha(o),u=e?hh:t?_i:In;if(l.call(o,r))return u(i.get(r));if(l.call(o,a))return u(i.get(a));i!==o&&i.get(r)},get size(){const r=this.__v_raw;return!t&&Ct(Se(r),"iterate",br),r.size},has(r){const i=this.__v_raw,o=Se(i),a=Se(r);return t||(js(r,a)&&Ct(o,"has",r),Ct(o,"has",a)),r===a?i.has(r):i.has(r)||i.has(a)},forEach(r,i){const o=this,a=o.__v_raw,l=Se(a),u=e?hh:t?_i:In;return!t&&Ct(l,"iterate",br),a.forEach((h,d)=>r.call(i,u(h),u(d),o))}};return dt(n,t?{add:Wa("add"),set:Wa("set"),delete:Wa("delete"),clear:Wa("clear")}:{add(r){!e&&!en(r)&&!hs(r)&&(r=Se(r));const i=Se(this);return Ha(i).has.call(i,r)||(i.add(r),Jn(i,"add",r,r)),this},set(r,i){!e&&!en(i)&&!hs(i)&&(i=Se(i));const o=Se(this),{has:a,get:l}=Ha(o);let u=a.call(o,r);u||(r=Se(r),u=a.call(o,r));const h=l.call(o,r);return o.set(r,i),u?js(i,h)&&Jn(o,"set",r,i):Jn(o,"add",r,i),this},delete(r){const i=Se(this),{has:o,get:a}=Ha(i);let l=o.call(i,r);l||(r=Se(r),l=o.call(i,r)),a&&a.call(i,r);const u=i.delete(r);return l&&Jn(i,"delete",r,void 0),u},clear(){const r=Se(this),i=r.size!==0,o=r.clear();return i&&Jn(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{n[r]=wA(r,t,e)}),n}function If(t,e){const n=AA(t,e);return(s,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(Pe(n,r)&&r in s?n:s,r,i)}const RA={get:If(!1,!1)},CA={get:If(!1,!0)},SA={get:If(!0,!1)};const xy=new WeakMap,Vy=new WeakMap,My=new WeakMap,bA=new WeakMap;function PA(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function NA(t){return t.__v_skip||!Object.isExtensible(t)?0:PA(Jw(t))}function la(t){return hs(t)?t:wf(t,!1,vA,RA,xy)}function Ly(t){return wf(t,!1,IA,CA,Vy)}function fh(t){return wf(t,!0,TA,SA,My)}function wf(t,e,n,s,r){if(!Ve(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=NA(t);if(i===0)return t;const o=r.get(t);if(o)return o;const a=new Proxy(t,i===2?s:n);return r.set(t,a),a}function rs(t){return hs(t)?rs(t.__v_raw):!!(t&&t.__v_isReactive)}function hs(t){return!!(t&&t.__v_isReadonly)}function en(t){return!!(t&&t.__v_isShallow)}function yl(t){return t?!!t.__v_raw:!1}function Se(t){const e=t&&t.__v_raw;return e?Se(e):t}function Af(t){return!Pe(t,"__v_skip")&&Object.isExtensible(t)&&gy(t,"__v_skip",!0),t}const In=t=>Ve(t)?la(t):t,_i=t=>Ve(t)?fh(t):t;function Ye(t){return t?t.__v_isRef===!0:!1}function is(t){return Fy(t,!1)}function kA(t){return Fy(t,!0)}function Fy(t,e){return Ye(t)?t:new DA(t,e)}class DA{constructor(e,n){this.dep=new Tf,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:Se(e),this._value=n?e:In(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,s=this.__v_isShallow||en(e)||hs(e);e=s?e:Se(e),js(e,n)&&(this._rawValue=e,this._value=s?e:In(e),this.dep.trigger())}}function qs(t){return Ye(t)?t.value:t}const OA={get:(t,e,n)=>e==="__v_raw"?t:qs(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const r=t[e];return Ye(r)&&!Ye(n)?(r.value=n,!0):Reflect.set(t,e,n,s)}};function Uy(t){return rs(t)?t:new Proxy(t,OA)}function xA(t){const e=ie(t)?new Array(t.length):{};for(const n in t)e[n]=MA(t,n);return e}class VA{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0,this._raw=Se(e);let r=!0,i=e;if(!ie(e)||!hl(String(n)))do r=!yl(i)||en(i);while(r&&(i=i.__v_raw));this._shallow=r}get value(){let e=this._object[this._key];return this._shallow&&(e=qs(e)),this._value=e===void 0?this._defaultValue:e}set value(e){if(this._shallow&&Ye(this._raw[this._key])){const n=this._object[this._key];if(Ye(n)){n.value=e;return}}this._object[this._key]=e}get dep(){return pA(this._raw,this._key)}}function MA(t,e,n){return new VA(t,e,n)}class LA{constructor(e,n,s){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Tf(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Bo-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&Fe!==this)return Ry(this,!0),!0}get value(){const e=this.dep.track();return by(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function FA(t,e,n=!1){let s,r;return he(t)?s=t:(s=t.get,r=t.set),new LA(s,r,n)}const $a={},vc=new WeakMap;let Er;function UA(t,e=!1,n=Er){if(n){let s=vc.get(n);s||vc.set(n,s=[]),s.push(t)}}function BA(t,e,n=Le){const{immediate:s,deep:r,once:i,scheduler:o,augmentJob:a,call:l}=n,u=$=>r?$:en($)||r===!1||r===0?Zn($,1):Zn($);let h,d,m,g,S=!1,P=!1;if(Ye(t)?(d=()=>t.value,S=en(t)):rs(t)?(d=()=>u(t),S=!0):ie(t)?(P=!0,S=t.some($=>rs($)||en($)),d=()=>t.map($=>{if(Ye($))return $.value;if(rs($))return u($);if(he($))return l?l($,2):$()})):he(t)?e?d=l?()=>l(t,2):t:d=()=>{if(m){ls();try{m()}finally{us()}}const $=Er;Er=h;try{return l?l(t,3,[g]):t(g)}finally{Er=$}}:d=xn,e&&r){const $=d,ee=r===!0?1/0:r;d=()=>Zn($(),ee)}const N=Iy(),O=()=>{h.stop(),N&&N.active&&mf(N.effects,h)};if(i&&e){const $=e;e=(...ee)=>{$(...ee),O()}}let B=P?new Array(t.length).fill($a):$a;const q=$=>{if(!(!(h.flags&1)||!h.dirty&&!$))if(e){const ee=h.run();if(r||S||(P?ee.some((oe,C)=>js(oe,B[C])):js(ee,B))){m&&m();const oe=Er;Er=h;try{const C=[ee,B===$a?void 0:P&&B[0]===$a?[]:B,g];B=ee,l?l(e,3,C):e(...C)}finally{Er=oe}}}else h.run()};return a&&a(q),h=new wy(d),h.scheduler=o?()=>o(q,!1):q,g=$=>UA($,!1,h),m=h.onStop=()=>{const $=vc.get(h);if($){if(l)l($,4);else for(const ee of $)ee();vc.delete(h)}},e?s?q(!0):B=h.run():o?o(q.bind(null,!0),!0):h.run(),O.pause=h.pause.bind(h),O.resume=h.resume.bind(h),O.stop=O,O}function Zn(t,e=1/0,n){if(e<=0||!Ve(t)||t.__v_skip||(n=n||new Map,(n.get(t)||0)>=e))return t;if(n.set(t,e),e--,Ye(t))Zn(t.value,e,n);else if(ie(t))for(let s=0;s<t.length;s++)Zn(t[s],e,n);else if(ul(t)||oi(t))t.forEach(s=>{Zn(s,e,n)});else if(my(t)){for(const s in t)Zn(t[s],e,n);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Zn(t[s],e,n)}return t}function ua(t,e,n,s){try{return s?t(...s):t()}catch(r){El(r,e,n)}}function wn(t,e,n,s){if(he(t)){const r=ua(t,e,n,s);return r&&dy(r)&&r.catch(i=>{El(i,e,n)}),r}if(ie(t)){const r=[];for(let i=0;i<t.length;i++)r.push(wn(t[i],e,n,s));return r}}function El(t,e,n,s=!0){const r=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Le;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const h=a.ec;if(h){for(let d=0;d<h.length;d++)if(h[d](t,l,u)===!1)return}a=a.parent}if(i){ls(),ua(i,null,10,[t,l,u]),us();return}}jA(t,n,r,s,o)}function jA(t,e,n,s=!0,r=!1){if(r)throw t;console.error(t)}const Lt=[];let Nn=-1;const ai=[];let xs=null,Xr=0;const By=Promise.resolve();let Tc=null;function vl(t){const e=Tc||By;return t?e.then(this?t.bind(this):t):e}function qA(t){let e=Nn+1,n=Lt.length;for(;e<n;){const s=e+n>>>1,r=Lt[s],i=qo(r);i<t||i===t&&r.flags&2?e=s+1:n=s}return e}function Rf(t){if(!(t.flags&1)){const e=qo(t),n=Lt[Lt.length-1];!n||!(t.flags&2)&&e>=qo(n)?Lt.push(t):Lt.splice(qA(e),0,t),t.flags|=1,jy()}}function jy(){Tc||(Tc=By.then(Hy))}function HA(t){ie(t)?ai.push(...t):xs&&t.id===-1?xs.splice(Xr+1,0,t):t.flags&1||(ai.push(t),t.flags|=1),jy()}function Qp(t,e,n=Nn+1){for(;n<Lt.length;n++){const s=Lt[n];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;Lt.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function qy(t){if(ai.length){const e=[...new Set(ai)].sort((n,s)=>qo(n)-qo(s));if(ai.length=0,xs){xs.push(...e);return}for(xs=e,Xr=0;Xr<xs.length;Xr++){const n=xs[Xr];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}xs=null,Xr=0}}const qo=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Hy(t){try{for(Nn=0;Nn<Lt.length;Nn++){const e=Lt[Nn];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),ua(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Nn<Lt.length;Nn++){const e=Lt[Nn];e&&(e.flags&=-2)}Nn=-1,Lt.length=0,qy(),Tc=null,(Lt.length||ai.length)&&Hy()}}let yt=null,Wy=null;function Ic(t){const e=yt;return yt=t,Wy=t&&t.type.__scopeId||null,e}function WA(t,e=yt,n){if(!e||t._n)return t;const s=(...r)=>{s._d&&Rc(-1);const i=Ic(e);let o;try{o=t(...r)}finally{Ic(i),s._d&&Rc(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function OM(t,e){if(yt===null)return t;const n=Rl(yt),s=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[i,o,a,l=Le]=e[r];i&&(he(i)&&(i={mounted:i,updated:i}),i.deep&&Zn(o),s.push({dir:i,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function mr(t,e,n,s){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];i&&(a.oldValue=i[o].value);let l=a.dir[s];l&&(ls(),wn(l,n,8,[t.el,a,t,e]),us())}}const $A=Symbol("_vte"),$y=t=>t.__isTeleport,Xn=Symbol("_leaveCb"),Ga=Symbol("_enterCb");function GA(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return eE(()=>{t.isMounted=!0}),tE(()=>{t.isUnmounting=!0}),t}const nn=[Function,Array],Gy={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:nn,onEnter:nn,onAfterEnter:nn,onEnterCancelled:nn,onBeforeLeave:nn,onLeave:nn,onAfterLeave:nn,onLeaveCancelled:nn,onBeforeAppear:nn,onAppear:nn,onAfterAppear:nn,onAppearCancelled:nn},Ky=t=>{const e=t.subTree;return e.component?Ky(e.component):e},KA={name:"BaseTransition",props:Gy,setup(t,{slots:e}){const n=Pf(),s=GA();return()=>{const r=e.default&&Yy(e.default(),!0);if(!r||!r.length)return;const i=zy(r),o=Se(t),{mode:a}=o;if(s.isLeaving)return Nu(i);const l=Yp(i);if(!l)return Nu(i);let u=dh(l,o,s,n,d=>u=d);l.type!==Nt&&Ho(l,u);let h=n.subTree&&Yp(n.subTree);if(h&&h.type!==Nt&&!Ir(h,l)&&Ky(n).type!==Nt){let d=dh(h,o,s,n);if(Ho(h,d),a==="out-in"&&l.type!==Nt)return s.isLeaving=!0,d.afterLeave=()=>{s.isLeaving=!1,n.job.flags&8||n.update(),delete d.afterLeave,h=void 0},Nu(i);a==="in-out"&&l.type!==Nt?d.delayLeave=(m,g,S)=>{const P=Qy(s,h);P[String(h.key)]=h,m[Xn]=()=>{g(),m[Xn]=void 0,delete u.delayedLeave,h=void 0},u.delayedLeave=()=>{S(),delete u.delayedLeave,h=void 0}}:h=void 0}else h&&(h=void 0);return i}}};function zy(t){let e=t[0];if(t.length>1){for(const n of t)if(n.type!==Nt){e=n;break}}return e}const zA=KA;function Qy(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function dh(t,e,n,s,r){const{appear:i,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:u,onAfterEnter:h,onEnterCancelled:d,onBeforeLeave:m,onLeave:g,onAfterLeave:S,onLeaveCancelled:P,onBeforeAppear:N,onAppear:O,onAfterAppear:B,onAppearCancelled:q}=e,$=String(t.key),ee=Qy(n,t),oe=(y,A)=>{y&&wn(y,s,9,A)},C=(y,A)=>{const w=A[1];oe(y,A),ie(y)?y.every(I=>I.length<=1)&&w():y.length<=1&&w()},E={mode:o,persisted:a,beforeEnter(y){let A=l;if(!n.isMounted)if(i)A=N||l;else return;y[Xn]&&y[Xn](!0);const w=ee[$];w&&Ir(t,w)&&w.el[Xn]&&w.el[Xn](),oe(A,[y])},enter(y){let A=u,w=h,I=d;if(!n.isMounted)if(i)A=O||u,w=B||h,I=q||d;else return;let v=!1;const ve=y[Ga]=Ge=>{v||(v=!0,Ge?oe(I,[y]):oe(w,[y]),E.delayedLeave&&E.delayedLeave(),y[Ga]=void 0)};A?C(A,[y,ve]):ve()},leave(y,A){const w=String(t.key);if(y[Ga]&&y[Ga](!0),n.isUnmounting)return A();oe(m,[y]);let I=!1;const v=y[Xn]=ve=>{I||(I=!0,A(),ve?oe(P,[y]):oe(S,[y]),y[Xn]=void 0,ee[w]===t&&delete ee[w])};ee[w]=t,g?C(g,[y,v]):v()},clone(y){const A=dh(y,e,n,s,r);return r&&r(A),A}};return E}function Nu(t){if(Tl(t))return t=Qs(t),t.children=null,t}function Yp(t){if(!Tl(t))return $y(t.type)&&t.children?zy(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:n}=t;if(n){if(e&16)return n[0];if(e&32&&he(n.default))return n.default()}}function Ho(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Ho(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Yy(t,e=!1,n){let s=[],r=0;for(let i=0;i<t.length;i++){let o=t[i];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:i);o.type===Xt?(o.patchFlag&128&&r++,s=s.concat(Yy(o.children,e,a))):(e||o.type!==Nt)&&s.push(a!=null?Qs(o,{key:a}):o)}if(r>1)for(let i=0;i<s.length;i++)s[i].patchFlag=-2;return s}function Xy(t,e){return he(t)?dt({name:t.name},e,{setup:t}):t}function Jy(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const wc=new WeakMap;function Ao(t,e,n,s,r=!1){if(ie(t)){t.forEach((S,P)=>Ao(S,e&&(ie(e)?e[P]:e),n,s,r));return}if(ci(s)&&!r){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Ao(t,e,n,s.component.subTree);return}const i=s.shapeFlag&4?Rl(s.component):s.el,o=r?null:i,{i:a,r:l}=t,u=e&&e.r,h=a.refs===Le?a.refs={}:a.refs,d=a.setupState,m=Se(d),g=d===Le?fy:S=>Pe(m,S);if(u!=null&&u!==l){if(Xp(e),Je(u))h[u]=null,g(u)&&(d[u]=null);else if(Ye(u)){u.value=null;const S=e;S.k&&(h[S.k]=null)}}if(he(l))ua(l,a,12,[o,h]);else{const S=Je(l),P=Ye(l);if(S||P){const N=()=>{if(t.f){const O=S?g(l)?d[l]:h[l]:l.value;if(r)ie(O)&&mf(O,i);else if(ie(O))O.includes(i)||O.push(i);else if(S)h[l]=[i],g(l)&&(d[l]=h[l]);else{const B=[i];l.value=B,t.k&&(h[t.k]=B)}}else S?(h[l]=o,g(l)&&(d[l]=o)):P&&(l.value=o,t.k&&(h[t.k]=o))};if(o){const O=()=>{N(),wc.delete(t)};O.id=-1,wc.set(t,O),Yt(O,n)}else Xp(t),N()}}}function Xp(t){const e=wc.get(t);e&&(e.flags|=8,wc.delete(t))}ml().requestIdleCallback;ml().cancelIdleCallback;const ci=t=>!!t.type.__asyncLoader,Tl=t=>t.type.__isKeepAlive;function QA(t,e){Zy(t,"a",e)}function YA(t,e){Zy(t,"da",e)}function Zy(t,e,n=kt){const s=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(Il(e,s,n),n){let r=n.parent;for(;r&&r.parent;)Tl(r.parent.vnode)&&XA(s,e,n,r),r=r.parent}}function XA(t,e,n,s){const r=Il(e,t,s,!0);nE(()=>{mf(s[e],r)},n)}function Il(t,e,n=kt,s=!1){if(n){const r=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{ls();const a=ha(n),l=wn(e,n,t,o);return a(),us(),l});return s?r.unshift(i):r.push(i),i}}const Es=t=>(e,n=kt)=>{(!Go||t==="sp")&&Il(t,(...s)=>e(...s),n)},JA=Es("bm"),eE=Es("m"),ZA=Es("bu"),eR=Es("u"),tE=Es("bum"),nE=Es("um"),tR=Es("sp"),nR=Es("rtg"),sR=Es("rtc");function rR(t,e=kt){Il("ec",t,e)}const iR="components";function oR(t,e){return cR(iR,t,!0,e)||t}const aR=Symbol.for("v-ndc");function cR(t,e,n=!0,s=!1){const r=yt||kt;if(r){const i=r.type;{const a=XR(i,!1);if(a&&(a===e||a===cn(e)||a===dl(cn(e))))return i}const o=Jp(r[t]||i[t],e)||Jp(r.appContext[t],e);return!o&&s?i:o}}function Jp(t,e){return t&&(t[e]||t[cn(e)]||t[dl(cn(e))])}function xM(t,e,n,s){let r;const i=n,o=ie(t);if(o||Je(t)){const a=o&&rs(t);let l=!1,u=!1;a&&(l=!en(t),u=hs(t),t=_l(t)),r=new Array(t.length);for(let h=0,d=t.length;h<d;h++)r[h]=e(l?u?_i(In(t[h])):In(t[h]):t[h],h,void 0,i)}else if(typeof t=="number"){r=new Array(t);for(let a=0;a<t;a++)r[a]=e(a+1,a,void 0,i)}else if(Ve(t))if(t[Symbol.iterator])r=Array.from(t,(a,l)=>e(a,l,void 0,i));else{const a=Object.keys(t);r=new Array(a.length);for(let l=0,u=a.length;l<u;l++){const h=a[l];r[l]=e(t[h],h,l,i)}}else r=[];return r}function VM(t,e,n={},s,r){if(yt.ce||yt.parent&&ci(yt.parent)&&yt.parent.ce){const u=Object.keys(n).length>0;return li(),Cc(Xt,null,[Wt("slot",n,s)],u?-2:64)}let i=t[e];i&&i._c&&(i._d=!1),li();const o=i&&sE(i(n)),a=n.key||o&&o.key,l=Cc(Xt,{key:(a&&!Tn(a)?a:`_${e}`)+(!o&&s?"_fb":"")},o||[],o&&t._===1?64:-2);return i&&i._c&&(i._d=!0),l}function sE(t){return t.some(e=>$o(e)?!(e.type===Nt||e.type===Xt&&!sE(e.children)):!0)?t:null}const ph=t=>t?wE(t)?Rl(t):ph(t.parent):null,Ro=dt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>ph(t.parent),$root:t=>ph(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>iE(t),$forceUpdate:t=>t.f||(t.f=()=>{Rf(t.update)}),$nextTick:t=>t.n||(t.n=vl.bind(t.proxy)),$watch:t=>vR.bind(t)}),ku=(t,e)=>t!==Le&&!t.__isScriptSetup&&Pe(t,e),lR={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:s,data:r,props:i,accessCache:o,type:a,appContext:l}=t;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return s[e];case 2:return r[e];case 4:return n[e];case 3:return i[e]}else{if(ku(s,e))return o[e]=1,s[e];if(r!==Le&&Pe(r,e))return o[e]=2,r[e];if(Pe(i,e))return o[e]=3,i[e];if(n!==Le&&Pe(n,e))return o[e]=4,n[e];mh&&(o[e]=0)}}const u=Ro[e];let h,d;if(u)return e==="$attrs"&&Ct(t.attrs,"get",""),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Le&&Pe(n,e))return o[e]=4,n[e];if(d=l.config.globalProperties,Pe(d,e))return d[e]},set({_:t},e,n){const{data:s,setupState:r,ctx:i}=t;return ku(r,e)?(r[e]=n,!0):s!==Le&&Pe(s,e)?(s[e]=n,!0):Pe(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:r,props:i,type:o}},a){let l;return!!(n[a]||t!==Le&&a[0]!=="$"&&Pe(t,a)||ku(e,a)||Pe(i,a)||Pe(s,a)||Pe(Ro,a)||Pe(r.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Pe(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function Zp(t){return ie(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let mh=!0;function uR(t){const e=iE(t),n=t.proxy,s=t.ctx;mh=!1,e.beforeCreate&&em(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:a,provide:l,inject:u,created:h,beforeMount:d,mounted:m,beforeUpdate:g,updated:S,activated:P,deactivated:N,beforeDestroy:O,beforeUnmount:B,destroyed:q,unmounted:$,render:ee,renderTracked:oe,renderTriggered:C,errorCaptured:E,serverPrefetch:y,expose:A,inheritAttrs:w,components:I,directives:v,filters:ve}=e;if(u&&hR(u,s,null),o)for(const de in o){const Te=o[de];he(Te)&&(s[de]=Te.bind(n))}if(r){const de=r.call(n,n);Ve(de)&&(t.data=la(de))}if(mh=!0,i)for(const de in i){const Te=i[de],jt=he(Te)?Te.bind(n,n):he(Te.get)?Te.get.bind(n,n):xn,Cn=!he(Te)&&he(Te.set)?Te.set.bind(n):xn,Gt=it({get:jt,set:Cn});Object.defineProperty(s,de,{enumerable:!0,configurable:!0,get:()=>Gt.value,set:pt=>Gt.value=pt})}if(a)for(const de in a)rE(a[de],s,n,de);if(l){const de=he(l)?l.call(n):l;Reflect.ownKeys(de).forEach(Te=>{ic(Te,de[Te])})}h&&em(h,t,"c");function De(de,Te){ie(Te)?Te.forEach(jt=>de(jt.bind(n))):Te&&de(Te.bind(n))}if(De(JA,d),De(eE,m),De(ZA,g),De(eR,S),De(QA,P),De(YA,N),De(rR,E),De(sR,oe),De(nR,C),De(tE,B),De(nE,$),De(tR,y),ie(A))if(A.length){const de=t.exposed||(t.exposed={});A.forEach(Te=>{Object.defineProperty(de,Te,{get:()=>n[Te],set:jt=>n[Te]=jt,enumerable:!0})})}else t.exposed||(t.exposed={});ee&&t.render===xn&&(t.render=ee),w!=null&&(t.inheritAttrs=w),I&&(t.components=I),v&&(t.directives=v),y&&Jy(t)}function hR(t,e,n=xn){ie(t)&&(t=gh(t));for(const s in t){const r=t[s];let i;Ve(r)?"default"in r?i=on(r.from||s,r.default,!0):i=on(r.from||s):i=on(r),Ye(i)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[s]=i}}function em(t,e,n){wn(ie(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function rE(t,e,n,s){let r=s.includes(".")?cE(n,s):()=>n[s];if(Je(t)){const i=e[t];he(i)&&Co(r,i)}else if(he(t))Co(r,t.bind(n));else if(Ve(t))if(ie(t))t.forEach(i=>rE(i,e,n,s));else{const i=he(t.handler)?t.handler.bind(n):e[t.handler];he(i)&&Co(r,i,t)}}function iE(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let l;return a?l=a:!r.length&&!n&&!s?l=e:(l={},r.length&&r.forEach(u=>Ac(l,u,o,!0)),Ac(l,e,o)),Ve(e)&&i.set(e,l),l}function Ac(t,e,n,s=!1){const{mixins:r,extends:i}=e;i&&Ac(t,i,n,!0),r&&r.forEach(o=>Ac(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=fR[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const fR={data:tm,props:nm,emits:nm,methods:fo,computed:fo,beforeCreate:Vt,created:Vt,beforeMount:Vt,mounted:Vt,beforeUpdate:Vt,updated:Vt,beforeDestroy:Vt,beforeUnmount:Vt,destroyed:Vt,unmounted:Vt,activated:Vt,deactivated:Vt,errorCaptured:Vt,serverPrefetch:Vt,components:fo,directives:fo,watch:pR,provide:tm,inject:dR};function tm(t,e){return e?t?function(){return dt(he(t)?t.call(this,this):t,he(e)?e.call(this,this):e)}:e:t}function dR(t,e){return fo(gh(t),gh(e))}function gh(t){if(ie(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Vt(t,e){return t?[...new Set([].concat(t,e))]:e}function fo(t,e){return t?dt(Object.create(null),t,e):e}function nm(t,e){return t?ie(t)&&ie(e)?[...new Set([...t,...e])]:dt(Object.create(null),Zp(t),Zp(e??{})):e}function pR(t,e){if(!t)return e;if(!e)return t;const n=dt(Object.create(null),t);for(const s in e)n[s]=Vt(t[s],e[s]);return n}function oE(){return{app:null,config:{isNativeTag:fy,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let mR=0;function gR(t,e){return function(s,r=null){he(s)||(s=dt({},s)),r!=null&&!Ve(r)&&(r=null);const i=oE(),o=new WeakSet,a=[];let l=!1;const u=i.app={_uid:mR++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:ZR,get config(){return i.config},set config(h){},use(h,...d){return o.has(h)||(h&&he(h.install)?(o.add(h),h.install(u,...d)):he(h)&&(o.add(h),h(u,...d))),u},mixin(h){return i.mixins.includes(h)||i.mixins.push(h),u},component(h,d){return d?(i.components[h]=d,u):i.components[h]},directive(h,d){return d?(i.directives[h]=d,u):i.directives[h]},mount(h,d,m){if(!l){const g=u._ceVNode||Wt(s,r);return g.appContext=i,m===!0?m="svg":m===!1&&(m=void 0),t(g,h,m),l=!0,u._container=h,h.__vue_app__=u,Rl(g.component)}},onUnmount(h){a.push(h)},unmount(){l&&(wn(a,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(h,d){return i.provides[h]=d,u},runWithContext(h){const d=Pr;Pr=u;try{return h()}finally{Pr=d}}};return u}}let Pr=null;function ic(t,e){if(kt){let n=kt.provides;const s=kt.parent&&kt.parent.provides;s===n&&(n=kt.provides=Object.create(s)),n[t]=e}}function on(t,e,n=!1){const s=Pf();if(s||Pr){let r=Pr?Pr._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return n&&he(e)?e.call(s&&s.proxy):e}}function _R(){return!!(Pf()||Pr)}const yR=Symbol.for("v-scx"),ER=()=>on(yR);function Co(t,e,n){return aE(t,e,n)}function aE(t,e,n=Le){const{immediate:s,deep:r,flush:i,once:o}=n,a=dt({},n),l=e&&s||!e&&i!=="post";let u;if(Go){if(i==="sync"){const g=ER();u=g.__watcherHandles||(g.__watcherHandles=[])}else if(!l){const g=()=>{};return g.stop=xn,g.resume=xn,g.pause=xn,g}}const h=kt;a.call=(g,S,P)=>wn(g,h,S,P);let d=!1;i==="post"?a.scheduler=g=>{Yt(g,h&&h.suspense)}:i!=="sync"&&(d=!0,a.scheduler=(g,S)=>{S?g():Rf(g)}),a.augmentJob=g=>{e&&(g.flags|=4),d&&(g.flags|=2,h&&(g.id=h.uid,g.i=h))};const m=BA(t,e,a);return Go&&(u?u.push(m):l&&m()),m}function vR(t,e,n){const s=this.proxy,r=Je(t)?t.includes(".")?cE(s,t):()=>s[t]:t.bind(s,s);let i;he(e)?i=e:(i=e.handler,n=e);const o=ha(this),a=aE(r,i.bind(s),n);return o(),a}function cE(t,e){const n=e.split(".");return()=>{let s=t;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}const TR=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${cn(e)}Modifiers`]||t[`${Ur(e)}Modifiers`];function IR(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||Le;let r=n;const i=e.startsWith("update:"),o=i&&TR(s,e.slice(7));o&&(o.trim&&(r=n.map(h=>Je(h)?h.trim():h)),o.number&&(r=n.map(pl)));let a,l=s[a=Ru(e)]||s[a=Ru(cn(e))];!l&&i&&(l=s[a=Ru(Ur(e))]),l&&wn(l,t,6,r);const u=s[a+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,wn(u,t,6,r)}}const wR=new WeakMap;function lE(t,e,n=!1){const s=n?wR:e.emitsCache,r=s.get(t);if(r!==void 0)return r;const i=t.emits;let o={},a=!1;if(!he(t)){const l=u=>{const h=lE(u,e,!0);h&&(a=!0,dt(o,h))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!i&&!a?(Ve(t)&&s.set(t,null),null):(ie(i)?i.forEach(l=>o[l]=null):dt(o,i),Ve(t)&&s.set(t,o),o)}function wl(t,e){return!t||!ll(e)?!1:(e=e.slice(2).replace(/Once$/,""),Pe(t,e[0].toLowerCase()+e.slice(1))||Pe(t,Ur(e))||Pe(t,e))}function sm(t){const{type:e,vnode:n,proxy:s,withProxy:r,propsOptions:[i],slots:o,attrs:a,emit:l,render:u,renderCache:h,props:d,data:m,setupState:g,ctx:S,inheritAttrs:P}=t,N=Ic(t);let O,B;try{if(n.shapeFlag&4){const $=r||s,ee=$;O=Dn(u.call(ee,$,h,d,g,m,S)),B=a}else{const $=e;O=Dn($.length>1?$(d,{attrs:a,slots:o,emit:l}):$(d,null)),B=e.props?a:AR(a)}}catch($){So.length=0,El($,t,1),O=Wt(Nt)}let q=O;if(B&&P!==!1){const $=Object.keys(B),{shapeFlag:ee}=q;$.length&&ee&7&&(i&&$.some(pf)&&(B=RR(B,i)),q=Qs(q,B,!1,!0))}return n.dirs&&(q=Qs(q,null,!1,!0),q.dirs=q.dirs?q.dirs.concat(n.dirs):n.dirs),n.transition&&Ho(q,n.transition),O=q,Ic(N),O}const AR=t=>{let e;for(const n in t)(n==="class"||n==="style"||ll(n))&&((e||(e={}))[n]=t[n]);return e},RR=(t,e)=>{const n={};for(const s in t)(!pf(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function CR(t,e,n){const{props:s,children:r,component:i}=t,{props:o,children:a,patchFlag:l}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return s?rm(s,o,u):!!o;if(l&8){const h=e.dynamicProps;for(let d=0;d<h.length;d++){const m=h[d];if(o[m]!==s[m]&&!wl(u,m))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?rm(s,o,u):!0:!!o;return!1}function rm(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==t[i]&&!wl(n,i))return!0}return!1}function SR({vnode:t,parent:e},n){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=n,e=e.parent;else break}}const uE={},hE=()=>Object.create(uE),fE=t=>Object.getPrototypeOf(t)===uE;function bR(t,e,n,s=!1){const r={},i=hE();t.propsDefaults=Object.create(null),dE(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=s?r:Ly(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function PR(t,e,n,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,a=Se(r),[l]=t.propsOptions;let u=!1;if((s||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let d=0;d<h.length;d++){let m=h[d];if(wl(t.emitsOptions,m))continue;const g=e[m];if(l)if(Pe(i,m))g!==i[m]&&(i[m]=g,u=!0);else{const S=cn(m);r[S]=_h(l,a,S,g,t,!1)}else g!==i[m]&&(i[m]=g,u=!0)}}}else{dE(t,e,r,i)&&(u=!0);let h;for(const d in a)(!e||!Pe(e,d)&&((h=Ur(d))===d||!Pe(e,h)))&&(l?n&&(n[d]!==void 0||n[h]!==void 0)&&(r[d]=_h(l,a,d,void 0,t,!0)):delete r[d]);if(i!==a)for(const d in i)(!e||!Pe(e,d))&&(delete i[d],u=!0)}u&&Jn(t.attrs,"set","")}function dE(t,e,n,s){const[r,i]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(To(l))continue;const u=e[l];let h;r&&Pe(r,h=cn(l))?!i||!i.includes(h)?n[h]=u:(a||(a={}))[h]=u:wl(t.emitsOptions,l)||(!(l in s)||u!==s[l])&&(s[l]=u,o=!0)}if(i){const l=Se(n),u=a||Le;for(let h=0;h<i.length;h++){const d=i[h];n[d]=_h(r,l,d,u[d],t,!Pe(u,d))}}return o}function _h(t,e,n,s,r,i){const o=t[n];if(o!=null){const a=Pe(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&he(l)){const{propsDefaults:u}=r;if(n in u)s=u[n];else{const h=ha(r);s=u[n]=l.call(null,e),h()}}else s=l;r.ce&&r.ce._setProp(n,s)}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===Ur(n))&&(s=!0))}return s}const NR=new WeakMap;function pE(t,e,n=!1){const s=n?NR:e.propsCache,r=s.get(t);if(r)return r;const i=t.props,o={},a=[];let l=!1;if(!he(t)){const h=d=>{l=!0;const[m,g]=pE(d,e,!0);dt(o,m),g&&a.push(...g)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!i&&!l)return Ve(t)&&s.set(t,ii),ii;if(ie(i))for(let h=0;h<i.length;h++){const d=cn(i[h]);im(d)&&(o[d]=Le)}else if(i)for(const h in i){const d=cn(h);if(im(d)){const m=i[h],g=o[d]=ie(m)||he(m)?{type:m}:dt({},m),S=g.type;let P=!1,N=!0;if(ie(S))for(let O=0;O<S.length;++O){const B=S[O],q=he(B)&&B.name;if(q==="Boolean"){P=!0;break}else q==="String"&&(N=!1)}else P=he(S)&&S.name==="Boolean";g[0]=P,g[1]=N,(P||Pe(g,"default"))&&a.push(d)}}const u=[o,a];return Ve(t)&&s.set(t,u),u}function im(t){return t[0]!=="$"&&!To(t)}const Cf=t=>t==="_"||t==="_ctx"||t==="$stable",Sf=t=>ie(t)?t.map(Dn):[Dn(t)],kR=(t,e,n)=>{if(e._n)return e;const s=WA((...r)=>Sf(e(...r)),n);return s._c=!1,s},mE=(t,e,n)=>{const s=t._ctx;for(const r in t){if(Cf(r))continue;const i=t[r];if(he(i))e[r]=kR(r,i,s);else if(i!=null){const o=Sf(i);e[r]=()=>o}}},gE=(t,e)=>{const n=Sf(e);t.slots.default=()=>n},_E=(t,e,n)=>{for(const s in e)(n||!Cf(s))&&(t[s]=e[s])},DR=(t,e,n)=>{const s=t.slots=hE();if(t.vnode.shapeFlag&32){const r=e._;r?(_E(s,e,n),n&&gy(s,"_",r,!0)):mE(e,s)}else e&&gE(t,e)},OR=(t,e,n)=>{const{vnode:s,slots:r}=t;let i=!0,o=Le;if(s.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:_E(r,e,n):(i=!e.$stable,mE(e,r)),o=e}else e&&(gE(t,e),o={default:1});if(i)for(const a in r)!Cf(a)&&o[a]==null&&delete r[a]},Yt=FR;function xR(t){return VR(t)}function VR(t,e){const n=ml();n.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:a,createComment:l,setText:u,setElementText:h,parentNode:d,nextSibling:m,setScopeId:g=xn,insertStaticContent:S}=t,P=(T,R,b,L=null,U=null,V=null,K=void 0,W=null,H=!!R.dynamicChildren)=>{if(T===R)return;T&&!Ir(T,R)&&(L=M(T),pt(T,U,V,!0),T=null),R.patchFlag===-2&&(H=!1,R.dynamicChildren=null);const{type:j,ref:re,shapeFlag:X}=R;switch(j){case Al:N(T,R,b,L);break;case Nt:O(T,R,b,L);break;case Ou:T==null&&B(R,b,L,K);break;case Xt:I(T,R,b,L,U,V,K,W,H);break;default:X&1?ee(T,R,b,L,U,V,K,W,H):X&6?v(T,R,b,L,U,V,K,W,H):(X&64||X&128)&&j.process(T,R,b,L,U,V,K,W,H,te)}re!=null&&U?Ao(re,T&&T.ref,V,R||T,!R):re==null&&T&&T.ref!=null&&Ao(T.ref,null,V,T,!0)},N=(T,R,b,L)=>{if(T==null)s(R.el=a(R.children),b,L);else{const U=R.el=T.el;R.children!==T.children&&u(U,R.children)}},O=(T,R,b,L)=>{T==null?s(R.el=l(R.children||""),b,L):R.el=T.el},B=(T,R,b,L)=>{[T.el,T.anchor]=S(T.children,R,b,L,T.el,T.anchor)},q=({el:T,anchor:R},b,L)=>{let U;for(;T&&T!==R;)U=m(T),s(T,b,L),T=U;s(R,b,L)},$=({el:T,anchor:R})=>{let b;for(;T&&T!==R;)b=m(T),r(T),T=b;r(R)},ee=(T,R,b,L,U,V,K,W,H)=>{if(R.type==="svg"?K="svg":R.type==="math"&&(K="mathml"),T==null)oe(R,b,L,U,V,K,W,H);else{const j=T.el&&T.el._isVueCE?T.el:null;try{j&&j._beginPatch(),y(T,R,U,V,K,W,H)}finally{j&&j._endPatch()}}},oe=(T,R,b,L,U,V,K,W)=>{let H,j;const{props:re,shapeFlag:X,transition:se,dirs:ae}=T;if(H=T.el=o(T.type,V,re&&re.is,re),X&8?h(H,T.children):X&16&&E(T.children,H,null,L,U,Du(T,V),K,W),ae&&mr(T,null,L,"created"),C(H,T,T.scopeId,K,L),re){for(const Oe in re)Oe!=="value"&&!To(Oe)&&i(H,Oe,null,re[Oe],V,L);"value"in re&&i(H,"value",null,re.value,V),(j=re.onVnodeBeforeMount)&&Pn(j,L,T)}ae&&mr(T,null,L,"beforeMount");const me=MR(U,se);me&&se.beforeEnter(H),s(H,R,b),((j=re&&re.onVnodeMounted)||me||ae)&&Yt(()=>{j&&Pn(j,L,T),me&&se.enter(H),ae&&mr(T,null,L,"mounted")},U)},C=(T,R,b,L,U)=>{if(b&&g(T,b),L)for(let V=0;V<L.length;V++)g(T,L[V]);if(U){let V=U.subTree;if(R===V||vE(V.type)&&(V.ssContent===R||V.ssFallback===R)){const K=U.vnode;C(T,K,K.scopeId,K.slotScopeIds,U.parent)}}},E=(T,R,b,L,U,V,K,W,H=0)=>{for(let j=H;j<T.length;j++){const re=T[j]=W?Vs(T[j]):Dn(T[j]);P(null,re,R,b,L,U,V,K,W)}},y=(T,R,b,L,U,V,K)=>{const W=R.el=T.el;let{patchFlag:H,dynamicChildren:j,dirs:re}=R;H|=T.patchFlag&16;const X=T.props||Le,se=R.props||Le;let ae;if(b&&gr(b,!1),(ae=se.onVnodeBeforeUpdate)&&Pn(ae,b,R,T),re&&mr(R,T,b,"beforeUpdate"),b&&gr(b,!0),(X.innerHTML&&se.innerHTML==null||X.textContent&&se.textContent==null)&&h(W,""),j?A(T.dynamicChildren,j,W,b,L,Du(R,U),V):K||Te(T,R,W,null,b,L,Du(R,U),V,!1),H>0){if(H&16)w(W,X,se,b,U);else if(H&2&&X.class!==se.class&&i(W,"class",null,se.class,U),H&4&&i(W,"style",X.style,se.style,U),H&8){const me=R.dynamicProps;for(let Oe=0;Oe<me.length;Oe++){const Ce=me[Oe],Tt=X[Ce],It=se[Ce];(It!==Tt||Ce==="value")&&i(W,Ce,Tt,It,U,b)}}H&1&&T.children!==R.children&&h(W,R.children)}else!K&&j==null&&w(W,X,se,b,U);((ae=se.onVnodeUpdated)||re)&&Yt(()=>{ae&&Pn(ae,b,R,T),re&&mr(R,T,b,"updated")},L)},A=(T,R,b,L,U,V,K)=>{for(let W=0;W<R.length;W++){const H=T[W],j=R[W],re=H.el&&(H.type===Xt||!Ir(H,j)||H.shapeFlag&198)?d(H.el):b;P(H,j,re,null,L,U,V,K,!0)}},w=(T,R,b,L,U)=>{if(R!==b){if(R!==Le)for(const V in R)!To(V)&&!(V in b)&&i(T,V,R[V],null,U,L);for(const V in b){if(To(V))continue;const K=b[V],W=R[V];K!==W&&V!=="value"&&i(T,V,W,K,U,L)}"value"in b&&i(T,"value",R.value,b.value,U)}},I=(T,R,b,L,U,V,K,W,H)=>{const j=R.el=T?T.el:a(""),re=R.anchor=T?T.anchor:a("");let{patchFlag:X,dynamicChildren:se,slotScopeIds:ae}=R;ae&&(W=W?W.concat(ae):ae),T==null?(s(j,b,L),s(re,b,L),E(R.children||[],b,re,U,V,K,W,H)):X>0&&X&64&&se&&T.dynamicChildren?(A(T.dynamicChildren,se,b,U,V,K,W),(R.key!=null||U&&R===U.subTree)&&yE(T,R,!0)):Te(T,R,b,re,U,V,K,W,H)},v=(T,R,b,L,U,V,K,W,H)=>{R.slotScopeIds=W,T==null?R.shapeFlag&512?U.ctx.activate(R,b,L,K,H):ve(R,b,L,U,V,K,H):Ge(T,R,H)},ve=(T,R,b,L,U,V,K)=>{const W=T.component=GR(T,L,U);if(Tl(T)&&(W.ctx.renderer=te),KR(W,!1,K),W.asyncDep){if(U&&U.registerDep(W,De,K),!T.el){const H=W.subTree=Wt(Nt);O(null,H,R,b),T.placeholder=H.el}}else De(W,T,R,b,U,V,K)},Ge=(T,R,b)=>{const L=R.component=T.component;if(CR(T,R,b))if(L.asyncDep&&!L.asyncResolved){de(L,R,b);return}else L.next=R,L.update();else R.el=T.el,L.vnode=R},De=(T,R,b,L,U,V,K)=>{const W=()=>{if(T.isMounted){let{next:X,bu:se,u:ae,parent:me,vnode:Oe}=T;{const zt=EE(T);if(zt){X&&(X.el=Oe.el,de(T,X,K)),zt.asyncDep.then(()=>{T.isUnmounted||W()});return}}let Ce=X,Tt;gr(T,!1),X?(X.el=Oe.el,de(T,X,K)):X=Oe,se&&rc(se),(Tt=X.props&&X.props.onVnodeBeforeUpdate)&&Pn(Tt,me,X,Oe),gr(T,!0);const It=sm(T),Kt=T.subTree;T.subTree=It,P(Kt,It,d(Kt.el),M(Kt),T,U,V),X.el=It.el,Ce===null&&SR(T,It.el),ae&&Yt(ae,U),(Tt=X.props&&X.props.onVnodeUpdated)&&Yt(()=>Pn(Tt,me,X,Oe),U)}else{let X;const{el:se,props:ae}=R,{bm:me,m:Oe,parent:Ce,root:Tt,type:It}=T,Kt=ci(R);gr(T,!1),me&&rc(me),!Kt&&(X=ae&&ae.onVnodeBeforeMount)&&Pn(X,Ce,R),gr(T,!0);{Tt.ce&&Tt.ce._def.shadowRoot!==!1&&Tt.ce._injectChildStyle(It);const zt=T.subTree=sm(T);P(null,zt,b,L,T,U,V),R.el=zt.el}if(Oe&&Yt(Oe,U),!Kt&&(X=ae&&ae.onVnodeMounted)){const zt=R;Yt(()=>Pn(X,Ce,zt),U)}(R.shapeFlag&256||Ce&&ci(Ce.vnode)&&Ce.vnode.shapeFlag&256)&&T.a&&Yt(T.a,U),T.isMounted=!0,R=b=L=null}};T.scope.on();const H=T.effect=new wy(W);T.scope.off();const j=T.update=H.run.bind(H),re=T.job=H.runIfDirty.bind(H);re.i=T,re.id=T.uid,H.scheduler=()=>Rf(re),gr(T,!0),j()},de=(T,R,b)=>{R.component=T;const L=T.vnode.props;T.vnode=R,T.next=null,PR(T,R.props,L,b),OR(T,R.children,b),ls(),Qp(T),us()},Te=(T,R,b,L,U,V,K,W,H=!1)=>{const j=T&&T.children,re=T?T.shapeFlag:0,X=R.children,{patchFlag:se,shapeFlag:ae}=R;if(se>0){if(se&128){Cn(j,X,b,L,U,V,K,W,H);return}else if(se&256){jt(j,X,b,L,U,V,K,W,H);return}}ae&8?(re&16&&vt(j,U,V),X!==j&&h(b,X)):re&16?ae&16?Cn(j,X,b,L,U,V,K,W,H):vt(j,U,V,!0):(re&8&&h(b,""),ae&16&&E(X,b,L,U,V,K,W,H))},jt=(T,R,b,L,U,V,K,W,H)=>{T=T||ii,R=R||ii;const j=T.length,re=R.length,X=Math.min(j,re);let se;for(se=0;se<X;se++){const ae=R[se]=H?Vs(R[se]):Dn(R[se]);P(T[se],ae,b,null,U,V,K,W,H)}j>re?vt(T,U,V,!0,!1,X):E(R,b,L,U,V,K,W,H,X)},Cn=(T,R,b,L,U,V,K,W,H)=>{let j=0;const re=R.length;let X=T.length-1,se=re-1;for(;j<=X&&j<=se;){const ae=T[j],me=R[j]=H?Vs(R[j]):Dn(R[j]);if(Ir(ae,me))P(ae,me,b,null,U,V,K,W,H);else break;j++}for(;j<=X&&j<=se;){const ae=T[X],me=R[se]=H?Vs(R[se]):Dn(R[se]);if(Ir(ae,me))P(ae,me,b,null,U,V,K,W,H);else break;X--,se--}if(j>X){if(j<=se){const ae=se+1,me=ae<re?R[ae].el:L;for(;j<=se;)P(null,R[j]=H?Vs(R[j]):Dn(R[j]),b,me,U,V,K,W,H),j++}}else if(j>se)for(;j<=X;)pt(T[j],U,V,!0),j++;else{const ae=j,me=j,Oe=new Map;for(j=me;j<=se;j++){const mt=R[j]=H?Vs(R[j]):Dn(R[j]);mt.key!=null&&Oe.set(mt.key,j)}let Ce,Tt=0;const It=se-me+1;let Kt=!1,zt=0;const dn=new Array(It);for(j=0;j<It;j++)dn[j]=0;for(j=ae;j<=X;j++){const mt=T[j];if(Tt>=It){pt(mt,U,V,!0);continue}let at;if(mt.key!=null)at=Oe.get(mt.key);else for(Ce=me;Ce<=se;Ce++)if(dn[Ce-me]===0&&Ir(mt,R[Ce])){at=Ce;break}at===void 0?pt(mt,U,V,!0):(dn[at-me]=j+1,at>=zt?zt=at:Kt=!0,P(mt,R[at],b,null,U,V,K,W,H),Tt++)}const Wr=Kt?LR(dn):ii;for(Ce=Wr.length-1,j=It-1;j>=0;j--){const mt=me+j,at=R[mt],qi=R[mt+1],ur=mt+1<re?qi.el||qi.placeholder:L;dn[j]===0?P(null,at,b,ur,U,V,K,W,H):Kt&&(Ce<0||j!==Wr[Ce]?Gt(at,b,ur,2):Ce--)}}},Gt=(T,R,b,L,U=null)=>{const{el:V,type:K,transition:W,children:H,shapeFlag:j}=T;if(j&6){Gt(T.component.subTree,R,b,L);return}if(j&128){T.suspense.move(R,b,L);return}if(j&64){K.move(T,R,b,te);return}if(K===Xt){s(V,R,b);for(let X=0;X<H.length;X++)Gt(H[X],R,b,L);s(T.anchor,R,b);return}if(K===Ou){q(T,R,b);return}if(L!==2&&j&1&&W)if(L===0)W.beforeEnter(V),s(V,R,b),Yt(()=>W.enter(V),U);else{const{leave:X,delayLeave:se,afterLeave:ae}=W,me=()=>{T.ctx.isUnmounted?r(V):s(V,R,b)},Oe=()=>{V._isLeaving&&V[Xn](!0),X(V,()=>{me(),ae&&ae()})};se?se(V,me,Oe):Oe()}else s(V,R,b)},pt=(T,R,b,L=!1,U=!1)=>{const{type:V,props:K,ref:W,children:H,dynamicChildren:j,shapeFlag:re,patchFlag:X,dirs:se,cacheIndex:ae}=T;if(X===-2&&(U=!1),W!=null&&(ls(),Ao(W,null,b,T,!0),us()),ae!=null&&(R.renderCache[ae]=void 0),re&256){R.ctx.deactivate(T);return}const me=re&1&&se,Oe=!ci(T);let Ce;if(Oe&&(Ce=K&&K.onVnodeBeforeUnmount)&&Pn(Ce,R,T),re&6)fn(T.component,b,L);else{if(re&128){T.suspense.unmount(b,L);return}me&&mr(T,null,R,"beforeUnmount"),re&64?T.type.remove(T,R,b,te,L):j&&!j.hasOnce&&(V!==Xt||X>0&&X&64)?vt(j,R,b,!1,!0):(V===Xt&&X&384||!U&&re&16)&&vt(H,R,b),L&&$n(T)}(Oe&&(Ce=K&&K.onVnodeUnmounted)||me)&&Yt(()=>{Ce&&Pn(Ce,R,T),me&&mr(T,null,R,"unmounted")},b)},$n=T=>{const{type:R,el:b,anchor:L,transition:U}=T;if(R===Xt){hn(b,L);return}if(R===Ou){$(T);return}const V=()=>{r(b),U&&!U.persisted&&U.afterLeave&&U.afterLeave()};if(T.shapeFlag&1&&U&&!U.persisted){const{leave:K,delayLeave:W}=U,H=()=>K(b,V);W?W(T.el,V,H):H()}else V()},hn=(T,R)=>{let b;for(;T!==R;)b=m(T),r(T),T=b;r(R)},fn=(T,R,b)=>{const{bum:L,scope:U,job:V,subTree:K,um:W,m:H,a:j}=T;om(H),om(j),L&&rc(L),U.stop(),V&&(V.flags|=8,pt(K,T,R,b)),W&&Yt(W,R),Yt(()=>{T.isUnmounted=!0},R)},vt=(T,R,b,L=!1,U=!1,V=0)=>{for(let K=V;K<T.length;K++)pt(T[K],R,b,L,U)},M=T=>{if(T.shapeFlag&6)return M(T.component.subTree);if(T.shapeFlag&128)return T.suspense.next();const R=m(T.anchor||T.el),b=R&&R[$A];return b?m(b):R};let J=!1;const Y=(T,R,b)=>{T==null?R._vnode&&pt(R._vnode,null,null,!0):P(R._vnode||null,T,R,null,null,null,b),R._vnode=T,J||(J=!0,Qp(),qy(),J=!1)},te={p:P,um:pt,m:Gt,r:$n,mt:ve,mc:E,pc:Te,pbc:A,n:M,o:t};return{render:Y,hydrate:void 0,createApp:gR(Y)}}function Du({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function gr({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function MR(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function yE(t,e,n=!1){const s=t.children,r=e.children;if(ie(s)&&ie(r))for(let i=0;i<s.length;i++){const o=s[i];let a=r[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[i]=Vs(r[i]),a.el=o.el),!n&&a.patchFlag!==-2&&yE(o,a)),a.type===Al&&a.patchFlag!==-1&&(a.el=o.el),a.type===Nt&&!a.el&&(a.el=o.el)}}function LR(t){const e=t.slice(),n=[0];let s,r,i,o,a;const l=t.length;for(s=0;s<l;s++){const u=t[s];if(u!==0){if(r=n[n.length-1],t[r]<u){e[s]=r,n.push(s);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<u?i=a+1:o=a;u<t[n[i]]&&(i>0&&(e[s]=n[i-1]),n[i]=s)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}function EE(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:EE(e)}function om(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const vE=t=>t.__isSuspense;function FR(t,e){e&&e.pendingBranch?ie(t)?e.effects.push(...t):e.effects.push(t):HA(t)}const Xt=Symbol.for("v-fgt"),Al=Symbol.for("v-txt"),Nt=Symbol.for("v-cmt"),Ou=Symbol.for("v-stc"),So=[];let Jt=null;function li(t=!1){So.push(Jt=t?null:[])}function UR(){So.pop(),Jt=So[So.length-1]||null}let Wo=1;function Rc(t,e=!1){Wo+=t,t<0&&Jt&&e&&(Jt.hasOnce=!0)}function TE(t){return t.dynamicChildren=Wo>0?Jt||ii:null,UR(),Wo>0&&Jt&&Jt.push(t),t}function am(t,e,n,s,r,i){return TE(Sc(t,e,n,s,r,i,!0))}function Cc(t,e,n,s,r){return TE(Wt(t,e,n,s,r,!0))}function $o(t){return t?t.__v_isVNode===!0:!1}function Ir(t,e){return t.type===e.type&&t.key===e.key}const IE=({key:t})=>t??null,oc=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Je(t)||Ye(t)||he(t)?{i:yt,r:t,k:e,f:!!n}:t:null);function Sc(t,e=null,n=null,s=0,r=null,i=t===Xt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&IE(e),ref:e&&oc(e),scopeId:Wy,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:yt};return a?(bf(l,n),i&128&&t.normalize(l)):n&&(l.shapeFlag|=Je(n)?8:16),Wo>0&&!o&&Jt&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Jt.push(l),l}const Wt=BR;function BR(t,e=null,n=null,s=0,r=null,i=!1){if((!t||t===aR)&&(t=Nt),$o(t)){const a=Qs(t,e,!0);return n&&bf(a,n),Wo>0&&!i&&Jt&&(a.shapeFlag&6?Jt[Jt.indexOf(t)]=a:Jt.push(a)),a.patchFlag=-2,a}if(JR(t)&&(t=t.__vccOpts),e){e=jR(e);let{class:a,style:l}=e;a&&!Je(a)&&(e.class=_f(a)),Ve(l)&&(yl(l)&&!ie(l)&&(l=dt({},l)),e.style=gf(l))}const o=Je(t)?1:vE(t)?128:$y(t)?64:Ve(t)?4:he(t)?2:0;return Sc(t,e,n,s,r,o,i,!0)}function jR(t){return t?yl(t)||fE(t)?dt({},t):t:null}function Qs(t,e,n=!1,s=!1){const{props:r,ref:i,patchFlag:o,children:a,transition:l}=t,u=e?HR(r||{},e):r,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&IE(u),ref:e&&e.ref?n&&i?ie(i)?i.concat(oc(e)):[i,oc(e)]:oc(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Xt?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Qs(t.ssContent),ssFallback:t.ssFallback&&Qs(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&s&&Ho(h,l.clone(h)),h}function qR(t=" ",e=0){return Wt(Al,null,t,e)}function MM(t="",e=!1){return e?(li(),Cc(Nt,null,t)):Wt(Nt,null,t)}function Dn(t){return t==null||typeof t=="boolean"?Wt(Nt):ie(t)?Wt(Xt,null,t.slice()):$o(t)?Vs(t):Wt(Al,null,String(t))}function Vs(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Qs(t)}function bf(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(ie(e))n=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),bf(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!fE(e)?e._ctx=yt:r===3&&yt&&(yt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else he(e)?(e={default:e,_ctx:yt},n=32):(e=String(e),s&64?(n=16,e=[qR(e)]):n=8);t.children=e,t.shapeFlag|=n}function HR(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=_f([e.class,s.class]));else if(r==="style")e.style=gf([e.style,s.style]);else if(ll(r)){const i=e[r],o=s[r];o&&i!==o&&!(ie(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function Pn(t,e,n,s=null){wn(t,e,7,[n,s])}const WR=oE();let $R=0;function GR(t,e,n){const s=t.type,r=(e?e.appContext:t.appContext)||WR,i={uid:$R++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new vy(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:pE(s,r),emitsOptions:lE(s,r),emit:null,emitted:null,propsDefaults:Le,inheritAttrs:s.inheritAttrs,ctx:Le,data:Le,props:Le,attrs:Le,slots:Le,refs:Le,setupState:Le,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=IR.bind(null,i),t.ce&&t.ce(i),i}let kt=null;const Pf=()=>kt||yt;let bc,yh;{const t=ml(),e=(n,s)=>{let r;return(r=t[n])||(r=t[n]=[]),r.push(s),i=>{r.length>1?r.forEach(o=>o(i)):r[0](i)}};bc=e("__VUE_INSTANCE_SETTERS__",n=>kt=n),yh=e("__VUE_SSR_SETTERS__",n=>Go=n)}const ha=t=>{const e=kt;return bc(t),t.scope.on(),()=>{t.scope.off(),bc(e)}},cm=()=>{kt&&kt.scope.off(),bc(null)};function wE(t){return t.vnode.shapeFlag&4}let Go=!1;function KR(t,e=!1,n=!1){e&&yh(e);const{props:s,children:r}=t.vnode,i=wE(t);bR(t,s,i,e),DR(t,r,n||e);const o=i?zR(t,e):void 0;return e&&yh(!1),o}function zR(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,lR);const{setup:s}=n;if(s){ls();const r=t.setupContext=s.length>1?YR(t):null,i=ha(t),o=ua(s,t,0,[t.props,r]),a=dy(o);if(us(),i(),(a||t.sp)&&!ci(t)&&Jy(t),a){if(o.then(cm,cm),e)return o.then(l=>{lm(t,l)}).catch(l=>{El(l,t,0)});t.asyncDep=o}else lm(t,o)}else AE(t)}function lm(t,e,n){he(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ve(e)&&(t.setupState=Uy(e)),AE(t)}function AE(t,e,n){const s=t.type;t.render||(t.render=s.render||xn);{const r=ha(t);ls();try{uR(t)}finally{us(),r()}}}const QR={get(t,e){return Ct(t,"get",""),t[e]}};function YR(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,QR),slots:t.slots,emit:t.emit,expose:e}}function Rl(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Uy(Af(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Ro)return Ro[n](t)},has(e,n){return n in e||n in Ro}})):t.proxy}function XR(t,e=!0){return he(t)?t.displayName||t.name:t.name||e&&t.__name}function JR(t){return he(t)&&"__vccOpts"in t}const it=(t,e)=>FA(t,e,Go);function Nf(t,e,n){try{Rc(-1);const s=arguments.length;return s===2?Ve(e)&&!ie(e)?$o(e)?Wt(t,null,[e]):Wt(t,e):Wt(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&$o(n)&&(n=[n]),Wt(t,e,n))}finally{Rc(1)}}const ZR="3.5.25";let Eh;const um=typeof window<"u"&&window.trustedTypes;if(um)try{Eh=um.createPolicy("vue",{createHTML:t=>t})}catch{}const RE=Eh?t=>Eh.createHTML(t):t=>t,eC="http://www.w3.org/2000/svg",tC="http://www.w3.org/1998/Math/MathML",Yn=typeof document<"u"?document:null,hm=Yn&&Yn.createElement("template"),nC={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const r=e==="svg"?Yn.createElementNS(eC,t):e==="mathml"?Yn.createElementNS(tC,t):n?Yn.createElement(t,{is:n}):Yn.createElement(t);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>Yn.createTextNode(t),createComment:t=>Yn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Yn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,r,i){const o=n?n.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===i||!(r=r.nextSibling)););else{hm.innerHTML=RE(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const a=hm.content;if(s==="svg"||s==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},Ps="transition",ro="animation",Ko=Symbol("_vtc"),CE={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},sC=dt({},Gy,CE),rC=t=>(t.displayName="Transition",t.props=sC,t),LM=rC((t,{slots:e})=>Nf(zA,iC(t),e)),_r=(t,e=[])=>{ie(t)?t.forEach(n=>n(...e)):t&&t(...e)},fm=t=>t?ie(t)?t.some(e=>e.length>1):t.length>1:!1;function iC(t){const e={};for(const I in t)I in CE||(e[I]=t[I]);if(t.css===!1)return e;const{name:n="v",type:s,duration:r,enterFromClass:i=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:l=i,appearActiveClass:u=o,appearToClass:h=a,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:m=`${n}-leave-active`,leaveToClass:g=`${n}-leave-to`}=t,S=oC(r),P=S&&S[0],N=S&&S[1],{onBeforeEnter:O,onEnter:B,onEnterCancelled:q,onLeave:$,onLeaveCancelled:ee,onBeforeAppear:oe=O,onAppear:C=B,onAppearCancelled:E=q}=e,y=(I,v,ve,Ge)=>{I._enterCancelled=Ge,yr(I,v?h:a),yr(I,v?u:o),ve&&ve()},A=(I,v)=>{I._isLeaving=!1,yr(I,d),yr(I,g),yr(I,m),v&&v()},w=I=>(v,ve)=>{const Ge=I?C:B,De=()=>y(v,I,ve);_r(Ge,[v,De]),dm(()=>{yr(v,I?l:i),Kn(v,I?h:a),fm(Ge)||pm(v,s,P,De)})};return dt(e,{onBeforeEnter(I){_r(O,[I]),Kn(I,i),Kn(I,o)},onBeforeAppear(I){_r(oe,[I]),Kn(I,l),Kn(I,u)},onEnter:w(!1),onAppear:w(!0),onLeave(I,v){I._isLeaving=!0;const ve=()=>A(I,v);Kn(I,d),I._enterCancelled?(Kn(I,m),_m(I)):(_m(I),Kn(I,m)),dm(()=>{I._isLeaving&&(yr(I,d),Kn(I,g),fm($)||pm(I,s,N,ve))}),_r($,[I,ve])},onEnterCancelled(I){y(I,!1,void 0,!0),_r(q,[I])},onAppearCancelled(I){y(I,!0,void 0,!0),_r(E,[I])},onLeaveCancelled(I){A(I),_r(ee,[I])}})}function oC(t){if(t==null)return null;if(Ve(t))return[xu(t.enter),xu(t.leave)];{const e=xu(t);return[e,e]}}function xu(t){return tA(t)}function Kn(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Ko]||(t[Ko]=new Set)).add(e)}function yr(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const n=t[Ko];n&&(n.delete(e),n.size||(t[Ko]=void 0))}function dm(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let aC=0;function pm(t,e,n,s){const r=t._endId=++aC,i=()=>{r===t._endId&&s()};if(n!=null)return setTimeout(i,n);const{type:o,timeout:a,propCount:l}=cC(t,e);if(!o)return s();const u=o+"end";let h=0;const d=()=>{t.removeEventListener(u,m),i()},m=g=>{g.target===t&&++h>=l&&d()};setTimeout(()=>{h<l&&d()},a+1),t.addEventListener(u,m)}function cC(t,e){const n=window.getComputedStyle(t),s=S=>(n[S]||"").split(", "),r=s(`${Ps}Delay`),i=s(`${Ps}Duration`),o=mm(r,i),a=s(`${ro}Delay`),l=s(`${ro}Duration`),u=mm(a,l);let h=null,d=0,m=0;e===Ps?o>0&&(h=Ps,d=o,m=i.length):e===ro?u>0&&(h=ro,d=u,m=l.length):(d=Math.max(o,u),h=d>0?o>u?Ps:ro:null,m=h?h===Ps?i.length:l.length:0);const g=h===Ps&&/\b(?:transform|all)(?:,|$)/.test(s(`${Ps}Property`).toString());return{type:h,timeout:d,propCount:m,hasTransform:g}}function mm(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>gm(n)+gm(t[s])))}function gm(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function _m(t){return(t?t.ownerDocument:document).body.offsetHeight}function lC(t,e,n){const s=t[Ko];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const ym=Symbol("_vod"),uC=Symbol("_vsh"),hC=Symbol(""),fC=/(?:^|;)\s*display\s*:/;function dC(t,e,n){const s=t.style,r=Je(n);let i=!1;if(n&&!r){if(e)if(Je(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&ac(s,a,"")}else for(const o in e)n[o]==null&&ac(s,o,"");for(const o in n)o==="display"&&(i=!0),ac(s,o,n[o])}else if(r){if(e!==n){const o=s[hC];o&&(n+=";"+o),s.cssText=n,i=fC.test(n)}}else e&&t.removeAttribute("style");ym in t&&(t[ym]=i?s.display:"",t[uC]&&(s.display="none"))}const Em=/\s*!important$/;function ac(t,e,n){if(ie(n))n.forEach(s=>ac(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=pC(t,e);Em.test(n)?t.setProperty(Ur(s),n.replace(Em,""),"important"):t[s]=n}}const vm=["Webkit","Moz","ms"],Vu={};function pC(t,e){const n=Vu[e];if(n)return n;let s=cn(e);if(s!=="filter"&&s in t)return Vu[e]=s;s=dl(s);for(let r=0;r<vm.length;r++){const i=vm[r]+s;if(i in t)return Vu[e]=i}return e}const Tm="http://www.w3.org/1999/xlink";function Im(t,e,n,s,r,i=aA(e)){s&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Tm,e.slice(6,e.length)):t.setAttributeNS(Tm,e,n):n==null||i&&!_y(n)?t.removeAttribute(e):t.setAttribute(e,i?"":Tn(n)?String(n):n)}function wm(t,e,n,s,r){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?RE(n):n);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?t.getAttribute("value")||"":t.value,l=n==null?t.type==="checkbox"?"on":"":String(n);(a!==l||!("_value"in t))&&(t.value=l),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const a=typeof t[e];a==="boolean"?n=_y(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(r||e)}function wr(t,e,n,s){t.addEventListener(e,n,s)}function mC(t,e,n,s){t.removeEventListener(e,n,s)}const Am=Symbol("_vei");function gC(t,e,n,s,r=null){const i=t[Am]||(t[Am]={}),o=i[e];if(s&&o)o.value=s;else{const[a,l]=_C(e);if(s){const u=i[e]=vC(s,r);wr(t,a,u,l)}else o&&(mC(t,a,o,l),i[e]=void 0)}}const Rm=/(?:Once|Passive|Capture)$/;function _C(t){let e;if(Rm.test(t)){e={};let s;for(;s=t.match(Rm);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Ur(t.slice(2)),e]}let Mu=0;const yC=Promise.resolve(),EC=()=>Mu||(yC.then(()=>Mu=0),Mu=Date.now());function vC(t,e){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;wn(TC(s,n.value),e,5,[s])};return n.value=t,n.attached=EC(),n}function TC(t,e){if(ie(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const Cm=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,IC=(t,e,n,s,r,i)=>{const o=r==="svg";e==="class"?lC(t,s,o):e==="style"?dC(t,n,s):ll(e)?pf(e)||gC(t,e,n,s,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):wC(t,e,s,o))?(wm(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Im(t,e,s,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Je(s))?wm(t,cn(e),s,i,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),Im(t,e,s,o))};function wC(t,e,n,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&Cm(e)&&he(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&t.tagName==="IFRAME"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Cm(e)&&Je(n)?!1:e in t}const Pc=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ie(e)?n=>rc(e,n):e};function AC(t){t.target.composing=!0}function Sm(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ui=Symbol("_assign");function bm(t,e,n){return e&&(t=t.trim()),n&&(t=pl(t)),t}const FM={created(t,{modifiers:{lazy:e,trim:n,number:s}},r){t[ui]=Pc(r);const i=s||r.props&&r.props.type==="number";wr(t,e?"change":"input",o=>{o.target.composing||t[ui](bm(t.value,n,i))}),(n||i)&&wr(t,"change",()=>{t.value=bm(t.value,n,i)}),e||(wr(t,"compositionstart",AC),wr(t,"compositionend",Sm),wr(t,"change",Sm))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:s,trim:r,number:i}},o){if(t[ui]=Pc(o),t.composing)return;const a=(i||t.type==="number")&&!/^0\d/.test(t.value)?pl(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(s&&e===n||r&&t.value.trim()===l)||(t.value=l))}},UM={deep:!0,created(t,{value:e,modifiers:{number:n}},s){const r=ul(e);wr(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>n?pl(Nc(o)):Nc(o));t[ui](t.multiple?r?new Set(i):i:i[0]),t._assigning=!0,vl(()=>{t._assigning=!1})}),t[ui]=Pc(s)},mounted(t,{value:e}){Pm(t,e)},beforeUpdate(t,e,n){t[ui]=Pc(n)},updated(t,{value:e}){t._assigning||Pm(t,e)}};function Pm(t,e){const n=t.multiple,s=ie(e);if(!(n&&!s&&!ul(e))){for(let r=0,i=t.options.length;r<i;r++){const o=t.options[r],a=Nc(o);if(n)if(s){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(u=>String(u)===String(a)):o.selected=lA(e,a)>-1}else o.selected=e.has(a);else if(gl(Nc(o),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Nc(t){return"_value"in t?t._value:t.value}const RC=["ctrl","shift","alt","meta"],CC={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>RC.some(n=>t[`${n}Key`]&&!e.includes(n))},BM=(t,e)=>{const n=t._withMods||(t._withMods={}),s=e.join(".");return n[s]||(n[s]=((r,...i)=>{for(let o=0;o<e.length;o++){const a=CC[e[o]];if(a&&a(r,e))return}return t(r,...i)}))},SC=dt({patchProp:IC},nC);let Nm;function bC(){return Nm||(Nm=xR(SC))}const PC=((...t)=>{const e=bC().createApp(...t),{mount:n}=e;return e.mount=s=>{const r=kC(s);if(!r)return;const i=e._component;!he(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=n(r,!1,NC(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e});function NC(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function kC(t){return Je(t)?document.querySelector(t):t}let SE;const Cl=t=>SE=t,bE=Symbol();function vh(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var bo;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(bo||(bo={}));function DC(){const t=Ty(!0),e=t.run(()=>is({}));let n=[],s=[];const r=Af({install(i){Cl(r),r._a=i,i.provide(bE,r),i.config.globalProperties.$pinia=r,s.forEach(o=>n.push(o)),s=[]},use(i){return this._a?n.push(i):s.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return r}const PE=()=>{};function km(t,e,n,s=PE){t.add(e);const r=()=>{t.delete(e)&&s()};return!n&&Iy()&&hA(r),r}function Qr(t,...e){t.forEach(n=>{n(...e)})}const OC=t=>t(),Dm=Symbol(),Lu=Symbol();function Th(t,e){t instanceof Map&&e instanceof Map?e.forEach((n,s)=>t.set(s,n)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const s=e[n],r=t[n];vh(r)&&vh(s)&&t.hasOwnProperty(n)&&!Ye(s)&&!rs(s)?t[n]=Th(r,s):t[n]=s}return t}const xC=Symbol();function VC(t){return!vh(t)||!Object.prototype.hasOwnProperty.call(t,xC)}const{assign:Ds}=Object;function MC(t){return!!(Ye(t)&&t.effect)}function LC(t,e,n,s){const{state:r,actions:i,getters:o}=e,a=n.state.value[t];let l;function u(){a||(n.state.value[t]=r?r():{});const h=xA(n.state.value[t]);return Ds(h,i,Object.keys(o||{}).reduce((d,m)=>(d[m]=Af(it(()=>{Cl(n);const g=n._s.get(t);return o[m].call(g,g)})),d),{}))}return l=NE(t,u,e,n,s,!0),l}function NE(t,e,n={},s,r,i){let o;const a=Ds({actions:{}},n),l={deep:!0};let u,h,d=new Set,m=new Set,g;const S=s.state.value[t];!i&&!S&&(s.state.value[t]={}),is({});let P;function N(E){let y;u=h=!1,typeof E=="function"?(E(s.state.value[t]),y={type:bo.patchFunction,storeId:t,events:g}):(Th(s.state.value[t],E),y={type:bo.patchObject,payload:E,storeId:t,events:g});const A=P=Symbol();vl().then(()=>{P===A&&(u=!0)}),h=!0,Qr(d,y,s.state.value[t])}const O=i?function(){const{state:y}=n,A=y?y():{};this.$patch(w=>{Ds(w,A)})}:PE;function B(){o.stop(),d.clear(),m.clear(),s._s.delete(t)}const q=(E,y="")=>{if(Dm in E)return E[Lu]=y,E;const A=function(){Cl(s);const w=Array.from(arguments),I=new Set,v=new Set;function ve(de){I.add(de)}function Ge(de){v.add(de)}Qr(m,{args:w,name:A[Lu],store:ee,after:ve,onError:Ge});let De;try{De=E.apply(this&&this.$id===t?this:ee,w)}catch(de){throw Qr(v,de),de}return De instanceof Promise?De.then(de=>(Qr(I,de),de)).catch(de=>(Qr(v,de),Promise.reject(de))):(Qr(I,De),De)};return A[Dm]=!0,A[Lu]=y,A},$={_p:s,$id:t,$onAction:km.bind(null,m),$patch:N,$reset:O,$subscribe(E,y={}){const A=km(d,E,y.detached,()=>w()),w=o.run(()=>Co(()=>s.state.value[t],I=>{(y.flush==="sync"?h:u)&&E({storeId:t,type:bo.direct,events:g},I)},Ds({},l,y)));return A},$dispose:B},ee=la($);s._s.set(t,ee);const C=(s._a&&s._a.runWithContext||OC)(()=>s._e.run(()=>(o=Ty()).run(()=>e({action:q}))));for(const E in C){const y=C[E];if(Ye(y)&&!MC(y)||rs(y))i||(S&&VC(y)&&(Ye(y)?y.value=S[E]:Th(y,S[E])),s.state.value[t][E]=y);else if(typeof y=="function"){const A=q(y,E);C[E]=A,a.actions[E]=y}}return Ds(ee,C),Ds(Se(ee),C),Object.defineProperty(ee,"$state",{get:()=>s.state.value[t],set:E=>{N(y=>{Ds(y,E)})}}),s._p.forEach(E=>{Ds(ee,o.run(()=>E({store:ee,app:s._a,pinia:s,options:a})))}),S&&i&&n.hydrate&&n.hydrate(ee.$state,S),u=!0,h=!0,ee}function kE(t,e,n){let s;const r=typeof e=="function";s=r?n:e;function i(o,a){const l=_R();return o=o||(l?on(bE,null):null),o&&Cl(o),o=SE,o._s.has(t)||(r?NE(t,e,s,o):LC(t,s,o)),o._s.get(t)}return i.$id=t,i}const FC=()=>{};var Om={};const DE={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};const z=function(t,e){if(!t)throw Ni(e)},Ni=function(t){return new Error("Firebase Database ("+DE.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};const OE=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},UC=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],l=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},kf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,l=r+2<t.length,u=l?t[r+2]:0,h=i>>2,d=(i&3)<<4|a>>4;let m=(a&15)<<2|u>>6,g=u&63;l||(g=64,o||(m=64)),s.push(n[h],n[d],n[m],n[g])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(OE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):UC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const u=r<t.length?n[t.charAt(r)]:64;++r;const d=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||a==null||u==null||d==null)throw new BC;const m=i<<2|a>>4;if(s.push(m),u!==64){const g=a<<4&240|u>>2;if(s.push(g),d!==64){const S=u<<6&192|d;s.push(S)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class BC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const xE=function(t){const e=OE(t);return kf.encodeByteArray(e,!0)},kc=function(t){return xE(t).replace(/\./g,"")},Dc=function(t){try{return kf.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function jC(t){return VE(void 0,t)}function VE(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!qC(n)||(t[n]=VE(t[n],e[n]));return t}function qC(t){return t!=="__proto__"}function HC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const WC=()=>HC().__FIREBASE_DEFAULTS__,$C=()=>{if(typeof process>"u"||typeof Om>"u")return;const t=Om.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},GC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Dc(t[1]);return e&&JSON.parse(e)},Sl=()=>{try{return FC()||WC()||$C()||GC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ME=t=>Sl()?.emulatorHosts?.[t],Df=t=>{const e=ME(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},LE=()=>Sl()?.config,FE=t=>Sl()?.[`_${t}`];class Of{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}function vs(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function bl(t){return(await fetch(t,{credentials:"include"})).ok}function xf(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[kc(JSON.stringify(n)),kc(JSON.stringify(o)),""].join(".")}const Po={};function KC(){const t={prod:[],emulator:[]};for(const e of Object.keys(Po))Po[e]?t.emulator.push(e):t.prod.push(e);return t}function zC(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let xm=!1;function Pl(t,e){if(typeof window>"u"||typeof document>"u"||!vs(window.location.host)||Po[t]===e||Po[t]||xm)return;Po[t]=e;function n(m){return`__firebase__banner__${m}`}const s="__firebase__banner",i=KC().prod.length>0;function o(){const m=document.getElementById(s);m&&m.remove()}function a(m){m.style.display="flex",m.style.background="#7faaf0",m.style.position="fixed",m.style.bottom="5px",m.style.left="5px",m.style.padding=".5em",m.style.borderRadius="5px",m.style.alignItems="center"}function l(m,g){m.setAttribute("width","24"),m.setAttribute("id",g),m.setAttribute("height","24"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.style.marginLeft="-6px"}function u(){const m=document.createElement("span");return m.style.cursor="pointer",m.style.marginLeft="16px",m.style.fontSize="24px",m.innerHTML=" &times;",m.onclick=()=>{xm=!0,o()},m}function h(m,g){m.setAttribute("id",g),m.innerText="Learn more",m.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",m.setAttribute("target","__blank"),m.style.paddingLeft="5px",m.style.textDecoration="underline"}function d(){const m=zC(s),g=n("text"),S=document.getElementById(g)||document.createElement("span"),P=n("learnmore"),N=document.getElementById(P)||document.createElement("a"),O=n("preprendIcon"),B=document.getElementById(O)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(m.created){const q=m.element;a(q),h(N,P);const $=u();l(B,O),q.append(B,S,N,$),document.body.appendChild(q)}i?(S.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",g)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}function Ot(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Vf(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ot())}function QC(){const t=Sl()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function YC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function XC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function UE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function JC(){const t=Ot();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function ZC(){return DE.NODE_ADMIN===!0}function eS(){return!QC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function tS(){try{return typeof indexedDB=="object"}catch{return!1}}function nS(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{e(r.error?.message||"")}}catch(n){e(n)}})}const sS="FirebaseError";class Hn extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=sS,Object.setPrototypeOf(this,Hn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fa.prototype.create)}}class fa{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?rS(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new Hn(r,a,s)}}function rS(t,e){return t.replace(iS,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const iS=/\{\$([^}]+)}/g;function zo(t){return JSON.parse(t)}function gt(t){return JSON.stringify(t)}const BE=function(t){let e={},n={},s={},r="";try{const i=t.split(".");e=zo(Dc(i[0])||""),n=zo(Dc(i[1])||""),r=i[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:r}},oS=function(t){const e=BE(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},aS=function(t){const e=BE(t).claims;return typeof e=="object"&&e.admin===!0};function Ts(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function yi(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Ih(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Oc(t,e,n){const s={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=e.call(n,t[r],r,t));return s}function fs(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(Vm(i)&&Vm(o)){if(!fs(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function Vm(t){return t!==null&&typeof t=="object"}function ki(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function po(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function mo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class cS{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)s[d]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let d=0;d<16;d++)s[d]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let d=16;d<80;d++){const m=s[d-3]^s[d-8]^s[d-14]^s[d-16];s[d]=(m<<1|m>>>31)&4294967295}let r=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],u,h;for(let d=0;d<80;d++){d<40?d<20?(u=a^i&(o^a),h=1518500249):(u=i^o^a,h=1859775393):d<60?(u=i&o|a&(i|o),h=2400959708):(u=i^o^a,h=3395469782);const m=(r<<5|r>>>27)+u+l+h+s[d]&4294967295;l=a,a=o,o=(i<<30|i>>>2)&4294967295,i=r,r=m}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=s;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<n;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let r=0;r<5;r++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[r]>>i&255,++s;return e}}function lS(t,e){const n=new uS(t,e);return n.subscribe.bind(n)}class uS{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");hS(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=Fu),r.error===void 0&&(r.error=Fu),r.complete===void 0&&(r.complete=Fu);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function hS(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Fu(){}function fS(t,e){return`${t} failed: ${e} argument `}const dS=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);if(r>=55296&&r<=56319){const i=r-55296;s++,z(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;r=65536+(i<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},Nl=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};function $e(t){return t&&t._delegate?t._delegate:t}class ds{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const vr="[DEFAULT]";class pS{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Of;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gS(e))try{this.getOrInitializeService({instanceIdentifier:vr})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=vr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=vr){return this.instances.has(e)}getOptions(e=vr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:mS(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=vr){return this.component?this.component.multipleInstances?e:vr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function mS(t){return t===vr?void 0:t}function gS(t){return t.instantiationMode==="EAGER"}class _S{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new pS(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var ge;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ge||(ge={}));const yS={debug:ge.DEBUG,verbose:ge.VERBOSE,info:ge.INFO,warn:ge.WARN,error:ge.ERROR,silent:ge.SILENT},ES=ge.INFO,vS={[ge.DEBUG]:"log",[ge.VERBOSE]:"log",[ge.INFO]:"info",[ge.WARN]:"warn",[ge.ERROR]:"error"},TS=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=vS[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kl{constructor(e){this.name=e,this._logLevel=ES,this._logHandler=TS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ge))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?yS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ge.DEBUG,...e),this._logHandler(this,ge.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ge.VERBOSE,...e),this._logHandler(this,ge.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ge.INFO,...e),this._logHandler(this,ge.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ge.WARN,...e),this._logHandler(this,ge.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ge.ERROR,...e),this._logHandler(this,ge.ERROR,...e)}}const IS=(t,e)=>e.some(n=>t instanceof n);let Mm,Lm;function wS(){return Mm||(Mm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function AS(){return Lm||(Lm=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jE=new WeakMap,wh=new WeakMap,qE=new WeakMap,Uu=new WeakMap,Mf=new WeakMap;function RS(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Hs(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&jE.set(n,t)}).catch(()=>{}),Mf.set(e,t),e}function CS(t){if(wh.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});wh.set(t,e)}let Ah={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return wh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||qE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Hs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function SS(t){Ah=t(Ah)}function bS(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Bu(this),e,...n);return qE.set(s,e.sort?e.sort():[e]),Hs(s)}:AS().includes(t)?function(...e){return t.apply(Bu(this),e),Hs(jE.get(this))}:function(...e){return Hs(t.apply(Bu(this),e))}}function PS(t){return typeof t=="function"?bS(t):(t instanceof IDBTransaction&&CS(t),IS(t,wS())?new Proxy(t,Ah):t)}function Hs(t){if(t instanceof IDBRequest)return RS(t);if(Uu.has(t))return Uu.get(t);const e=PS(t);return e!==t&&(Uu.set(t,e),Mf.set(e,t)),e}const Bu=t=>Mf.get(t);function NS(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=Hs(o);return s&&o.addEventListener("upgradeneeded",l=>{s(Hs(o.result),l.oldVersion,l.newVersion,Hs(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),r&&l.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const kS=["get","getKey","getAll","getAllKeys","count"],DS=["put","add","delete","clear"],ju=new Map;function Fm(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ju.get(e))return ju.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=DS.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||kS.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let u=l.store;return s&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),r&&l.done]))[0]};return ju.set(e,i),i}SS(t=>({...t,get:(e,n,s)=>Fm(e,n)||t.get(e,n,s),has:(e,n)=>!!Fm(e,n)||t.has(e,n)}));class OS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(xS(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function xS(t){return t.getComponent()?.type==="VERSION"}const Rh="@firebase/app",Um="0.14.6";const ps=new kl("@firebase/app"),VS="@firebase/app-compat",MS="@firebase/analytics-compat",LS="@firebase/analytics",FS="@firebase/app-check-compat",US="@firebase/app-check",BS="@firebase/auth",jS="@firebase/auth-compat",qS="@firebase/database",HS="@firebase/data-connect",WS="@firebase/database-compat",$S="@firebase/functions",GS="@firebase/functions-compat",KS="@firebase/installations",zS="@firebase/installations-compat",QS="@firebase/messaging",YS="@firebase/messaging-compat",XS="@firebase/performance",JS="@firebase/performance-compat",ZS="@firebase/remote-config",eb="@firebase/remote-config-compat",tb="@firebase/storage",nb="@firebase/storage-compat",sb="@firebase/firestore",rb="@firebase/ai",ib="@firebase/firestore-compat",ob="firebase",ab="12.6.0";const Ch="[DEFAULT]",cb={[Rh]:"fire-core",[VS]:"fire-core-compat",[LS]:"fire-analytics",[MS]:"fire-analytics-compat",[US]:"fire-app-check",[FS]:"fire-app-check-compat",[BS]:"fire-auth",[jS]:"fire-auth-compat",[qS]:"fire-rtdb",[HS]:"fire-data-connect",[WS]:"fire-rtdb-compat",[$S]:"fire-fn",[GS]:"fire-fn-compat",[KS]:"fire-iid",[zS]:"fire-iid-compat",[QS]:"fire-fcm",[YS]:"fire-fcm-compat",[XS]:"fire-perf",[JS]:"fire-perf-compat",[ZS]:"fire-rc",[eb]:"fire-rc-compat",[tb]:"fire-gcs",[nb]:"fire-gcs-compat",[sb]:"fire-fst",[ib]:"fire-fst-compat",[rb]:"fire-vertex","fire-js":"fire-js",[ob]:"fire-js-all"};const xc=new Map,lb=new Map,Sh=new Map;function Bm(t,e){try{t.container.addComponent(e)}catch(n){ps.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ys(t){const e=t.name;if(Sh.has(e))return ps.debug(`There were multiple attempts to register component ${e}.`),!1;Sh.set(e,t);for(const n of xc.values())Bm(n,t);for(const n of lb.values())Bm(n,t);return!0}function da(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Ft(t){return t==null?!1:t.settings!==void 0}const ub={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ws=new fa("app","Firebase",ub);class hb{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ds("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ws.create("app-deleted",{appName:this._name})}}const rr=ab;function HE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:Ch,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw Ws.create("bad-app-name",{appName:String(r)});if(n||(n=LE()),!n)throw Ws.create("no-options");const i=xc.get(r);if(i){if(fs(n,i.options)&&fs(s,i.config))return i;throw Ws.create("duplicate-app",{appName:r})}const o=new _S(r);for(const l of Sh.values())o.addComponent(l);const a=new hb(n,s,o);return xc.set(r,a),a}function Dl(t=Ch){const e=xc.get(t);if(!e&&t===Ch&&LE())return HE();if(!e)throw Ws.create("no-app",{appName:t});return e}function an(t,e,n){let s=cb[t]??t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ps.warn(o.join(" "));return}Ys(new ds(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const fb="firebase-heartbeat-database",db=1,Qo="firebase-heartbeat-store";let qu=null;function WE(){return qu||(qu=NS(fb,db,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Qo)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ws.create("idb-open",{originalErrorMessage:t.message})})),qu}async function pb(t){try{const n=(await WE()).transaction(Qo),s=await n.objectStore(Qo).get($E(t));return await n.done,s}catch(e){if(e instanceof Hn)ps.warn(e.message);else{const n=Ws.create("idb-get",{originalErrorMessage:e?.message});ps.warn(n.message)}}}async function jm(t,e){try{const s=(await WE()).transaction(Qo,"readwrite");await s.objectStore(Qo).put(e,$E(t)),await s.done}catch(n){if(n instanceof Hn)ps.warn(n.message);else{const s=Ws.create("idb-set",{originalErrorMessage:n?.message});ps.warn(s.message)}}}function $E(t){return`${t.name}!${t.options.appId}`}const mb=1024,gb=30;class _b{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Eb(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=qm();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats.length>gb){const r=vb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(r,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ps.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=qm(),{heartbeatsToSend:n,unsentEntries:s}=yb(this._heartbeatsCache.heartbeats),r=kc(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return ps.warn(e),""}}}function qm(){return new Date().toISOString().substring(0,10)}function yb(t,e=mb){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Hm(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Hm(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class Eb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return tS()?nS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await pb(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return jm(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return jm(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Hm(t){return kc(JSON.stringify({version:2,heartbeats:t})).length}function vb(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}function Tb(t){Ys(new ds("platform-logger",e=>new OS(e),"PRIVATE")),Ys(new ds("heartbeat",e=>new _b(e),"PRIVATE")),an(Rh,Um,t),an(Rh,Um,"esm2020"),an("fire-js","")}Tb("");var Ib="firebase",wb="12.6.0";an(Ib,wb,"app");var Wm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var $s,GE;(function(){var t;function e(C,E){function y(){}y.prototype=E.prototype,C.F=E.prototype,C.prototype=new y,C.prototype.constructor=C,C.D=function(A,w,I){for(var v=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)v[ve-2]=arguments[ve];return E.prototype[w].apply(A,v)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,n),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(C,E,y){y||(y=0);const A=Array(16);if(typeof E=="string")for(var w=0;w<16;++w)A[w]=E.charCodeAt(y++)|E.charCodeAt(y++)<<8|E.charCodeAt(y++)<<16|E.charCodeAt(y++)<<24;else for(w=0;w<16;++w)A[w]=E[y++]|E[y++]<<8|E[y++]<<16|E[y++]<<24;E=C.g[0],y=C.g[1],w=C.g[2];let I=C.g[3],v;v=E+(I^y&(w^I))+A[0]+3614090360&4294967295,E=y+(v<<7&4294967295|v>>>25),v=I+(w^E&(y^w))+A[1]+3905402710&4294967295,I=E+(v<<12&4294967295|v>>>20),v=w+(y^I&(E^y))+A[2]+606105819&4294967295,w=I+(v<<17&4294967295|v>>>15),v=y+(E^w&(I^E))+A[3]+3250441966&4294967295,y=w+(v<<22&4294967295|v>>>10),v=E+(I^y&(w^I))+A[4]+4118548399&4294967295,E=y+(v<<7&4294967295|v>>>25),v=I+(w^E&(y^w))+A[5]+1200080426&4294967295,I=E+(v<<12&4294967295|v>>>20),v=w+(y^I&(E^y))+A[6]+2821735955&4294967295,w=I+(v<<17&4294967295|v>>>15),v=y+(E^w&(I^E))+A[7]+4249261313&4294967295,y=w+(v<<22&4294967295|v>>>10),v=E+(I^y&(w^I))+A[8]+1770035416&4294967295,E=y+(v<<7&4294967295|v>>>25),v=I+(w^E&(y^w))+A[9]+2336552879&4294967295,I=E+(v<<12&4294967295|v>>>20),v=w+(y^I&(E^y))+A[10]+4294925233&4294967295,w=I+(v<<17&4294967295|v>>>15),v=y+(E^w&(I^E))+A[11]+2304563134&4294967295,y=w+(v<<22&4294967295|v>>>10),v=E+(I^y&(w^I))+A[12]+1804603682&4294967295,E=y+(v<<7&4294967295|v>>>25),v=I+(w^E&(y^w))+A[13]+4254626195&4294967295,I=E+(v<<12&4294967295|v>>>20),v=w+(y^I&(E^y))+A[14]+2792965006&4294967295,w=I+(v<<17&4294967295|v>>>15),v=y+(E^w&(I^E))+A[15]+1236535329&4294967295,y=w+(v<<22&4294967295|v>>>10),v=E+(w^I&(y^w))+A[1]+4129170786&4294967295,E=y+(v<<5&4294967295|v>>>27),v=I+(y^w&(E^y))+A[6]+3225465664&4294967295,I=E+(v<<9&4294967295|v>>>23),v=w+(E^y&(I^E))+A[11]+643717713&4294967295,w=I+(v<<14&4294967295|v>>>18),v=y+(I^E&(w^I))+A[0]+3921069994&4294967295,y=w+(v<<20&4294967295|v>>>12),v=E+(w^I&(y^w))+A[5]+3593408605&4294967295,E=y+(v<<5&4294967295|v>>>27),v=I+(y^w&(E^y))+A[10]+38016083&4294967295,I=E+(v<<9&4294967295|v>>>23),v=w+(E^y&(I^E))+A[15]+3634488961&4294967295,w=I+(v<<14&4294967295|v>>>18),v=y+(I^E&(w^I))+A[4]+3889429448&4294967295,y=w+(v<<20&4294967295|v>>>12),v=E+(w^I&(y^w))+A[9]+568446438&4294967295,E=y+(v<<5&4294967295|v>>>27),v=I+(y^w&(E^y))+A[14]+3275163606&4294967295,I=E+(v<<9&4294967295|v>>>23),v=w+(E^y&(I^E))+A[3]+4107603335&4294967295,w=I+(v<<14&4294967295|v>>>18),v=y+(I^E&(w^I))+A[8]+1163531501&4294967295,y=w+(v<<20&4294967295|v>>>12),v=E+(w^I&(y^w))+A[13]+2850285829&4294967295,E=y+(v<<5&4294967295|v>>>27),v=I+(y^w&(E^y))+A[2]+4243563512&4294967295,I=E+(v<<9&4294967295|v>>>23),v=w+(E^y&(I^E))+A[7]+1735328473&4294967295,w=I+(v<<14&4294967295|v>>>18),v=y+(I^E&(w^I))+A[12]+2368359562&4294967295,y=w+(v<<20&4294967295|v>>>12),v=E+(y^w^I)+A[5]+4294588738&4294967295,E=y+(v<<4&4294967295|v>>>28),v=I+(E^y^w)+A[8]+2272392833&4294967295,I=E+(v<<11&4294967295|v>>>21),v=w+(I^E^y)+A[11]+1839030562&4294967295,w=I+(v<<16&4294967295|v>>>16),v=y+(w^I^E)+A[14]+4259657740&4294967295,y=w+(v<<23&4294967295|v>>>9),v=E+(y^w^I)+A[1]+2763975236&4294967295,E=y+(v<<4&4294967295|v>>>28),v=I+(E^y^w)+A[4]+1272893353&4294967295,I=E+(v<<11&4294967295|v>>>21),v=w+(I^E^y)+A[7]+4139469664&4294967295,w=I+(v<<16&4294967295|v>>>16),v=y+(w^I^E)+A[10]+3200236656&4294967295,y=w+(v<<23&4294967295|v>>>9),v=E+(y^w^I)+A[13]+681279174&4294967295,E=y+(v<<4&4294967295|v>>>28),v=I+(E^y^w)+A[0]+3936430074&4294967295,I=E+(v<<11&4294967295|v>>>21),v=w+(I^E^y)+A[3]+3572445317&4294967295,w=I+(v<<16&4294967295|v>>>16),v=y+(w^I^E)+A[6]+76029189&4294967295,y=w+(v<<23&4294967295|v>>>9),v=E+(y^w^I)+A[9]+3654602809&4294967295,E=y+(v<<4&4294967295|v>>>28),v=I+(E^y^w)+A[12]+3873151461&4294967295,I=E+(v<<11&4294967295|v>>>21),v=w+(I^E^y)+A[15]+530742520&4294967295,w=I+(v<<16&4294967295|v>>>16),v=y+(w^I^E)+A[2]+3299628645&4294967295,y=w+(v<<23&4294967295|v>>>9),v=E+(w^(y|~I))+A[0]+4096336452&4294967295,E=y+(v<<6&4294967295|v>>>26),v=I+(y^(E|~w))+A[7]+1126891415&4294967295,I=E+(v<<10&4294967295|v>>>22),v=w+(E^(I|~y))+A[14]+2878612391&4294967295,w=I+(v<<15&4294967295|v>>>17),v=y+(I^(w|~E))+A[5]+4237533241&4294967295,y=w+(v<<21&4294967295|v>>>11),v=E+(w^(y|~I))+A[12]+1700485571&4294967295,E=y+(v<<6&4294967295|v>>>26),v=I+(y^(E|~w))+A[3]+2399980690&4294967295,I=E+(v<<10&4294967295|v>>>22),v=w+(E^(I|~y))+A[10]+4293915773&4294967295,w=I+(v<<15&4294967295|v>>>17),v=y+(I^(w|~E))+A[1]+2240044497&4294967295,y=w+(v<<21&4294967295|v>>>11),v=E+(w^(y|~I))+A[8]+1873313359&4294967295,E=y+(v<<6&4294967295|v>>>26),v=I+(y^(E|~w))+A[15]+4264355552&4294967295,I=E+(v<<10&4294967295|v>>>22),v=w+(E^(I|~y))+A[6]+2734768916&4294967295,w=I+(v<<15&4294967295|v>>>17),v=y+(I^(w|~E))+A[13]+1309151649&4294967295,y=w+(v<<21&4294967295|v>>>11),v=E+(w^(y|~I))+A[4]+4149444226&4294967295,E=y+(v<<6&4294967295|v>>>26),v=I+(y^(E|~w))+A[11]+3174756917&4294967295,I=E+(v<<10&4294967295|v>>>22),v=w+(E^(I|~y))+A[2]+718787259&4294967295,w=I+(v<<15&4294967295|v>>>17),v=y+(I^(w|~E))+A[9]+3951481745&4294967295,C.g[0]=C.g[0]+E&4294967295,C.g[1]=C.g[1]+(w+(v<<21&4294967295|v>>>11))&4294967295,C.g[2]=C.g[2]+w&4294967295,C.g[3]=C.g[3]+I&4294967295}s.prototype.v=function(C,E){E===void 0&&(E=C.length);const y=E-this.blockSize,A=this.C;let w=this.h,I=0;for(;I<E;){if(w==0)for(;I<=y;)r(this,C,I),I+=this.blockSize;if(typeof C=="string"){for(;I<E;)if(A[w++]=C.charCodeAt(I++),w==this.blockSize){r(this,A),w=0;break}}else for(;I<E;)if(A[w++]=C[I++],w==this.blockSize){r(this,A),w=0;break}}this.h=w,this.o+=E},s.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var E=1;E<C.length-8;++E)C[E]=0;E=this.o*8;for(var y=C.length-8;y<C.length;++y)C[y]=E&255,E/=256;for(this.v(C),C=Array(16),E=0,y=0;y<4;++y)for(let A=0;A<32;A+=8)C[E++]=this.g[y]>>>A&255;return C};function i(C,E){var y=a;return Object.prototype.hasOwnProperty.call(y,C)?y[C]:y[C]=E(C)}function o(C,E){this.h=E;const y=[];let A=!0;for(let w=C.length-1;w>=0;w--){const I=C[w]|0;A&&I==E||(y[w]=I,A=!1)}this.g=y}var a={};function l(C){return-128<=C&&C<128?i(C,function(E){return new o([E|0],E<0?-1:0)}):new o([C|0],C<0?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return d;if(C<0)return N(u(-C));const E=[];let y=1;for(let A=0;C>=y;A++)E[A]=C/y|0,y*=4294967296;return new o(E,0)}function h(C,E){if(C.length==0)throw Error("number format error: empty string");if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(C.charAt(0)=="-")return N(h(C.substring(1),E));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const y=u(Math.pow(E,8));let A=d;for(let I=0;I<C.length;I+=8){var w=Math.min(8,C.length-I);const v=parseInt(C.substring(I,I+w),E);w<8?(w=u(Math.pow(E,w)),A=A.j(w).add(u(v))):(A=A.j(y),A=A.add(u(v)))}return A}var d=l(0),m=l(1),g=l(16777216);t=o.prototype,t.m=function(){if(P(this))return-N(this).m();let C=0,E=1;for(let y=0;y<this.g.length;y++){const A=this.i(y);C+=(A>=0?A:4294967296+A)*E,E*=4294967296}return C},t.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(S(this))return"0";if(P(this))return"-"+N(this).toString(C);const E=u(Math.pow(C,6));var y=this;let A="";for(;;){const w=$(y,E).g;y=O(y,w.j(E));let I=((y.g.length>0?y.g[0]:y.h)>>>0).toString(C);if(y=w,S(y))return I+A;for(;I.length<6;)I="0"+I;A=I+A}},t.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function S(C){if(C.h!=0)return!1;for(let E=0;E<C.g.length;E++)if(C.g[E]!=0)return!1;return!0}function P(C){return C.h==-1}t.l=function(C){return C=O(this,C),P(C)?-1:S(C)?0:1};function N(C){const E=C.g.length,y=[];for(let A=0;A<E;A++)y[A]=~C.g[A];return new o(y,~C.h).add(m)}t.abs=function(){return P(this)?N(this):this},t.add=function(C){const E=Math.max(this.g.length,C.g.length),y=[];let A=0;for(let w=0;w<=E;w++){let I=A+(this.i(w)&65535)+(C.i(w)&65535),v=(I>>>16)+(this.i(w)>>>16)+(C.i(w)>>>16);A=v>>>16,I&=65535,v&=65535,y[w]=v<<16|I}return new o(y,y[y.length-1]&-2147483648?-1:0)};function O(C,E){return C.add(N(E))}t.j=function(C){if(S(this)||S(C))return d;if(P(this))return P(C)?N(this).j(N(C)):N(N(this).j(C));if(P(C))return N(this.j(N(C)));if(this.l(g)<0&&C.l(g)<0)return u(this.m()*C.m());const E=this.g.length+C.g.length,y=[];for(var A=0;A<2*E;A++)y[A]=0;for(A=0;A<this.g.length;A++)for(let w=0;w<C.g.length;w++){const I=this.i(A)>>>16,v=this.i(A)&65535,ve=C.i(w)>>>16,Ge=C.i(w)&65535;y[2*A+2*w]+=v*Ge,B(y,2*A+2*w),y[2*A+2*w+1]+=I*Ge,B(y,2*A+2*w+1),y[2*A+2*w+1]+=v*ve,B(y,2*A+2*w+1),y[2*A+2*w+2]+=I*ve,B(y,2*A+2*w+2)}for(C=0;C<E;C++)y[C]=y[2*C+1]<<16|y[2*C];for(C=E;C<2*E;C++)y[C]=0;return new o(y,0)};function B(C,E){for(;(C[E]&65535)!=C[E];)C[E+1]+=C[E]>>>16,C[E]&=65535,E++}function q(C,E){this.g=C,this.h=E}function $(C,E){if(S(E))throw Error("division by zero");if(S(C))return new q(d,d);if(P(C))return E=$(N(C),E),new q(N(E.g),N(E.h));if(P(E))return E=$(C,N(E)),new q(N(E.g),E.h);if(C.g.length>30){if(P(C)||P(E))throw Error("slowDivide_ only works with positive integers.");for(var y=m,A=E;A.l(C)<=0;)y=ee(y),A=ee(A);var w=oe(y,1),I=oe(A,1);for(A=oe(A,2),y=oe(y,2);!S(A);){var v=I.add(A);v.l(C)<=0&&(w=w.add(y),I=v),A=oe(A,1),y=oe(y,1)}return E=O(C,w.j(E)),new q(w,E)}for(w=d;C.l(E)>=0;){for(y=Math.max(1,Math.floor(C.m()/E.m())),A=Math.ceil(Math.log(y)/Math.LN2),A=A<=48?1:Math.pow(2,A-48),I=u(y),v=I.j(E);P(v)||v.l(C)>0;)y-=A,I=u(y),v=I.j(E);S(I)&&(I=m),w=w.add(I),C=O(C,v)}return new q(w,C)}t.B=function(C){return $(this,C).h},t.and=function(C){const E=Math.max(this.g.length,C.g.length),y=[];for(let A=0;A<E;A++)y[A]=this.i(A)&C.i(A);return new o(y,this.h&C.h)},t.or=function(C){const E=Math.max(this.g.length,C.g.length),y=[];for(let A=0;A<E;A++)y[A]=this.i(A)|C.i(A);return new o(y,this.h|C.h)},t.xor=function(C){const E=Math.max(this.g.length,C.g.length),y=[];for(let A=0;A<E;A++)y[A]=this.i(A)^C.i(A);return new o(y,this.h^C.h)};function ee(C){const E=C.g.length+1,y=[];for(let A=0;A<E;A++)y[A]=C.i(A)<<1|C.i(A-1)>>>31;return new o(y,C.h)}function oe(C,E){const y=E>>5;E%=32;const A=C.g.length-y,w=[];for(let I=0;I<A;I++)w[I]=E>0?C.i(I+y)>>>E|C.i(I+y+1)<<32-E:C.i(I+y);return new o(w,C.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,GE=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,$s=o}).apply(typeof Wm<"u"?Wm:typeof self<"u"?self:typeof window<"u"?window:{});var Ka=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var KE,go,zE,cc,bh,QE,YE,XE;(function(){var t,e=Object.defineProperty;function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ka=="object"&&Ka];for(var f=0;f<c.length;++f){var p=c[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var s=n(this);function r(c,f){if(f)e:{var p=s;c=c.split(".");for(var _=0;_<c.length-1;_++){var k=c[_];if(!(k in p))break e;p=p[k]}c=c[c.length-1],_=p[c],f=f(_),f!=_&&f!=null&&e(p,c,{configurable:!0,writable:!0,value:f})}}r("Symbol.dispose",function(c){return c||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(c){return c||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(c){return c||function(f){var p=[],_;for(_ in f)Object.prototype.hasOwnProperty.call(f,_)&&p.push([_,f[_]]);return p}});var i=i||{},o=this||self;function a(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function l(c,f,p){return c.call.apply(c.bind,arguments)}function u(c,f,p){return u=l,u.apply(null,arguments)}function h(c,f){var p=Array.prototype.slice.call(arguments,1);return function(){var _=p.slice();return _.push.apply(_,arguments),c.apply(this,_)}}function d(c,f){function p(){}p.prototype=f.prototype,c.Z=f.prototype,c.prototype=new p,c.prototype.constructor=c,c.Ob=function(_,k,D){for(var G=Array(arguments.length-2),pe=2;pe<arguments.length;pe++)G[pe-2]=arguments[pe];return f.prototype[k].apply(_,G)}}var m=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?c=>c&&AsyncContext.Snapshot.wrap(c):c=>c;function g(c){const f=c.length;if(f>0){const p=Array(f);for(let _=0;_<f;_++)p[_]=c[_];return p}return[]}function S(c,f){for(let _=1;_<arguments.length;_++){const k=arguments[_];var p=typeof k;if(p=p!="object"?p:k?Array.isArray(k)?"array":p:"null",p=="array"||p=="object"&&typeof k.length=="number"){p=c.length||0;const D=k.length||0;c.length=p+D;for(let G=0;G<D;G++)c[p+G]=k[G]}else c.push(k)}}class P{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function N(c){o.setTimeout(()=>{throw c},0)}function O(){var c=C;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class B{constructor(){this.h=this.g=null}add(f,p){const _=q.get();_.set(f,p),this.h?this.h.next=_:this.g=_,this.h=_}}var q=new P(()=>new $,c=>c.reset());class ${constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,oe=!1,C=new B,E=()=>{const c=Promise.resolve(void 0);ee=()=>{c.then(y)}};function y(){for(var c;c=O();){try{c.h.call(c.g)}catch(p){N(p)}var f=q;f.j(c),f.h<100&&(f.h++,c.next=f.g,f.g=c)}oe=!1}function A(){this.u=this.u,this.C=this.C}A.prototype.u=!1,A.prototype.dispose=function(){this.u||(this.u=!0,this.N())},A.prototype[Symbol.dispose]=function(){this.dispose()},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function w(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}w.prototype.h=function(){this.defaultPrevented=!0};var I=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const p=()=>{};o.addEventListener("test",p,f),o.removeEventListener("test",p,f)}catch{}return c})();function v(c){return/^[\s\xa0]*$/.test(c)}function ve(c,f){w.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c&&this.init(c,f)}d(ve,w),ve.prototype.init=function(c,f){const p=this.type=c.type,_=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget,f||(p=="mouseover"?f=c.fromElement:p=="mouseout"&&(f=c.toElement)),this.relatedTarget=f,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=c.pointerType,this.state=c.state,this.i=c,c.defaultPrevented&&ve.Z.h.call(this)},ve.prototype.h=function(){ve.Z.h.call(this);const c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ge="closure_listenable_"+(Math.random()*1e6|0),De=0;function de(c,f,p,_,k){this.listener=c,this.proxy=null,this.src=f,this.type=p,this.capture=!!_,this.ha=k,this.key=++De,this.da=this.fa=!1}function Te(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function jt(c,f,p){for(const _ in c)f.call(p,c[_],_,c)}function Cn(c,f){for(const p in c)f.call(void 0,c[p],p,c)}function Gt(c){const f={};for(const p in c)f[p]=c[p];return f}const pt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $n(c,f){let p,_;for(let k=1;k<arguments.length;k++){_=arguments[k];for(p in _)c[p]=_[p];for(let D=0;D<pt.length;D++)p=pt[D],Object.prototype.hasOwnProperty.call(_,p)&&(c[p]=_[p])}}function hn(c){this.src=c,this.g={},this.h=0}hn.prototype.add=function(c,f,p,_,k){const D=c.toString();c=this.g[D],c||(c=this.g[D]=[],this.h++);const G=vt(c,f,_,k);return G>-1?(f=c[G],p||(f.fa=!1)):(f=new de(f,this.src,D,!!_,k),f.fa=p,c.push(f)),f};function fn(c,f){const p=f.type;if(p in c.g){var _=c.g[p],k=Array.prototype.indexOf.call(_,f,void 0),D;(D=k>=0)&&Array.prototype.splice.call(_,k,1),D&&(Te(f),c.g[p].length==0&&(delete c.g[p],c.h--))}}function vt(c,f,p,_){for(let k=0;k<c.length;++k){const D=c[k];if(!D.da&&D.listener==f&&D.capture==!!p&&D.ha==_)return k}return-1}var M="closure_lm_"+(Math.random()*1e6|0),J={};function Y(c,f,p,_,k){if(Array.isArray(f)){for(let D=0;D<f.length;D++)Y(c,f[D],p,_,k);return null}return p=K(p),c&&c[Ge]?c.J(f,p,a(_)?!!_.capture:!1,k):te(c,f,p,!1,_,k)}function te(c,f,p,_,k,D){if(!f)throw Error("Invalid event type");const G=a(k)?!!k.capture:!!k;let pe=U(c);if(pe||(c[M]=pe=new hn(c)),p=pe.add(f,p,_,G,D),p.proxy)return p;if(_=_e(),p.proxy=_,_.src=c,_.listener=p,c.addEventListener)I||(k=G),k===void 0&&(k=!1),c.addEventListener(f.toString(),_,k);else if(c.attachEvent)c.attachEvent(b(f.toString()),_);else if(c.addListener&&c.removeListener)c.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return p}function _e(){function c(p){return f.call(c.src,c.listener,p)}const f=L;return c}function T(c,f,p,_,k){if(Array.isArray(f))for(var D=0;D<f.length;D++)T(c,f[D],p,_,k);else _=a(_)?!!_.capture:!!_,p=K(p),c&&c[Ge]?(c=c.i,D=String(f).toString(),D in c.g&&(f=c.g[D],p=vt(f,p,_,k),p>-1&&(Te(f[p]),Array.prototype.splice.call(f,p,1),f.length==0&&(delete c.g[D],c.h--)))):c&&(c=U(c))&&(f=c.g[f.toString()],c=-1,f&&(c=vt(f,p,_,k)),(p=c>-1?f[c]:null)&&R(p))}function R(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[Ge])fn(f.i,c);else{var p=c.type,_=c.proxy;f.removeEventListener?f.removeEventListener(p,_,c.capture):f.detachEvent?f.detachEvent(b(p),_):f.addListener&&f.removeListener&&f.removeListener(_),(p=U(f))?(fn(p,c),p.h==0&&(p.src=null,f[M]=null)):Te(c)}}}function b(c){return c in J?J[c]:J[c]="on"+c}function L(c,f){if(c.da)c=!0;else{f=new ve(f,this);const p=c.listener,_=c.ha||c.src;c.fa&&R(c),c=p.call(_,f)}return c}function U(c){return c=c[M],c instanceof hn?c:null}var V="__closure_events_fn_"+(Math.random()*1e9>>>0);function K(c){return typeof c=="function"?c:(c[V]||(c[V]=function(f){return c.handleEvent(f)}),c[V])}function W(){A.call(this),this.i=new hn(this),this.M=this,this.G=null}d(W,A),W.prototype[Ge]=!0,W.prototype.removeEventListener=function(c,f,p,_){T(this,c,f,p,_)};function H(c,f){var p,_=c.G;if(_)for(p=[];_;_=_.G)p.push(_);if(c=c.M,_=f.type||f,typeof f=="string")f=new w(f,c);else if(f instanceof w)f.target=f.target||c;else{var k=f;f=new w(_,c),$n(f,k)}k=!0;let D,G;if(p)for(G=p.length-1;G>=0;G--)D=f.g=p[G],k=j(D,_,!0,f)&&k;if(D=f.g=c,k=j(D,_,!0,f)&&k,k=j(D,_,!1,f)&&k,p)for(G=0;G<p.length;G++)D=f.g=p[G],k=j(D,_,!1,f)&&k}W.prototype.N=function(){if(W.Z.N.call(this),this.i){var c=this.i;for(const f in c.g){const p=c.g[f];for(let _=0;_<p.length;_++)Te(p[_]);delete c.g[f],c.h--}}this.G=null},W.prototype.J=function(c,f,p,_){return this.i.add(String(c),f,!1,p,_)},W.prototype.K=function(c,f,p,_){return this.i.add(String(c),f,!0,p,_)};function j(c,f,p,_){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();let k=!0;for(let D=0;D<f.length;++D){const G=f[D];if(G&&!G.da&&G.capture==p){const pe=G.listener,st=G.ha||G.src;G.fa&&fn(c.i,G),k=pe.call(st,_)!==!1&&k}}return k&&!_.defaultPrevented}function re(c,f){if(typeof c!="function")if(c&&typeof c.handleEvent=="function")c=u(c.handleEvent,c);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:o.setTimeout(c,f||0)}function X(c){c.g=re(()=>{c.g=null,c.i&&(c.i=!1,X(c))},c.l);const f=c.h;c.h=null,c.m.apply(null,f)}class se extends A{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:X(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ae(c){A.call(this),this.h=c,this.g={}}d(ae,A);var me=[];function Oe(c){jt(c.g,function(f,p){this.g.hasOwnProperty(p)&&R(f)},c),c.g={}}ae.prototype.N=function(){ae.Z.N.call(this),Oe(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ce=o.JSON.stringify,Tt=o.JSON.parse,It=class{stringify(c){return o.JSON.stringify(c,void 0)}parse(c){return o.JSON.parse(c,void 0)}};function Kt(){}function zt(){}var dn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Wr(){w.call(this,"d")}d(Wr,w);function mt(){w.call(this,"c")}d(mt,w);var at={},qi=null;function ur(){return qi=qi||new W}at.Ia="serverreachability";function sp(c){w.call(this,at.Ia,c)}d(sp,w);function Hi(c){const f=ur();H(f,new sp(f))}at.STAT_EVENT="statevent";function rp(c,f){w.call(this,at.STAT_EVENT,c),this.stat=f}d(rp,w);function xt(c){const f=ur();H(f,new rp(f,c))}at.Ja="timingevent";function ip(c,f){w.call(this,at.Ja,c),this.size=f}d(ip,w);function Wi(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){c()},f)}function $i(){this.g=!0}$i.prototype.ua=function(){this.g=!1};function Pw(c,f,p,_,k,D){c.info(function(){if(c.g)if(D){var G="",pe=D.split("&");for(let Me=0;Me<pe.length;Me++){var st=pe[Me].split("=");if(st.length>1){const ct=st[0];st=st[1];const bn=ct.split("_");G=bn.length>=2&&bn[1]=="type"?G+(ct+"="+st+"&"):G+(ct+"=redacted&")}}}else G=null;else G=D;return"XMLHTTP REQ ("+_+") [attempt "+k+"]: "+f+`
`+p+`
`+G})}function Nw(c,f,p,_,k,D,G){c.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+k+"]: "+f+`
`+p+`
`+D+" "+G})}function $r(c,f,p,_){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+Dw(c,p)+(_?" "+_:"")})}function kw(c,f){c.info(function(){return"TIMEOUT: "+f})}$i.prototype.info=function(){};function Dw(c,f){if(!c.g)return f;if(!f)return null;try{const D=JSON.parse(f);if(D){for(c=0;c<D.length;c++)if(Array.isArray(D[c])){var p=D[c];if(!(p.length<2)){var _=p[1];if(Array.isArray(_)&&!(_.length<1)){var k=_[0];if(k!="noop"&&k!="stop"&&k!="close")for(let G=1;G<_.length;G++)_[G]=""}}}}return Ce(D)}catch{return f}}var Oa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},op={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ap;function hu(){}d(hu,Kt),hu.prototype.g=function(){return new XMLHttpRequest},ap=new hu;function Gi(c){return encodeURIComponent(String(c))}function Ow(c){var f=1;c=c.split(":");const p=[];for(;f>0&&c.length;)p.push(c.shift()),f--;return c.length&&p.push(c.join(":")),p}function ws(c,f,p,_){this.j=c,this.i=f,this.l=p,this.S=_||1,this.V=new ae(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new cp}function cp(){this.i=null,this.g="",this.h=!1}var lp={},fu={};function du(c,f,p){c.M=1,c.A=Va(Sn(f)),c.u=p,c.R=!0,up(c,null)}function up(c,f){c.F=Date.now(),xa(c),c.B=Sn(c.A);var p=c.B,_=c.S;Array.isArray(_)||(_=[String(_)]),wp(p.i,"t",_),c.C=0,p=c.j.L,c.h=new cp,c.g=jp(c.j,p?f:null,!c.u),c.P>0&&(c.O=new se(u(c.Y,c,c.g),c.P)),f=c.V,p=c.g,_=c.ba;var k="readystatechange";Array.isArray(k)||(k&&(me[0]=k.toString()),k=me);for(let D=0;D<k.length;D++){const G=Y(p,k[D],_||f.handleEvent,!1,f.h||f);if(!G)break;f.g[G.key]=G}f=c.J?Gt(c.J):{},c.u?(c.v||(c.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.B,c.v,c.u,f)):(c.v="GET",c.g.ea(c.B,c.v,null,f)),Hi(),Pw(c.i,c.v,c.B,c.l,c.S,c.u)}ws.prototype.ba=function(c){c=c.target;const f=this.O;f&&Cs(c)==3?f.j():this.Y(c)},ws.prototype.Y=function(c){try{if(c==this.g)e:{const pe=Cs(this.g),st=this.g.ya(),Me=this.g.ca();if(!(pe<3)&&(pe!=3||this.g&&(this.h.h||this.g.la()||Np(this.g)))){this.K||pe!=4||st==7||(st==8||Me<=0?Hi(3):Hi(2)),pu(this);var f=this.g.ca();this.X=f;var p=xw(this);if(this.o=f==200,Nw(this.i,this.v,this.B,this.l,this.S,pe,f),this.o){if(this.U&&!this.L){t:{if(this.g){var _,k=this.g;if((_=k.g?k.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(_)){var D=_;break t}}D=null}if(c=D)$r(this.i,this.l,c,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,mu(this,c);else{this.o=!1,this.m=3,xt(12),hr(this),Ki(this);break e}}if(this.R){c=!0;let ct;for(;!this.K&&this.C<p.length;)if(ct=Vw(this,p),ct==fu){pe==4&&(this.m=4,xt(14),c=!1),$r(this.i,this.l,null,"[Incomplete Response]");break}else if(ct==lp){this.m=4,xt(15),$r(this.i,this.l,p,"[Invalid Chunk]"),c=!1;break}else $r(this.i,this.l,ct,null),mu(this,ct);if(hp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),pe!=4||p.length!=0||this.h.h||(this.m=1,xt(16),c=!1),this.o=this.o&&c,!c)$r(this.i,this.l,p,"[Invalid Chunked Response]"),hr(this),Ki(this);else if(p.length>0&&!this.W){this.W=!0;var G=this.j;G.g==this&&G.aa&&!G.P&&(G.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),wu(G),G.P=!0,xt(11))}}else $r(this.i,this.l,p,null),mu(this,p);pe==4&&hr(this),this.o&&!this.K&&(pe==4?Lp(this.j,this):(this.o=!1,xa(this)))}else Qw(this.g),f==400&&p.indexOf("Unknown SID")>0?(this.m=3,xt(12)):(this.m=0,xt(13)),hr(this),Ki(this)}}}catch{}finally{}};function xw(c){if(!hp(c))return c.g.la();const f=Np(c.g);if(f==="")return"";let p="";const _=f.length,k=Cs(c.g)==4;if(!c.h.i){if(typeof TextDecoder>"u")return hr(c),Ki(c),"";c.h.i=new o.TextDecoder}for(let D=0;D<_;D++)c.h.h=!0,p+=c.h.i.decode(f[D],{stream:!(k&&D==_-1)});return f.length=0,c.h.g+=p,c.C=0,c.h.g}function hp(c){return c.g?c.v=="GET"&&c.M!=2&&c.j.Aa:!1}function Vw(c,f){var p=c.C,_=f.indexOf(`
`,p);return _==-1?fu:(p=Number(f.substring(p,_)),isNaN(p)?lp:(_+=1,_+p>f.length?fu:(f=f.slice(_,_+p),c.C=_+p,f)))}ws.prototype.cancel=function(){this.K=!0,hr(this)};function xa(c){c.T=Date.now()+c.H,fp(c,c.H)}function fp(c,f){if(c.D!=null)throw Error("WatchDog timer not null");c.D=Wi(u(c.aa,c),f)}function pu(c){c.D&&(o.clearTimeout(c.D),c.D=null)}ws.prototype.aa=function(){this.D=null;const c=Date.now();c-this.T>=0?(kw(this.i,this.B),this.M!=2&&(Hi(),xt(17)),hr(this),this.m=2,Ki(this)):fp(this,this.T-c)};function Ki(c){c.j.I==0||c.K||Lp(c.j,c)}function hr(c){pu(c);var f=c.O;f&&typeof f.dispose=="function"&&f.dispose(),c.O=null,Oe(c.V),c.g&&(f=c.g,c.g=null,f.abort(),f.dispose())}function mu(c,f){try{var p=c.j;if(p.I!=0&&(p.g==c||gu(p.h,c))){if(!c.L&&gu(p.h,c)&&p.I==3){try{var _=p.Ba.g.parse(f)}catch{_=null}if(Array.isArray(_)&&_.length==3){var k=_;if(k[0]==0){e:if(!p.v){if(p.g)if(p.g.F+3e3<c.F)Ba(p),Fa(p);else break e;Iu(p),xt(18)}}else p.xa=k[1],0<p.xa-p.K&&k[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=Wi(u(p.Va,p),6e3));mp(p.h)<=1&&p.ta&&(p.ta=void 0)}else dr(p,11)}else if((c.L||p.g==c)&&Ba(p),!v(f))for(k=p.Ba.g.parse(f),f=0;f<k.length;f++){let Me=k[f];const ct=Me[0];if(!(ct<=p.K))if(p.K=ct,Me=Me[1],p.I==2)if(Me[0]=="c"){p.M=Me[1],p.ba=Me[2];const bn=Me[3];bn!=null&&(p.ka=bn,p.j.info("VER="+p.ka));const pr=Me[4];pr!=null&&(p.za=pr,p.j.info("SVER="+p.za));const Ss=Me[5];Ss!=null&&typeof Ss=="number"&&Ss>0&&(_=1.5*Ss,p.O=_,p.j.info("backChannelRequestTimeoutMs_="+_)),_=p;const bs=c.g;if(bs){const qa=bs.g?bs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qa){var D=_.h;D.g||qa.indexOf("spdy")==-1&&qa.indexOf("quic")==-1&&qa.indexOf("h2")==-1||(D.j=D.l,D.g=new Set,D.h&&(_u(D,D.h),D.h=null))}if(_.G){const Au=bs.g?bs.g.getResponseHeader("X-HTTP-Session-Id"):null;Au&&(_.wa=Au,Be(_.J,_.G,Au))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-c.F,p.j.info("Handshake RTT: "+p.T+"ms")),_=p;var G=c;if(_.na=Bp(_,_.L?_.ba:null,_.W),G.L){gp(_.h,G);var pe=G,st=_.O;st&&(pe.H=st),pe.D&&(pu(pe),xa(pe)),_.g=G}else Vp(_);p.i.length>0&&Ua(p)}else Me[0]!="stop"&&Me[0]!="close"||dr(p,7);else p.I==3&&(Me[0]=="stop"||Me[0]=="close"?Me[0]=="stop"?dr(p,7):Tu(p):Me[0]!="noop"&&p.l&&p.l.qa(Me),p.A=0)}}Hi(4)}catch{}}var Mw=class{constructor(c,f){this.g=c,this.map=f}};function dp(c){this.l=c||10,o.PerformanceNavigationTiming?(c=o.performance.getEntriesByType("navigation"),c=c.length>0&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function pp(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function mp(c){return c.h?1:c.g?c.g.size:0}function gu(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function _u(c,f){c.g?c.g.add(f):c.h=f}function gp(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}dp.prototype.cancel=function(){if(this.i=_p(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function _p(c){if(c.h!=null)return c.i.concat(c.h.G);if(c.g!=null&&c.g.size!==0){let f=c.i;for(const p of c.g.values())f=f.concat(p.G);return f}return g(c.i)}var yp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Lw(c,f){if(c){c=c.split("&");for(let p=0;p<c.length;p++){const _=c[p].indexOf("=");let k,D=null;_>=0?(k=c[p].substring(0,_),D=c[p].substring(_+1)):k=c[p],f(k,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function As(c){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;c instanceof As?(this.l=c.l,zi(this,c.j),this.o=c.o,this.g=c.g,Qi(this,c.u),this.h=c.h,yu(this,Ap(c.i)),this.m=c.m):c&&(f=String(c).match(yp))?(this.l=!1,zi(this,f[1]||"",!0),this.o=Yi(f[2]||""),this.g=Yi(f[3]||"",!0),Qi(this,f[4]),this.h=Yi(f[5]||"",!0),yu(this,f[6]||"",!0),this.m=Yi(f[7]||"")):(this.l=!1,this.i=new Ji(null,this.l))}As.prototype.toString=function(){const c=[];var f=this.j;f&&c.push(Xi(f,Ep,!0),":");var p=this.g;return(p||f=="file")&&(c.push("//"),(f=this.o)&&c.push(Xi(f,Ep,!0),"@"),c.push(Gi(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&c.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&c.push("/"),c.push(Xi(p,p.charAt(0)=="/"?Bw:Uw,!0))),(p=this.i.toString())&&c.push("?",p),(p=this.m)&&c.push("#",Xi(p,qw)),c.join("")},As.prototype.resolve=function(c){const f=Sn(this);let p=!!c.j;p?zi(f,c.j):p=!!c.o,p?f.o=c.o:p=!!c.g,p?f.g=c.g:p=c.u!=null;var _=c.h;if(p)Qi(f,c.u);else if(p=!!c.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var k=f.h.lastIndexOf("/");k!=-1&&(_=f.h.slice(0,k+1)+_)}if(k=_,k==".."||k==".")_="";else if(k.indexOf("./")!=-1||k.indexOf("/.")!=-1){_=k.lastIndexOf("/",0)==0,k=k.split("/");const D=[];for(let G=0;G<k.length;){const pe=k[G++];pe=="."?_&&G==k.length&&D.push(""):pe==".."?((D.length>1||D.length==1&&D[0]!="")&&D.pop(),_&&G==k.length&&D.push("")):(D.push(pe),_=!0)}_=D.join("/")}else _=k}return p?f.h=_:p=c.i.toString()!=="",p?yu(f,Ap(c.i)):p=!!c.m,p&&(f.m=c.m),f};function Sn(c){return new As(c)}function zi(c,f,p){c.j=p?Yi(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function Qi(c,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);c.u=f}else c.u=null}function yu(c,f,p){f instanceof Ji?(c.i=f,Hw(c.i,c.l)):(p||(f=Xi(f,jw)),c.i=new Ji(f,c.l))}function Be(c,f,p){c.i.set(f,p)}function Va(c){return Be(c,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),c}function Yi(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Xi(c,f,p){return typeof c=="string"?(c=encodeURI(c).replace(f,Fw),p&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Fw(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Ep=/[#\/\?@]/g,Uw=/[#\?:]/g,Bw=/[#\?]/g,jw=/[#\?@]/g,qw=/#/g;function Ji(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function fr(c){c.g||(c.g=new Map,c.h=0,c.i&&Lw(c.i,function(f,p){c.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}t=Ji.prototype,t.add=function(c,f){fr(this),this.i=null,c=Gr(this,c);let p=this.g.get(c);return p||this.g.set(c,p=[]),p.push(f),this.h+=1,this};function vp(c,f){fr(c),f=Gr(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function Tp(c,f){return fr(c),f=Gr(c,f),c.g.has(f)}t.forEach=function(c,f){fr(this),this.g.forEach(function(p,_){p.forEach(function(k){c.call(f,k,_,this)},this)},this)};function Ip(c,f){fr(c);let p=[];if(typeof f=="string")Tp(c,f)&&(p=p.concat(c.g.get(Gr(c,f))));else for(c=Array.from(c.g.values()),f=0;f<c.length;f++)p=p.concat(c[f]);return p}t.set=function(c,f){return fr(this),this.i=null,c=Gr(this,c),Tp(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},t.get=function(c,f){return c?(c=Ip(this,c),c.length>0?String(c[0]):f):f};function wp(c,f,p){vp(c,f),p.length>0&&(c.i=null,c.g.set(Gr(c,f),g(p)),c.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],f=Array.from(this.g.keys());for(let _=0;_<f.length;_++){var p=f[_];const k=Gi(p);p=Ip(this,p);for(let D=0;D<p.length;D++){let G=k;p[D]!==""&&(G+="="+Gi(p[D])),c.push(G)}}return this.i=c.join("&")};function Ap(c){const f=new Ji;return f.i=c.i,c.g&&(f.g=new Map(c.g),f.h=c.h),f}function Gr(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function Hw(c,f){f&&!c.j&&(fr(c),c.i=null,c.g.forEach(function(p,_){const k=_.toLowerCase();_!=k&&(vp(this,_),wp(this,k,p))},c)),c.j=f}function Ww(c,f){const p=new $i;if(o.Image){const _=new Image;_.onload=h(Rs,p,"TestLoadImage: loaded",!0,f,_),_.onerror=h(Rs,p,"TestLoadImage: error",!1,f,_),_.onabort=h(Rs,p,"TestLoadImage: abort",!1,f,_),_.ontimeout=h(Rs,p,"TestLoadImage: timeout",!1,f,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=c}else f(!1)}function $w(c,f){const p=new $i,_=new AbortController,k=setTimeout(()=>{_.abort(),Rs(p,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:_.signal}).then(D=>{clearTimeout(k),D.ok?Rs(p,"TestPingServer: ok",!0,f):Rs(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(k),Rs(p,"TestPingServer: error",!1,f)})}function Rs(c,f,p,_,k){try{k&&(k.onload=null,k.onerror=null,k.onabort=null,k.ontimeout=null),_(p)}catch{}}function Gw(){this.g=new It}function Eu(c){this.i=c.Sb||null,this.h=c.ab||!1}d(Eu,Kt),Eu.prototype.g=function(){return new Ma(this.i,this.h)};function Ma(c,f){W.call(this),this.H=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(Ma,W),t=Ma.prototype,t.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=c,this.D=f,this.readyState=1,eo(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};c&&(f.body=c),(this.H||o).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Zi(this)),this.readyState=0},t.Pa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,eo(this)),this.g&&(this.readyState=3,eo(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Rp(this)}else c.text().then(this.Oa.bind(this),this.ga.bind(this))};function Rp(c){c.j.read().then(c.Ma.bind(c)).catch(c.ga.bind(c))}t.Ma=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?Zi(this):eo(this),this.readyState==3&&Rp(this)}},t.Oa=function(c){this.g&&(this.response=this.responseText=c,Zi(this))},t.Na=function(c){this.g&&(this.response=c,Zi(this))},t.ga=function(){this.g&&Zi(this)};function Zi(c){c.readyState=4,c.l=null,c.j=null,c.B=null,eo(c)}t.setRequestHeader=function(c,f){this.A.append(c,f)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,c.push(p[0]+": "+p[1]),p=f.next();return c.join(`\r
`)};function eo(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Ma.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Cp(c){let f="";return jt(c,function(p,_){f+=_,f+=":",f+=p,f+=`\r
`}),f}function vu(c,f,p){e:{for(_ in p){var _=!1;break e}_=!0}_||(p=Cp(p),typeof c=="string"?p!=null&&Gi(p):Be(c,f,p))}function Ke(c){W.call(this),this.headers=new Map,this.L=c||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(Ke,W);var Kw=/^https?$/i,zw=["POST","PUT"];t=Ke.prototype,t.Fa=function(c){this.H=c},t.ea=function(c,f,p,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ap.g(),this.g.onreadystatechange=m(u(this.Ca,this));try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(D){Sp(this,D);return}if(c=p||"",p=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var k in _)p.set(k,_[k]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const D of _.keys())p.set(D,_.get(D));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(p.keys()).find(D=>D.toLowerCase()=="content-type"),k=o.FormData&&c instanceof o.FormData,!(Array.prototype.indexOf.call(zw,f,void 0)>=0)||_||k||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[D,G]of p)this.g.setRequestHeader(D,G);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(c),this.v=!1}catch(D){Sp(this,D)}};function Sp(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.o=5,bp(c),La(c)}function bp(c){c.A||(c.A=!0,H(c,"complete"),H(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=c||7,H(this,"complete"),H(this,"abort"),La(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),La(this,!0)),Ke.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Pp(this):this.Xa())},t.Xa=function(){Pp(this)};function Pp(c){if(c.h&&typeof i<"u"){if(c.v&&Cs(c)==4)setTimeout(c.Ca.bind(c),0);else if(H(c,"readystatechange"),Cs(c)==4){c.h=!1;try{const D=c.ca();e:switch(D){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var p;if(!(p=f)){var _;if(_=D===0){let G=String(c.D).match(yp)[1]||null;!G&&o.self&&o.self.location&&(G=o.self.location.protocol.slice(0,-1)),_=!Kw.test(G?G.toLowerCase():"")}p=_}if(p)H(c,"complete"),H(c,"success");else{c.o=6;try{var k=Cs(c)>2?c.g.statusText:""}catch{k=""}c.l=k+" ["+c.ca()+"]",bp(c)}}finally{La(c)}}}}function La(c,f){if(c.g){c.m&&(clearTimeout(c.m),c.m=null);const p=c.g;c.g=null,f||H(c,"ready");try{p.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Cs(c){return c.g?c.g.readyState:0}t.ca=function(){try{return Cs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),Tt(f)}};function Np(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.F){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Qw(c){const f={};c=(c.g&&Cs(c)>=2&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<c.length;_++){if(v(c[_]))continue;var p=Ow(c[_]);const k=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const D=f[k]||[];f[k]=D,D.push(p)}Cn(f,function(_){return _.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function to(c,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[c]||f}function kp(c){this.za=0,this.i=[],this.j=new $i,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=to("failFast",!1,c),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=to("baseRetryDelayMs",5e3,c),this.Za=to("retryDelaySeedMs",1e4,c),this.Ta=to("forwardChannelMaxRetries",2,c),this.va=to("forwardChannelRequestTimeoutMs",2e4,c),this.ma=c&&c.xmlHttpFactory||void 0,this.Ua=c&&c.Rb||void 0,this.Aa=c&&c.useFetchStreams||!1,this.O=void 0,this.L=c&&c.supportsCrossDomainXhr||!1,this.M="",this.h=new dp(c&&c.concurrentRequestLimit),this.Ba=new Gw,this.S=c&&c.fastHandshake||!1,this.R=c&&c.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=c&&c.Pb||!1,c&&c.ua&&this.j.ua(),c&&c.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&c&&c.detectBufferingProxy||!1,this.ia=void 0,c&&c.longPollingTimeout&&c.longPollingTimeout>0&&(this.ia=c.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=kp.prototype,t.ka=8,t.I=1,t.connect=function(c,f,p,_){xt(0),this.W=c,this.H=f||{},p&&_!==void 0&&(this.H.OSID=p,this.H.OAID=_),this.F=this.X,this.J=Bp(this,null,this.W),Ua(this)};function Tu(c){if(Dp(c),c.I==3){var f=c.V++,p=Sn(c.J);if(Be(p,"SID",c.M),Be(p,"RID",f),Be(p,"TYPE","terminate"),no(c,p),f=new ws(c,c.j,f),f.M=2,f.A=Va(Sn(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(f.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=f.A,p=!0),p||(f.g=jp(f.j,null),f.g.ea(f.A)),f.F=Date.now(),xa(f)}Up(c)}function Fa(c){c.g&&(wu(c),c.g.cancel(),c.g=null)}function Dp(c){Fa(c),c.v&&(o.clearTimeout(c.v),c.v=null),Ba(c),c.h.cancel(),c.m&&(typeof c.m=="number"&&o.clearTimeout(c.m),c.m=null)}function Ua(c){if(!pp(c.h)&&!c.m){c.m=!0;var f=c.Ea;ee||E(),oe||(ee(),oe=!0),C.add(f,c),c.D=0}}function Yw(c,f){return mp(c.h)>=c.h.j-(c.m?1:0)?!1:c.m?(c.i=f.G.concat(c.i),!0):c.I==1||c.I==2||c.D>=(c.Sa?0:c.Ta)?!1:(c.m=Wi(u(c.Ea,c,f),Fp(c,c.D)),c.D++,!0)}t.Ea=function(c){if(this.m)if(this.m=null,this.I==1){if(!c){this.V=Math.floor(Math.random()*1e5),c=this.V++;const k=new ws(this,this.j,c);let D=this.o;if(this.U&&(D?(D=Gt(D),$n(D,this.U)):D=this.U),this.u!==null||this.R||(k.J=D,D=null),this.S)e:{for(var f=0,p=0;p<this.i.length;p++){t:{var _=this.i[p];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(f+=_,f>4096){f=p;break e}if(f===4096||p===this.i.length-1){f=p+1;break e}}f=1e3}else f=1e3;f=xp(this,k,f),p=Sn(this.J),Be(p,"RID",c),Be(p,"CVER",22),this.G&&Be(p,"X-HTTP-Session-Id",this.G),no(this,p),D&&(this.R?f="headers="+Gi(Cp(D))+"&"+f:this.u&&vu(p,this.u,D)),_u(this.h,k),this.Ra&&Be(p,"TYPE","init"),this.S?(Be(p,"$req",f),Be(p,"SID","null"),k.U=!0,du(k,p,null)):du(k,p,f),this.I=2}}else this.I==3&&(c?Op(this,c):this.i.length==0||pp(this.h)||Op(this))};function Op(c,f){var p;f?p=f.l:p=c.V++;const _=Sn(c.J);Be(_,"SID",c.M),Be(_,"RID",p),Be(_,"AID",c.K),no(c,_),c.u&&c.o&&vu(_,c.u,c.o),p=new ws(c,c.j,p,c.D+1),c.u===null&&(p.J=c.o),f&&(c.i=f.G.concat(c.i)),f=xp(c,p,1e3),p.H=Math.round(c.va*.5)+Math.round(c.va*.5*Math.random()),_u(c.h,p),du(p,_,f)}function no(c,f){c.H&&jt(c.H,function(p,_){Be(f,_,p)}),c.l&&jt({},function(p,_){Be(f,_,p)})}function xp(c,f,p){p=Math.min(c.i.length,p);const _=c.l?u(c.l.Ka,c.l,c):null;e:{var k=c.i;let pe=-1;for(;;){const st=["count="+p];pe==-1?p>0?(pe=k[0].g,st.push("ofs="+pe)):pe=0:st.push("ofs="+pe);let Me=!0;for(let ct=0;ct<p;ct++){var D=k[ct].g;const bn=k[ct].map;if(D-=pe,D<0)pe=Math.max(0,k[ct].g-100),Me=!1;else try{D="req"+D+"_"||"";try{var G=bn instanceof Map?bn:Object.entries(bn);for(const[pr,Ss]of G){let bs=Ss;a(Ss)&&(bs=Ce(Ss)),st.push(D+pr+"="+encodeURIComponent(bs))}}catch(pr){throw st.push(D+"type="+encodeURIComponent("_badmap")),pr}}catch{_&&_(bn)}}if(Me){G=st.join("&");break e}}G=void 0}return c=c.i.splice(0,p),f.G=c,G}function Vp(c){if(!c.g&&!c.v){c.Y=1;var f=c.Da;ee||E(),oe||(ee(),oe=!0),C.add(f,c),c.A=0}}function Iu(c){return c.g||c.v||c.A>=3?!1:(c.Y++,c.v=Wi(u(c.Da,c),Fp(c,c.A)),c.A++,!0)}t.Da=function(){if(this.v=null,Mp(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var c=4*this.T;this.j.info("BP detection timer enabled: "+c),this.B=Wi(u(this.Wa,this),c)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,xt(10),Fa(this),Mp(this))};function wu(c){c.B!=null&&(o.clearTimeout(c.B),c.B=null)}function Mp(c){c.g=new ws(c,c.j,"rpc",c.Y),c.u===null&&(c.g.J=c.o),c.g.P=0;var f=Sn(c.na);Be(f,"RID","rpc"),Be(f,"SID",c.M),Be(f,"AID",c.K),Be(f,"CI",c.F?"0":"1"),!c.F&&c.ia&&Be(f,"TO",c.ia),Be(f,"TYPE","xmlhttp"),no(c,f),c.u&&c.o&&vu(f,c.u,c.o),c.O&&(c.g.H=c.O);var p=c.g;c=c.ba,p.M=1,p.A=Va(Sn(f)),p.u=null,p.R=!0,up(p,c)}t.Va=function(){this.C!=null&&(this.C=null,Fa(this),Iu(this),xt(19))};function Ba(c){c.C!=null&&(o.clearTimeout(c.C),c.C=null)}function Lp(c,f){var p=null;if(c.g==f){Ba(c),wu(c),c.g=null;var _=2}else if(gu(c.h,f))p=f.G,gp(c.h,f),_=1;else return;if(c.I!=0){if(f.o)if(_==1){p=f.u?f.u.length:0,f=Date.now()-f.F;var k=c.D;_=ur(),H(_,new ip(_,p)),Ua(c)}else Vp(c);else if(k=f.m,k==3||k==0&&f.X>0||!(_==1&&Yw(c,f)||_==2&&Iu(c)))switch(p&&p.length>0&&(f=c.h,f.i=f.i.concat(p)),k){case 1:dr(c,5);break;case 4:dr(c,10);break;case 3:dr(c,6);break;default:dr(c,2)}}}function Fp(c,f){let p=c.Qa+Math.floor(Math.random()*c.Za);return c.isActive()||(p*=2),p*f}function dr(c,f){if(c.j.info("Error code "+f),f==2){var p=u(c.bb,c),_=c.Ua;const k=!_;_=new As(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||zi(_,"https"),Va(_),k?Ww(_.toString(),p):$w(_.toString(),p)}else xt(2);c.I=0,c.l&&c.l.pa(f),Up(c),Dp(c)}t.bb=function(c){c?(this.j.info("Successfully pinged google.com"),xt(2)):(this.j.info("Failed to ping google.com"),xt(1))};function Up(c){if(c.I=0,c.ja=[],c.l){const f=_p(c.h);(f.length!=0||c.i.length!=0)&&(S(c.ja,f),S(c.ja,c.i),c.h.i.length=0,g(c.i),c.i.length=0),c.l.oa()}}function Bp(c,f,p){var _=p instanceof As?Sn(p):new As(p);if(_.g!="")f&&(_.g=f+"."+_.g),Qi(_,_.u);else{var k=o.location;_=k.protocol,f=f?f+"."+k.hostname:k.hostname,k=+k.port;const D=new As(null);_&&zi(D,_),f&&(D.g=f),k&&Qi(D,k),p&&(D.h=p),_=D}return p=c.G,f=c.wa,p&&f&&Be(_,p,f),Be(_,"VER",c.ka),no(c,_),_}function jp(c,f,p){if(f&&!c.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Aa&&!c.ma?new Ke(new Eu({ab:p})):new Ke(c.ma),f.Fa(c.L),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function qp(){}t=qp.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ja(){}ja.prototype.g=function(c,f){return new Qt(c,f)};function Qt(c,f){W.call(this),this.g=new kp(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(c?c["X-WebChannel-Client-Profile"]=f.sa:c={"X-WebChannel-Client-Profile":f.sa}),this.g.U=c,(c=f&&f.Qb)&&!v(c)&&(this.g.u=c),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!v(f)&&(this.g.G=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new Kr(this)}d(Qt,W),Qt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qt.prototype.close=function(){Tu(this.g)},Qt.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var p={};p.__data__=c,c=p}else this.v&&(p={},p.__data__=Ce(c),c=p);f.i.push(new Mw(f.Ya++,c)),f.I==3&&Ua(f)},Qt.prototype.N=function(){this.g.l=null,delete this.j,Tu(this.g),delete this.g,Qt.Z.N.call(this)};function Hp(c){Wr.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(const p in f){c=p;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}d(Hp,Wr);function Wp(){mt.call(this),this.status=1}d(Wp,mt);function Kr(c){this.g=c}d(Kr,qp),Kr.prototype.ra=function(){H(this.g,"a")},Kr.prototype.qa=function(c){H(this.g,new Hp(c))},Kr.prototype.pa=function(c){H(this.g,new Wp)},Kr.prototype.oa=function(){H(this.g,"b")},ja.prototype.createWebChannel=ja.prototype.g,Qt.prototype.send=Qt.prototype.o,Qt.prototype.open=Qt.prototype.m,Qt.prototype.close=Qt.prototype.close,XE=function(){return new ja},YE=function(){return ur()},QE=at,bh={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Oa.NO_ERROR=0,Oa.TIMEOUT=8,Oa.HTTP_ERROR=6,cc=Oa,op.COMPLETE="complete",zE=op,zt.EventType=dn,dn.OPEN="a",dn.CLOSE="b",dn.ERROR="c",dn.MESSAGE="d",W.prototype.listen=W.prototype.J,go=zt,Ke.prototype.listenOnce=Ke.prototype.K,Ke.prototype.getLastError=Ke.prototype.Ha,Ke.prototype.getLastErrorCode=Ke.prototype.ya,Ke.prototype.getStatus=Ke.prototype.ca,Ke.prototype.getResponseJson=Ke.prototype.La,Ke.prototype.getResponseText=Ke.prototype.la,Ke.prototype.send=Ke.prototype.ea,Ke.prototype.setWithCredentials=Ke.prototype.Fa,KE=Ke}).apply(typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{});const $m="@firebase/firestore",Gm="4.9.2";class Rt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Rt.UNAUTHENTICATED=new Rt(null),Rt.GOOGLE_CREDENTIALS=new Rt("google-credentials-uid"),Rt.FIRST_PARTY=new Rt("first-party-uid"),Rt.MOCK_USER=new Rt("mock-user");let Di="12.3.0";const Dr=new kl("@firebase/firestore");function Jr(){return Dr.logLevel}function Z(t,...e){if(Dr.logLevel<=ge.DEBUG){const n=e.map(Lf);Dr.debug(`Firestore (${Di}): ${t}`,...n)}}function ms(t,...e){if(Dr.logLevel<=ge.ERROR){const n=e.map(Lf);Dr.error(`Firestore (${Di}): ${t}`,...n)}}function Ei(t,...e){if(Dr.logLevel<=ge.WARN){const n=e.map(Lf);Dr.warn(`Firestore (${Di}): ${t}`,...n)}}function Lf(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function le(t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,JE(t,s,n)}function JE(t,e,n){let s=`FIRESTORE (${Di}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{s+=" CONTEXT: "+JSON.stringify(n)}catch{s+=" CONTEXT: "+n}throw ms(s),new Error(s)}function ke(t,e,n,s){let r="Unexpected state";typeof n=="string"?r=n:s=n,t||JE(e,r,s)}function fe(t,e){return t}const x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends Hn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class os{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class ZE{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ab{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Rt.UNAUTHENTICATED)))}shutdown(){}}class Rb{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class Cb{constructor(e){this.t=e,this.currentUser=Rt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ke(this.o===void 0,42304);let s=this.i;const r=l=>this.i!==s?(s=this.i,n(l)):Promise.resolve();let i=new os;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new os,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await r(this.currentUser)}))},a=l=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((l=>a(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new os)}}),0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((s=>this.i!==e?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(ke(typeof s.accessToken=="string",31837,{l:s}),new ZE(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ke(e===null||typeof e=="string",2055,{h:e}),new Rt(e)}}class Sb{constructor(e,n,s){this.P=e,this.T=n,this.I=s,this.type="FirstParty",this.user=Rt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class bb{constructor(e,n,s){this.P=e,this.T=n,this.I=s}getToken(){return Promise.resolve(new Sb(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Rt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Km{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Pb{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ft(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ke(this.o===void 0,3512);const s=i=>{i.error!=null&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>s(i)))};const r=i=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>r(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Km(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(ke(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Km(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Nb(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}class Ff{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=Nb(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%62))}return s}}function ye(t,e){return t<e?-1:t>e?1:0}function Ph(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const r=t.charAt(s),i=e.charAt(s);if(r!==i)return Hu(r)===Hu(i)?ye(r,i):Hu(r)?1:-1}return ye(t.length,e.length)}const kb=55296,Db=57343;function Hu(t){const e=t.charCodeAt(0);return e>=kb&&e<=Db}function vi(t,e,n){return t.length===e.length&&t.every(((s,r)=>n(s,e[r])))}const zm="__name__";class kn{constructor(e,n,s){n===void 0?n=0:n>e.length&&le(637,{offset:n,range:e.length}),s===void 0?s=e.length-n:s>e.length-n&&le(1746,{length:s,range:e.length-n}),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return kn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof kn?e.forEach((s=>{n.push(s)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=kn.compareSegments(e.get(r),n.get(r));if(i!==0)return i}return ye(e.length,n.length)}static compareSegments(e,n){const s=kn.isNumericId(e),r=kn.isNumericId(n);return s&&!r?-1:!s&&r?1:s&&r?kn.extractNumericId(e).compare(kn.extractNumericId(n)):Ph(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return $s.fromString(e.substring(4,e.length-2))}}class Ue extends kn{construct(e,n,s){return new Ue(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new Q(x.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter((r=>r.length>0)))}return new Ue(n)}static emptyPath(){return new Ue([])}}const Ob=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _t extends kn{construct(e,n,s){return new _t(e,n,s)}static isValidIdentifier(e){return Ob.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_t.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===zm}static keyField(){return new _t([zm])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new Q(x.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new Q(x.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Q(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=l,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new Q(x.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _t(n)}static emptyPath(){return new _t([])}}class ne{constructor(e){this.path=e}static fromPath(e){return new ne(Ue.fromString(e))}static fromName(e){return new ne(Ue.fromString(e).popFirst(5))}static empty(){return new ne(Ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ue.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ne(new Ue(e.slice()))}}function ev(t,e,n){if(!n)throw new Q(x.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function xb(t,e,n,s){if(e===!0&&s===!0)throw new Q(x.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Qm(t){if(!ne.isDocumentKey(t))throw new Q(x.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ym(t){if(ne.isDocumentKey(t))throw new Q(x.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function tv(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Ol(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":le(12329,{type:typeof t})}function Ut(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Q(x.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ol(t);throw new Q(x.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function tt(t,e){const n={typeString:t};return e&&(n.value=e),n}function pa(t,e){if(!tv(t))throw new Q(x.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in t)){n=`JSON missing required field: '${s}'`;break}const o=t[s];if(r&&typeof o!==r){n=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${s}' field to equal '${i.value}'`;break}}if(n)throw new Q(x.INVALID_ARGUMENT,n);return!0}const Xm=-62135596800,Jm=1e6;class He{static now(){return He.fromMillis(Date.now())}static fromDate(e){return He.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*Jm);return new He(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Q(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Q(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Xm)throw new Q(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Jm}_compareTo(e){return this.seconds===e.seconds?ye(this.nanoseconds,e.nanoseconds):ye(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:He._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(pa(e,He._jsonSchema))return new He(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Xm;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}He._jsonSchemaVersion="firestore/timestamp/1.0",He._jsonSchema={type:tt("string",He._jsonSchemaVersion),seconds:tt("number"),nanoseconds:tt("number")};class ue{static fromTimestamp(e){return new ue(e)}static min(){return new ue(new He(0,0))}static max(){return new ue(new He(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Yo=-1;function Vb(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=ue.fromTimestamp(s===1e9?new He(n+1,0):new He(n,s));return new Xs(r,ne.empty(),e)}function Mb(t){return new Xs(t.readTime,t.key,Yo)}class Xs{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new Xs(ue.min(),ne.empty(),Yo)}static max(){return new Xs(ue.max(),ne.empty(),Yo)}}function Lb(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ne.comparator(t.documentKey,e.documentKey),n!==0?n:ye(t.largestBatchId,e.largestBatchId))}const Fb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ub{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Oi(t){if(t.code!==x.FAILED_PRECONDITION||t.message!==Fb)throw t;Z("LocalStore","Unexpectedly lost primary lease")}class F{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&le(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new F(((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof F?n:F.resolve(n)}catch(n){return F.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):F.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):F.reject(n)}static resolve(e){return new F(((n,s)=>{n(e)}))}static reject(e){return new F(((n,s)=>{s(e)}))}static waitFor(e){return new F(((n,s)=>{let r=0,i=0,o=!1;e.forEach((a=>{++r,a.next((()=>{++i,o&&i===r&&n()}),(l=>s(l)))})),o=!0,i===r&&n()}))}static or(e){let n=F.resolve(!1);for(const s of e)n=n.next((r=>r?F.resolve(r):s()));return n}static forEach(e,n){const s=[];return e.forEach(((r,i)=>{s.push(n.call(this,r,i))})),this.waitFor(s)}static mapArray(e,n){return new F(((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const u=l;n(e[u]).next((h=>{o[u]=h,++a,a===i&&s(o)}),(h=>r(h)))}}))}static doWhile(e,n){return new F(((s,r)=>{const i=()=>{e()===!0?n().next((()=>{i()}),r):s()};i()}))}}function Bb(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function xi(t){return t.name==="IndexedDbTransactionError"}class xl{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>n.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}xl.ce=-1;const Uf=-1;function Vl(t){return t==null}function Vc(t){return t===0&&1/t==-1/0}function jb(t){return typeof t=="number"&&Number.isInteger(t)&&!Vc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const nv="";function qb(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Zm(e)),e=Hb(t.get(n),e);return Zm(e)}function Hb(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case nv:n+="";break;default:n+=i}}return n}function Zm(t){return t+nv+""}function eg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ir(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function sv(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}let nt=class Nh{constructor(e,n){this.comparator=e,this.root=n||Gs.EMPTY}insert(e,n){return new Nh(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Gs.BLACK,null,null))}remove(e){return new Nh(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gs.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,s)=>(e(n,s),!1)))}toString(){const e=[];return this.inorderTraversal(((n,s)=>(e.push(`${n}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new za(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new za(this.root,e,this.comparator,!1)}getReverseIterator(){return new za(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new za(this.root,e,this.comparator,!0)}},za=class{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Gs=class Qn{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??Qn.RED,this.left=r??Qn.EMPTY,this.right=i??Qn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new Qn(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Qn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return Qn.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw le(43730,{key:this.key,value:this.value});if(this.right.isRed())throw le(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw le(27949);return e+(this.isRed()?0:1)}};Gs.EMPTY=null,Gs.RED=!0,Gs.BLACK=!1;Gs.EMPTY=new class{constructor(){this.size=0}get key(){throw le(57766)}get value(){throw le(16141)}get color(){throw le(16727)}get left(){throw le(29726)}get right(){throw le(36894)}copy(e,n,s,r,i){return this}insert(e,n,s){return new Gs(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ot{constructor(e){this.comparator=e,this.data=new nt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,s)=>(e(n),!1)))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new tg(this.data.getIterator())}getIteratorFrom(e){return new tg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((s=>{n=n.add(s)})),n}isEqual(e){if(!(e instanceof ot)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new ot(this.comparator);return n.data=e,n}}class tg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Zt{constructor(e){this.fields=e,e.sort(_t.comparator)}static empty(){return new Zt([])}unionWith(e){let n=new ot(_t.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new Zt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return vi(this.fields,e.fields,((n,s)=>n.isEqual(s)))}}class rv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Et{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new rv("Invalid base64 string: "+i):i}})(e);return new Et(n)}static fromUint8Array(e){const n=(function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i})(e);return new Et(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ye(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Et.EMPTY_BYTE_STRING=new Et("");const Wb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Js(t){if(ke(!!t,39018),typeof t=="string"){let e=0;const n=Wb.exec(t);if(ke(!!n,46558,{timestamp:t}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Xe(t.seconds),nanos:Xe(t.nanos)}}function Xe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Zs(t){return typeof t=="string"?Et.fromBase64String(t):Et.fromUint8Array(t)}const iv="server_timestamp",ov="__type__",av="__previous_value__",cv="__local_write_time__";function Bf(t){return(t?.mapValue?.fields||{})[ov]?.stringValue===iv}function Ml(t){const e=t.mapValue.fields[av];return Bf(e)?Ml(e):e}function Xo(t){const e=Js(t.mapValue.fields[cv].timestampValue);return new He(e.seconds,e.nanos)}class $b{constructor(e,n,s,r,i,o,a,l,u,h){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u,this.isUsingEmulator=h}}const Mc="(default)";class Jo{constructor(e,n){this.projectId=e,this.database=n||Mc}static empty(){return new Jo("","")}get isDefaultDatabase(){return this.database===Mc}isEqual(e){return e instanceof Jo&&e.projectId===this.projectId&&e.database===this.database}}const lv="__type__",Gb="__max__",Qa={mapValue:{}},uv="__vector__",Lc="value";function er(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Bf(t)?4:zb(t)?9007199254740991:Kb(t)?10:11:le(28295,{value:t})}function Bn(t,e){if(t===e)return!0;const n=er(t);if(n!==er(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xo(t).isEqual(Xo(e));case 3:return(function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=Js(r.timestampValue),a=Js(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(r,i){return Zs(r.bytesValue).isEqual(Zs(i.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(r,i){return Xe(r.geoPointValue.latitude)===Xe(i.geoPointValue.latitude)&&Xe(r.geoPointValue.longitude)===Xe(i.geoPointValue.longitude)})(t,e);case 2:return(function(r,i){if("integerValue"in r&&"integerValue"in i)return Xe(r.integerValue)===Xe(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=Xe(r.doubleValue),a=Xe(i.doubleValue);return o===a?Vc(o)===Vc(a):isNaN(o)&&isNaN(a)}return!1})(t,e);case 9:return vi(t.arrayValue.values||[],e.arrayValue.values||[],Bn);case 10:case 11:return(function(r,i){const o=r.mapValue.fields||{},a=i.mapValue.fields||{};if(eg(o)!==eg(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Bn(o[l],a[l])))return!1;return!0})(t,e);default:return le(52216,{left:t})}}function Zo(t,e){return(t.values||[]).find((n=>Bn(n,e)))!==void 0}function Ti(t,e){if(t===e)return 0;const n=er(t),s=er(e);if(n!==s)return ye(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return ye(t.booleanValue,e.booleanValue);case 2:return(function(i,o){const a=Xe(i.integerValue||i.doubleValue),l=Xe(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1})(t,e);case 3:return ng(t.timestampValue,e.timestampValue);case 4:return ng(Xo(t),Xo(e));case 5:return Ph(t.stringValue,e.stringValue);case 6:return(function(i,o){const a=Zs(i),l=Zs(o);return a.compareTo(l)})(t.bytesValue,e.bytesValue);case 7:return(function(i,o){const a=i.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const h=ye(a[u],l[u]);if(h!==0)return h}return ye(a.length,l.length)})(t.referenceValue,e.referenceValue);case 8:return(function(i,o){const a=ye(Xe(i.latitude),Xe(o.latitude));return a!==0?a:ye(Xe(i.longitude),Xe(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return sg(t.arrayValue,e.arrayValue);case 10:return(function(i,o){const a=i.fields||{},l=o.fields||{},u=a[Lc]?.arrayValue,h=l[Lc]?.arrayValue,d=ye(u?.values?.length||0,h?.values?.length||0);return d!==0?d:sg(u,h)})(t.mapValue,e.mapValue);case 11:return(function(i,o){if(i===Qa.mapValue&&o===Qa.mapValue)return 0;if(i===Qa.mapValue)return 1;if(o===Qa.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),u=o.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const m=Ph(l[d],h[d]);if(m!==0)return m;const g=Ti(a[l[d]],u[h[d]]);if(g!==0)return g}return ye(l.length,h.length)})(t.mapValue,e.mapValue);default:throw le(23264,{he:n})}}function ng(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ye(t,e);const n=Js(t),s=Js(e),r=ye(n.seconds,s.seconds);return r!==0?r:ye(n.nanos,s.nanos)}function sg(t,e){const n=t.values||[],s=e.values||[];for(let r=0;r<n.length&&r<s.length;++r){const i=Ti(n[r],s[r]);if(i)return i}return ye(n.length,s.length)}function Ii(t){return kh(t)}function kh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const s=Js(n);return`time(${s.seconds},${s.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Zs(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return ne.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let s="[",r=!0;for(const i of n.values||[])r?r=!1:s+=",",s+=kh(i);return s+"]"})(t.arrayValue):"mapValue"in t?(function(n){const s=Object.keys(n.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${kh(n.fields[o])}`;return r+"}"})(t.mapValue):le(61005,{value:t})}function lc(t){switch(er(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ml(t);return e?16+lc(e):16;case 5:return 2*t.stringValue.length;case 6:return Zs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((r,i)=>r+lc(i)),0)})(t.arrayValue);case 10:case 11:return(function(s){let r=0;return ir(s.fields,((i,o)=>{r+=i.length+lc(o)})),r})(t.mapValue);default:throw le(13486,{value:t})}}function rg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Dh(t){return!!t&&"integerValue"in t}function jf(t){return!!t&&"arrayValue"in t}function ig(t){return!!t&&"nullValue"in t}function og(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function uc(t){return!!t&&"mapValue"in t}function Kb(t){return(t?.mapValue?.fields||{})[lv]?.stringValue===uv}function No(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ir(t.mapValue.fields,((n,s)=>e.mapValue.fields[n]=No(s))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=No(t.arrayValue.values[n]);return e}return{...t}}function zb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Gb}class Ht{constructor(e){this.value=e}static empty(){return new Ht({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!uc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=No(n)}setAll(e){let n=_t.emptyPath(),s={},r=[];e.forEach(((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,s,r),s={},r=[],n=a.popLast()}o?s[a.lastSegment()]=No(o):r.push(a.lastSegment())}));const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());uc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Bn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];uc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){ir(n,((r,i)=>e[r]=i));for(const r of s)delete e[r]}clone(){return new Ht(No(this.value))}}function hv(t){const e=[];return ir(t.fields,((n,s)=>{const r=new _t([n]);if(uc(s)){const i=hv(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)})),new Zt(e)}class St{constructor(e,n,s,r,i,o,a){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new St(e,0,ue.min(),ue.min(),ue.min(),Ht.empty(),0)}static newFoundDocument(e,n,s,r){return new St(e,1,n,ue.min(),s,r,0)}static newNoDocument(e,n){return new St(e,2,n,ue.min(),ue.min(),Ht.empty(),0)}static newUnknownDocument(e,n){return new St(e,3,n,ue.min(),ue.min(),Ht.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ht.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ht.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof St&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new St(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Fc{constructor(e,n){this.position=e,this.inclusive=n}}function ag(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=ne.comparator(ne.fromName(o.referenceValue),n.key):s=Ti(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function cg(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Bn(t.position[n],e.position[n]))return!1;return!0}class ea{constructor(e,n="asc"){this.field=e,this.dir=n}}function Qb(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class fv{}class et extends fv{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new Xb(e,n,s):n==="array-contains"?new eP(e,s):n==="in"?new tP(e,s):n==="not-in"?new nP(e,s):n==="array-contains-any"?new sP(e,s):new et(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new Jb(e,s):new Zb(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ti(n,this.value)):n!==null&&er(this.value)===er(n)&&this.matchesComparison(Ti(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return le(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class An extends fv{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new An(e,n)}matches(e){return dv(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function dv(t){return t.op==="and"}function pv(t){return Yb(t)&&dv(t)}function Yb(t){for(const e of t.filters)if(e instanceof An)return!1;return!0}function Oh(t){if(t instanceof et)return t.field.canonicalString()+t.op.toString()+Ii(t.value);if(pv(t))return t.filters.map((e=>Oh(e))).join(",");{const e=t.filters.map((n=>Oh(n))).join(",");return`${t.op}(${e})`}}function mv(t,e){return t instanceof et?(function(s,r){return r instanceof et&&s.op===r.op&&s.field.isEqual(r.field)&&Bn(s.value,r.value)})(t,e):t instanceof An?(function(s,r){return r instanceof An&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce(((i,o,a)=>i&&mv(o,r.filters[a])),!0):!1})(t,e):void le(19439)}function gv(t){return t instanceof et?(function(n){return`${n.field.canonicalString()} ${n.op} ${Ii(n.value)}`})(t):t instanceof An?(function(n){return n.op.toString()+" {"+n.getFilters().map(gv).join(" ,")+"}"})(t):"Filter"}class Xb extends et{constructor(e,n,s){super(e,n,s),this.key=ne.fromName(s.referenceValue)}matches(e){const n=ne.comparator(e.key,this.key);return this.matchesComparison(n)}}class Jb extends et{constructor(e,n){super(e,"in",n),this.keys=_v("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class Zb extends et{constructor(e,n){super(e,"not-in",n),this.keys=_v("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function _v(t,e){return(e.arrayValue?.values||[]).map((n=>ne.fromName(n.referenceValue)))}class eP extends et{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return jf(n)&&Zo(n.arrayValue,this.value)}}class tP extends et{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Zo(this.value.arrayValue,n)}}class nP extends et{constructor(e,n){super(e,"not-in",n)}matches(e){if(Zo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Zo(this.value.arrayValue,n)}}class sP extends et{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!jf(n)||!n.arrayValue.values)&&n.arrayValue.values.some((s=>Zo(this.value.arrayValue,s)))}}class rP{constructor(e,n=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function lg(t,e=null,n=[],s=[],r=null,i=null,o=null){return new rP(t,e,n,s,r,i,o)}function qf(t){const e=fe(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((s=>Oh(s))).join(","),n+="|ob:",n+=e.orderBy.map((s=>(function(i){return i.field.canonicalString()+i.dir})(s))).join(","),Vl(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((s=>Ii(s))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((s=>Ii(s))).join(",")),e.Te=n}return e.Te}function Hf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Qb(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!mv(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!cg(t.startAt,e.startAt)&&cg(t.endAt,e.endAt)}function xh(t){return ne.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Vi{constructor(e,n=null,s=[],r=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function iP(t,e,n,s,r,i,o,a){return new Vi(t,e,n,s,r,i,o,a)}function Ll(t){return new Vi(t)}function ug(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function yv(t){return t.collectionGroup!==null}function ko(t){const e=fe(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new ot(_t.comparator);return o.filters.forEach((l=>{l.getFlattenedFilters().forEach((u=>{u.isInequality()&&(a=a.add(u.field))}))})),a})(e).forEach((i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new ea(i,s))})),n.has(_t.keyField().canonicalString())||e.Ie.push(new ea(_t.keyField(),s))}return e.Ie}function Vn(t){const e=fe(t);return e.Ee||(e.Ee=oP(e,ko(t))),e.Ee}function oP(t,e){if(t.limitType==="F")return lg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((r=>{const i=r.dir==="desc"?"asc":"desc";return new ea(r.field,i)}));const n=t.endAt?new Fc(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new Fc(t.startAt.position,t.startAt.inclusive):null;return lg(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function Vh(t,e){const n=t.filters.concat([e]);return new Vi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Uc(t,e,n){return new Vi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Fl(t,e){return Hf(Vn(t),Vn(e))&&t.limitType===e.limitType}function Ev(t){return`${qf(Vn(t))}|lt:${t.limitType}`}function Zr(t){return`Query(target=${(function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map((r=>gv(r))).join(", ")}]`),Vl(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map((r=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(r))).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map((r=>Ii(r))).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map((r=>Ii(r))).join(",")),`Target(${s})`})(Vn(t))}; limitType=${t.limitType})`}function Ul(t,e){return e.isFoundDocument()&&(function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):ne.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)})(t,e)&&(function(s,r){for(const i of ko(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0})(t,e)&&(function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0})(t,e)&&(function(s,r){return!(s.startAt&&!(function(o,a,l){const u=ag(o,a,l);return o.inclusive?u<=0:u<0})(s.startAt,ko(s),r)||s.endAt&&!(function(o,a,l){const u=ag(o,a,l);return o.inclusive?u>=0:u>0})(s.endAt,ko(s),r))})(t,e)}function aP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function vv(t){return(e,n)=>{let s=!1;for(const r of ko(t)){const i=cP(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function cP(t,e,n){const s=t.field.isKeyField()?ne.comparator(e.key,n.key):(function(i,o,a){const l=o.data.field(i),u=a.data.field(i);return l!==null&&u!==null?Ti(l,u):le(42886)})(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return le(19790,{direction:t.dir})}}class Br{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ir(this.inner,((n,s)=>{for(const[r,i]of s)e(r,i)}))}isEmpty(){return sv(this.inner)}size(){return this.innerSize}}const lP=new nt(ne.comparator);function gs(){return lP}const Tv=new nt(ne.comparator);function _o(...t){let e=Tv;for(const n of t)e=e.insert(n.key,n);return e}function Iv(t){let e=Tv;return t.forEach(((n,s)=>e=e.insert(n,s.overlayedDocument))),e}function Ar(){return Do()}function wv(){return Do()}function Do(){return new Br((t=>t.toString()),((t,e)=>t.isEqual(e)))}const uP=new nt(ne.comparator),hP=new ot(ne.comparator);function Ee(...t){let e=hP;for(const n of t)e=e.add(n);return e}const fP=new ot(ye);function dP(){return fP}function Wf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vc(e)?"-0":e}}function Av(t){return{integerValue:""+t}}function pP(t,e){return jb(e)?Av(e):Wf(t,e)}class Bl{constructor(){this._=void 0}}function mP(t,e,n){return t instanceof ta?(function(r,i){const o={fields:{[ov]:{stringValue:iv},[cv]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Bf(i)&&(i=Ml(i)),i&&(o.fields[av]=i),{mapValue:o}})(n,e):t instanceof wi?Cv(t,e):t instanceof na?Sv(t,e):(function(r,i){const o=Rv(r,i),a=hg(o)+hg(r.Ae);return Dh(o)&&Dh(r.Ae)?Av(a):Wf(r.serializer,a)})(t,e)}function gP(t,e,n){return t instanceof wi?Cv(t,e):t instanceof na?Sv(t,e):n}function Rv(t,e){return t instanceof Bc?(function(s){return Dh(s)||(function(i){return!!i&&"doubleValue"in i})(s)})(e)?e:{integerValue:0}:null}class ta extends Bl{}class wi extends Bl{constructor(e){super(),this.elements=e}}function Cv(t,e){const n=bv(e);for(const s of t.elements)n.some((r=>Bn(r,s)))||n.push(s);return{arrayValue:{values:n}}}class na extends Bl{constructor(e){super(),this.elements=e}}function Sv(t,e){let n=bv(e);for(const s of t.elements)n=n.filter((r=>!Bn(r,s)));return{arrayValue:{values:n}}}class Bc extends Bl{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function hg(t){return Xe(t.integerValue||t.doubleValue)}function bv(t){return jf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Pv{constructor(e,n){this.field=e,this.transform=n}}function _P(t,e){return t.field.isEqual(e.field)&&(function(s,r){return s instanceof wi&&r instanceof wi||s instanceof na&&r instanceof na?vi(s.elements,r.elements,Bn):s instanceof Bc&&r instanceof Bc?Bn(s.Ae,r.Ae):s instanceof ta&&r instanceof ta})(t.transform,e.transform)}class yP{constructor(e,n){this.version=e,this.transformResults=n}}class Bt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Bt}static exists(e){return new Bt(void 0,e)}static updateTime(e){return new Bt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class jl{}function Nv(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ql(t.key,Bt.none()):new ma(t.key,t.data,Bt.none());{const n=t.data,s=Ht.empty();let r=new ot(_t.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new or(t.key,s,new Zt(r.toArray()),Bt.none())}}function EP(t,e,n){t instanceof ma?(function(r,i,o){const a=r.value.clone(),l=dg(r.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(t,e,n):t instanceof or?(function(r,i,o){if(!hc(r.precondition,i))return void i.convertToUnknownDocument(o.version);const a=dg(r.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(kv(r)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(t,e,n):(function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,n)}function Oo(t,e,n,s){return t instanceof ma?(function(i,o,a,l){if(!hc(i.precondition,o))return a;const u=i.value.clone(),h=pg(i.fieldTransforms,l,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null})(t,e,n,s):t instanceof or?(function(i,o,a,l){if(!hc(i.precondition,o))return a;const u=pg(i.fieldTransforms,l,o),h=o.data;return h.setAll(kv(i)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((d=>d.field)))})(t,e,n,s):(function(i,o,a){return hc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(t,e,n)}function vP(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=Rv(s.transform,r||null);i!=null&&(n===null&&(n=Ht.empty()),n.set(s.field,i))}return n||null}function fg(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&vi(s,r,((i,o)=>_P(i,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ma extends jl{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class or extends jl{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function kv(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}})),e}function dg(t,e,n){const s=new Map;ke(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,gP(o,a,n[r]))}return s}function pg(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,mP(i,o,e))}return s}class ql extends jl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class TP extends jl{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class IP{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&EP(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=Oo(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=Oo(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=wv();return this.mutations.forEach((r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(r.key)?null:a;const l=Nv(o,a);l!==null&&s.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(ue.min())})),s}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Ee())}isEqual(e){return this.batchId===e.batchId&&vi(this.mutations,e.mutations,((n,s)=>fg(n,s)))&&vi(this.baseMutations,e.baseMutations,((n,s)=>fg(n,s)))}}class $f{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){ke(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=(function(){return uP})();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new $f(e,n,s,r)}}class wP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class AP{constructor(e,n){this.count=e,this.unchangedNames=n}}var Ze,we;function RP(t){switch(t){case x.OK:return le(64938);case x.CANCELLED:case x.UNKNOWN:case x.DEADLINE_EXCEEDED:case x.RESOURCE_EXHAUSTED:case x.INTERNAL:case x.UNAVAILABLE:case x.UNAUTHENTICATED:return!1;case x.INVALID_ARGUMENT:case x.NOT_FOUND:case x.ALREADY_EXISTS:case x.PERMISSION_DENIED:case x.FAILED_PRECONDITION:case x.ABORTED:case x.OUT_OF_RANGE:case x.UNIMPLEMENTED:case x.DATA_LOSS:return!0;default:return le(15467,{code:t})}}function Dv(t){if(t===void 0)return ms("GRPC error has no .code"),x.UNKNOWN;switch(t){case Ze.OK:return x.OK;case Ze.CANCELLED:return x.CANCELLED;case Ze.UNKNOWN:return x.UNKNOWN;case Ze.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case Ze.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case Ze.INTERNAL:return x.INTERNAL;case Ze.UNAVAILABLE:return x.UNAVAILABLE;case Ze.UNAUTHENTICATED:return x.UNAUTHENTICATED;case Ze.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case Ze.NOT_FOUND:return x.NOT_FOUND;case Ze.ALREADY_EXISTS:return x.ALREADY_EXISTS;case Ze.PERMISSION_DENIED:return x.PERMISSION_DENIED;case Ze.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case Ze.ABORTED:return x.ABORTED;case Ze.OUT_OF_RANGE:return x.OUT_OF_RANGE;case Ze.UNIMPLEMENTED:return x.UNIMPLEMENTED;case Ze.DATA_LOSS:return x.DATA_LOSS;default:return le(39323,{code:t})}}(we=Ze||(Ze={}))[we.OK=0]="OK",we[we.CANCELLED=1]="CANCELLED",we[we.UNKNOWN=2]="UNKNOWN",we[we.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",we[we.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",we[we.NOT_FOUND=5]="NOT_FOUND",we[we.ALREADY_EXISTS=6]="ALREADY_EXISTS",we[we.PERMISSION_DENIED=7]="PERMISSION_DENIED",we[we.UNAUTHENTICATED=16]="UNAUTHENTICATED",we[we.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",we[we.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",we[we.ABORTED=10]="ABORTED",we[we.OUT_OF_RANGE=11]="OUT_OF_RANGE",we[we.UNIMPLEMENTED=12]="UNIMPLEMENTED",we[we.INTERNAL=13]="INTERNAL",we[we.UNAVAILABLE=14]="UNAVAILABLE",we[we.DATA_LOSS=15]="DATA_LOSS";function CP(){return new TextEncoder}const SP=new $s([4294967295,4294967295],0);function mg(t){const e=CP().encode(t),n=new GE;return n.update(e),new Uint8Array(n.digest())}function gg(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new $s([n,s],0),new $s([r,i],0)]}class Gf{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new yo(`Invalid padding: ${n}`);if(s<0)throw new yo(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new yo(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new yo(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=$s.fromNumber(this.ge)}ye(e,n,s){let r=e.add(n.multiply($s.fromNumber(s)));return r.compare(SP)===1&&(r=new $s([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=mg(e),[s,r]=gg(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);if(!this.we(o))return!1}return!0}static create(e,n,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Gf(i,r,n);return s.forEach((a=>o.insert(a))),o}insert(e){if(this.ge===0)return;const n=mg(e),[s,r]=gg(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class yo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Hl{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,ga.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new Hl(ue.min(),r,new nt(ye),gs(),Ee())}}class ga{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new ga(s,n,Ee(),Ee(),Ee())}}class fc{constructor(e,n,s,r){this.be=e,this.removedTargetIds=n,this.key=s,this.De=r}}class Ov{constructor(e,n){this.targetId=e,this.Ce=n}}class xv{constructor(e,n,s=Et.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class _g{constructor(){this.ve=0,this.Fe=yg(),this.Me=Et.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ee(),n=Ee(),s=Ee();return this.Fe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:le(38017,{changeType:i})}})),new ga(this.Me,this.xe,e,n,s)}qe(){this.Oe=!1,this.Fe=yg()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ke(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class bP{constructor(e){this.Ge=e,this.ze=new Map,this.je=gs(),this.Je=Ya(),this.He=Ya(),this.Ye=new nt(ye)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const s=this.nt(n);switch(e.state){case 0:this.rt(n)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),s.Le(e.resumeToken));break;default:le(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((s,r)=>{this.rt(r)&&n(r)}))}st(e){const n=e.targetId,s=e.Ce.count,r=this.ot(n);if(r){const i=r.target;if(xh(i))if(s===0){const o=new ne(i.path);this.et(n,o,St.newNoDocument(o,ue.min()))}else ke(s===1,20013,{expectedCount:s});else{const o=this._t(n);if(o!==s){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,u)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=n;let o,a;try{o=Zs(s).toUint8Array()}catch(l){if(l instanceof rv)return Ei("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Gf(o,r,i)}catch(l){return Ei(l instanceof yo?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,n,s){return n.Ce.count===s-this.Pt(e,n.targetId)?0:2}Pt(e,n){const s=this.Ge.getRemoteKeysForTarget(n);let r=0;return s.forEach((i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),r++)})),r}Tt(e){const n=new Map;this.ze.forEach(((i,o)=>{const a=this.ot(o);if(a){if(i.current&&xh(a.target)){const l=new ne(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,St.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}}));let s=Ee();this.He.forEach(((i,o)=>{let a=!0;o.forEachWhile((l=>{const u=this.ot(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(s=s.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const r=new Hl(e,n,this.Ye,this.je,s);return this.je=gs(),this.Je=Ya(),this.He=Ya(),this.Ye=new nt(ye),r}Xe(e,n){if(!this.rt(e))return;const s=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,s),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,n)?r.Qe(n,1):r.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),s&&(this.je=this.je.insert(n,s))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new _g,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new ot(ye),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new ot(ye),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Z("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new _g),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Ya(){return new nt(ne.comparator)}function yg(){return new nt(ne.comparator)}const PP={asc:"ASCENDING",desc:"DESCENDING"},NP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kP={and:"AND",or:"OR"};class DP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Mh(t,e){return t.useProto3Json||Vl(e)?e:{value:e}}function jc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vv(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function OP(t,e){return jc(t,e.toTimestamp())}function Mn(t){return ke(!!t,49232),ue.fromTimestamp((function(n){const s=Js(n);return new He(s.seconds,s.nanos)})(t))}function Kf(t,e){return Lh(t,e).canonicalString()}function Lh(t,e){const n=(function(r){return new Ue(["projects",r.projectId,"databases",r.database])})(t).child("documents");return e===void 0?n:n.child(e)}function Mv(t){const e=Ue.fromString(t);return ke(jv(e),10190,{key:e.toString()}),e}function Fh(t,e){return Kf(t.databaseId,e.path)}function Wu(t,e){const n=Mv(e);if(n.get(1)!==t.databaseId.projectId)throw new Q(x.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Q(x.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ne(Fv(n))}function Lv(t,e){return Kf(t.databaseId,e)}function xP(t){const e=Mv(t);return e.length===4?Ue.emptyPath():Fv(e)}function Uh(t){return new Ue(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Fv(t){return ke(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Eg(t,e,n){return{name:Fh(t,e),fields:n.value.mapValue.fields}}function VP(t,e){let n;if("targetChange"in e){e.targetChange;const s=(function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:le(39313,{state:u})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=(function(u,h){return u.useProto3Json?(ke(h===void 0||typeof h=="string",58123),Et.fromBase64String(h||"")):(ke(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Et.fromUint8Array(h||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(u){const h=u.code===void 0?x.UNKNOWN:Dv(u.code);return new Q(h,u.message||"")})(o);n=new xv(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=Wu(t,s.document.name),i=Mn(s.document.updateTime),o=s.document.createTime?Mn(s.document.createTime):ue.min(),a=new Ht({mapValue:{fields:s.document.fields}}),l=St.newFoundDocument(r,i,o,a),u=s.targetIds||[],h=s.removedTargetIds||[];n=new fc(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=Wu(t,s.document),i=s.readTime?Mn(s.readTime):ue.min(),o=St.newNoDocument(r,i),a=s.removedTargetIds||[];n=new fc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=Wu(t,s.document),i=s.removedTargetIds||[];n=new fc([],i,r,null)}else{if(!("filter"in e))return le(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new AP(r,i),a=s.targetId;n=new Ov(a,o)}}return n}function MP(t,e){let n;if(e instanceof ma)n={update:Eg(t,e.key,e.value)};else if(e instanceof ql)n={delete:Fh(t,e.key)};else if(e instanceof or)n={update:Eg(t,e.key,e.data),updateMask:$P(e.fieldMask)};else{if(!(e instanceof TP))return le(16599,{Vt:e.type});n={verify:Fh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((s=>(function(i,o){const a=o.transform;if(a instanceof ta)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof wi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof na)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Bc)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw le(20930,{transform:o.transform})})(0,s)))),e.precondition.isNone||(n.currentDocument=(function(r,i){return i.updateTime!==void 0?{updateTime:OP(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:le(27497)})(t,e.precondition)),n}function LP(t,e){return t&&t.length>0?(ke(e!==void 0,14353),t.map((n=>(function(r,i){let o=r.updateTime?Mn(r.updateTime):Mn(i);return o.isEqual(ue.min())&&(o=Mn(i)),new yP(o,r.transformResults||[])})(n,e)))):[]}function FP(t,e){return{documents:[Lv(t,e.path)]}}function UP(t,e){const n={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=Lv(t,r);const i=(function(u){if(u.length!==0)return Bv(An.create(u,"and"))})(e.filters);i&&(n.structuredQuery.where=i);const o=(function(u){if(u.length!==0)return u.map((h=>(function(m){return{field:ei(m.field),direction:qP(m.dir)}})(h)))})(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Mh(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=(function(u){return{before:u.inclusive,values:u.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(u){return{before:!u.inclusive,values:u.position}})(e.endAt)),{ft:n,parent:r}}function BP(t){let e=xP(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){ke(s===1,65062);const h=n.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=(function(d){const m=Uv(d);return m instanceof An&&pv(m)?m.getFilters():[m]})(n.where));let o=[];n.orderBy&&(o=(function(d){return d.map((m=>(function(S){return new ea(ti(S.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(m)))})(n.orderBy));let a=null;n.limit&&(a=(function(d){let m;return m=typeof d=="object"?d.value:d,Vl(m)?null:m})(n.limit));let l=null;n.startAt&&(l=(function(d){const m=!!d.before,g=d.values||[];return new Fc(g,m)})(n.startAt));let u=null;return n.endAt&&(u=(function(d){const m=!d.before,g=d.values||[];return new Fc(g,m)})(n.endAt)),iP(e,r,o,i,a,"F",l,u)}function jP(t,e){const n=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return le(28987,{purpose:r})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Uv(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=ti(n.unaryFilter.field);return et.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=ti(n.unaryFilter.field);return et.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ti(n.unaryFilter.field);return et.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ti(n.unaryFilter.field);return et.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return le(61313);default:return le(60726)}})(t):t.fieldFilter!==void 0?(function(n){return et.create(ti(n.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return le(58110);default:return le(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return An.create(n.compositeFilter.filters.map((s=>Uv(s))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return le(1026)}})(n.compositeFilter.op))})(t):le(30097,{filter:t})}function qP(t){return PP[t]}function HP(t){return NP[t]}function WP(t){return kP[t]}function ei(t){return{fieldPath:t.canonicalString()}}function ti(t){return _t.fromServerFormat(t.fieldPath)}function Bv(t){return t instanceof et?(function(n){if(n.op==="=="){if(og(n.value))return{unaryFilter:{field:ei(n.field),op:"IS_NAN"}};if(ig(n.value))return{unaryFilter:{field:ei(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(og(n.value))return{unaryFilter:{field:ei(n.field),op:"IS_NOT_NAN"}};if(ig(n.value))return{unaryFilter:{field:ei(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ei(n.field),op:HP(n.op),value:n.value}}})(t):t instanceof An?(function(n){const s=n.getFilters().map((r=>Bv(r)));return s.length===1?s[0]:{compositeFilter:{op:WP(n.op),filters:s}}})(t):le(54877,{filter:t})}function $P(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function jv(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Bs{constructor(e,n,s,r,i=ue.min(),o=ue.min(),a=Et.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Bs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class GP{constructor(e){this.yt=e}}function KP(t){const e=BP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Uc(e,e.limit,"L"):e}class zP{constructor(){this.Cn=new QP}addToCollectionParentIndex(e,n){return this.Cn.add(n),F.resolve()}getCollectionParents(e,n){return F.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return F.resolve()}deleteFieldIndex(e,n){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,n){return F.resolve()}getDocumentsMatchingTarget(e,n){return F.resolve(null)}getIndexType(e,n){return F.resolve(0)}getFieldIndexes(e,n){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,n){return F.resolve(Xs.min())}getMinOffsetFromCollectionGroup(e,n){return F.resolve(Xs.min())}updateCollectionGroup(e,n,s){return F.resolve()}updateIndexEntries(e,n){return F.resolve()}}class QP{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new ot(Ue.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new ot(Ue.comparator)).toArray()}}const vg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qv=41943040;class qt{static withCacheSize(e){return new qt(e,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}}qt.DEFAULT_COLLECTION_PERCENTILE=10,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qt.DEFAULT=new qt(qv,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qt.DISABLED=new qt(-1,0,0);class Ai{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ai(0)}static cr(){return new Ai(-1)}}const Tg="LruGarbageCollector",YP=1048576;function Ig([t,e],[n,s]){const r=ye(t,n);return r===0?ye(e,s):r}class XP{constructor(e){this.Ir=e,this.buffer=new ot(Ig),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();Ig(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class JP{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Z(Tg,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){xi(n)?Z(Tg,"Ignoring IndexedDB error during garbage collection: ",n):await Oi(n)}await this.Vr(3e5)}))}}class ZP{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((s=>Math.floor(n/100*s)))}nthSequenceNumber(e,n){if(n===0)return F.resolve(xl.ce);const s=new XP(n);return this.mr.forEachTarget(e,(r=>s.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>s.Ar(r))))).next((()=>s.maxValue))}removeTargets(e,n,s){return this.mr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Z("LruGarbageCollector","Garbage collection skipped; disabled"),F.resolve(vg)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),vg):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let s,r,i,o,a,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(Z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),r=this.params.maximumSequenceNumbersToCollect):r=d,o=Date.now(),this.nthSequenceNumber(e,r)))).next((d=>(s=d,a=Date.now(),this.removeTargets(e,s,n)))).next((d=>(i=d,l=Date.now(),this.removeOrphanedDocuments(e,s)))).next((d=>(u=Date.now(),Jr()<=ge.DEBUG&&Z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:d}))))}}function e0(t,e){return new ZP(t,e)}class t0{constructor(){this.changes=new Br((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,St.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?F.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class n0{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class s0{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next((r=>(s=r,this.remoteDocumentCache.getEntry(e,n)))).next((r=>(s!==null&&Oo(s.mutation,r,Zt.empty(),He.now()),r)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((s=>this.getLocalViewOfDocuments(e,s,Ee()).next((()=>s))))}getLocalViewOfDocuments(e,n,s=Ee()){const r=Ar();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,s).next((i=>{let o=_o();return i.forEach(((a,l)=>{o=o.insert(a,l.overlayedDocument)})),o}))))}getOverlayedDocuments(e,n){const s=Ar();return this.populateOverlays(e,s,n).next((()=>this.computeViews(e,n,s,Ee())))}populateOverlays(e,n,s){const r=[];return s.forEach((i=>{n.has(i)||r.push(i)})),this.documentOverlayCache.getOverlays(e,r).next((i=>{i.forEach(((o,a)=>{n.set(o,a)}))}))}computeViews(e,n,s,r){let i=gs();const o=Do(),a=(function(){return Do()})();return n.forEach(((l,u)=>{const h=s.get(u.key);r.has(u.key)&&(h===void 0||h.mutation instanceof or)?i=i.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Oo(h.mutation,u,h.mutation.getFieldMask(),He.now())):o.set(u.key,Zt.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((u,h)=>o.set(u,h))),n.forEach(((u,h)=>a.set(u,new n0(h,o.get(u)??null)))),a)))}recalculateAndSaveOverlays(e,n){const s=Do();let r=new nt(((o,a)=>o-a)),i=Ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((o=>{for(const a of o)a.keys().forEach((l=>{const u=n.get(l);if(u===null)return;let h=s.get(l)||Zt.empty();h=a.applyToLocalView(u,h),s.set(l,h);const d=(r.get(a.batchId)||Ee()).add(l);r=r.insert(a.batchId,d)}))})).next((()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,h=l.value,d=wv();h.forEach((m=>{if(!i.has(m)){const g=Nv(n.get(m),s.get(m));g!==null&&d.set(m,g),i=i.add(m)}})),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return F.waitFor(o)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,n,s,r){return(function(o){return ne.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):yv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,r):this.getDocumentsMatchingCollectionQuery(e,n,s,r)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next((i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):F.resolve(Ar());let a=Yo,l=i;return o.next((u=>F.forEach(u,((h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(h)?F.resolve():this.remoteDocumentCache.getEntry(e,h).next((m=>{l=l.insert(h,m)}))))).next((()=>this.populateOverlays(e,u,i))).next((()=>this.computeViews(e,l,u,Ee()))).next((h=>({batchId:a,changes:Iv(h)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ne(n)).next((s=>{let r=_o();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r}))}getDocumentsMatchingCollectionGroupQuery(e,n,s,r){const i=n.collectionGroup;let o=_o();return this.indexManager.getCollectionParents(e,i).next((a=>F.forEach(a,(l=>{const u=(function(d,m){return new Vi(m,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,s,r).next((h=>{h.forEach(((d,m)=>{o=o.insert(d,m)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,n,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,i,r)))).next((o=>{i.forEach(((l,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,St.newInvalidDocument(h)))}));let a=_o();return o.forEach(((l,u)=>{const h=i.get(l);h!==void 0&&Oo(h.mutation,u,Zt.empty(),He.now()),Ul(n,u)&&(a=a.insert(l,u))})),a}))}}class r0{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return F.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(r){return{id:r.id,version:r.version,createTime:Mn(r.createTime)}})(n)),F.resolve()}getNamedQuery(e,n){return F.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(r){return{name:r.name,query:KP(r.bundledQuery),readTime:Mn(r.readTime)}})(n)),F.resolve()}}class i0{constructor(){this.overlays=new nt(ne.comparator),this.qr=new Map}getOverlay(e,n){return F.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Ar();return F.forEach(n,(r=>this.getOverlay(e,r).next((i=>{i!==null&&s.set(r,i)})))).next((()=>s))}saveOverlays(e,n,s){return s.forEach(((r,i)=>{this.St(e,n,i)})),F.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(s)),F.resolve()}getOverlaysForCollection(e,n,s){const r=Ar(),i=n.length+1,o=new ne(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&l.largestBatchId>s&&r.set(l.getKey(),l)}return F.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new nt(((u,h)=>u-h));const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>s){let h=i.get(u.largestBatchId);h===null&&(h=Ar(),i=i.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=Ar(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((u,h)=>a.set(u,h))),!(a.size()>=r)););return F.resolve(a)}St(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new wP(n,s));let i=this.qr.get(n);i===void 0&&(i=Ee(),this.qr.set(n,i)),this.qr.set(n,i.add(s.key))}}class o0{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,F.resolve()}}class zf{constructor(){this.Qr=new ot(ut.$r),this.Ur=new ot(ut.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const s=new ut(e,n);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,n){e.forEach((s=>this.addReference(s,n)))}removeReference(e,n){this.Gr(new ut(e,n))}zr(e,n){e.forEach((s=>this.removeReference(s,n)))}jr(e){const n=new ne(new Ue([])),s=new ut(n,e),r=new ut(n,e+1),i=[];return this.Ur.forEachInRange([s,r],(o=>{this.Gr(o),i.push(o.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ne(new Ue([])),s=new ut(n,e),r=new ut(n,e+1);let i=Ee();return this.Ur.forEachInRange([s,r],(o=>{i=i.add(o.key)})),i}containsKey(e){const n=new ut(e,0),s=this.Qr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class ut{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ne.comparator(e.key,n.key)||ye(e.Yr,n.Yr)}static Kr(e,n){return ye(e.Yr,n.Yr)||ne.comparator(e.key,n.key)}}class a0{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new ot(ut.$r)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new IP(i,n,s,r);this.mutationQueue.push(o);for(const a of r)this.Zr=this.Zr.add(new ut(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return F.resolve(o)}lookupMutationBatch(e,n){return F.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ei(s),i=r<0?0:r;return F.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?Uf:this.tr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new ut(n,0),r=new ut(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],(o=>{const a=this.Xr(o.Yr);i.push(a)})),F.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new ot(ye);return n.forEach((r=>{const i=new ut(r,0),o=new ut(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],(a=>{s=s.add(a.Yr)}))})),F.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;ne.isDocumentKey(i)||(i=i.child(""));const o=new ut(new ne(i),0);let a=new ot(ye);return this.Zr.forEachWhile((l=>{const u=l.key.path;return!!s.isPrefixOf(u)&&(u.length===r&&(a=a.add(l.Yr)),!0)}),o),F.resolve(this.ti(a))}ti(e){const n=[];return e.forEach((s=>{const r=this.Xr(s);r!==null&&n.push(r)})),n}removeMutationBatch(e,n){ke(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return F.forEach(n.mutations,(r=>{const i=new ut(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,n){const s=new ut(n,0),r=this.Zr.firstAfterOrEqual(s);return F.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class c0{constructor(e){this.ri=e,this.docs=(function(){return new nt(ne.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.ri(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return F.resolve(s?s.document.mutableCopy():St.newInvalidDocument(n))}getEntries(e,n){let s=gs();return n.forEach((r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():St.newInvalidDocument(r))})),F.resolve(s)}getDocumentsMatchingQuery(e,n,s,r){let i=gs();const o=n.path,a=new ne(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Lb(Mb(h),s)<=0||(r.has(h.key)||Ul(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return F.resolve(i)}getAllFromCollectionGroup(e,n,s,r){le(9500)}ii(e,n){return F.forEach(this.docs,(s=>n(s)))}newChangeBuffer(e){return new l0(this)}getSize(e){return F.resolve(this.size)}}class l0 extends t0{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((s,r)=>{r.isValidDocument()?n.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)})),F.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class u0{constructor(e){this.persistence=e,this.si=new Br((n=>qf(n)),Hf),this.lastRemoteSnapshotVersion=ue.min(),this.highestTargetId=0,this.oi=0,this._i=new zf,this.targetCount=0,this.ai=Ai.ur()}forEachTarget(e,n){return this.si.forEach(((s,r)=>n(r))),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.oi&&(this.oi=n),F.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Ai(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,F.resolve()}updateTargetData(e,n){return this.Pr(n),F.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,F.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=n&&s.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)})),F.waitFor(i).next((()=>r))}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,n){const s=this.si.get(n)||null;return F.resolve(s)}addMatchingKeys(e,n,s){return this._i.Wr(n,s),F.resolve()}removeMatchingKeys(e,n,s){this._i.zr(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach((o=>{i.push(r.markPotentiallyOrphaned(e,o))})),F.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),F.resolve()}getMatchingKeysForTargetId(e,n){const s=this._i.Hr(n);return F.resolve(s)}containsKey(e,n){return F.resolve(this._i.containsKey(n))}}class Hv{constructor(e,n){this.ui={},this.overlays={},this.ci=new xl(0),this.li=!1,this.li=!0,this.hi=new o0,this.referenceDelegate=e(this),this.Pi=new u0(this),this.indexManager=new zP,this.remoteDocumentCache=(function(r){return new c0(r)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new GP(n),this.Ii=new r0(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new i0,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.ui[e.toKey()];return s||(s=new a0(n,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,s){Z("MemoryPersistence","Starting transaction:",e);const r=new h0(this.ci.next());return this.referenceDelegate.Ei(),s(r).next((i=>this.referenceDelegate.di(r).next((()=>i)))).toPromise().then((i=>(r.raiseOnCommittedEvent(),i)))}Ai(e,n){return F.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,n))))}}class h0 extends Ub{constructor(e){super(),this.currentSequenceNumber=e}}class Qf{constructor(e){this.persistence=e,this.Ri=new zf,this.Vi=null}static mi(e){return new Qf(e)}get fi(){if(this.Vi)return this.Vi;throw le(60996)}addReference(e,n,s){return this.Ri.addReference(s,n),this.fi.delete(s.toString()),F.resolve()}removeReference(e,n,s){return this.Ri.removeReference(s,n),this.fi.add(s.toString()),F.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),F.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((r=>this.fi.add(r.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next((r=>{r.forEach((i=>this.fi.add(i.toString())))})).next((()=>s.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.fi,(s=>{const r=ne.fromPath(s);return this.gi(e,r).next((i=>{i||n.removeEntry(r,ue.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((s=>{s?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return F.or([()=>F.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class qc{constructor(e,n){this.persistence=e,this.pi=new Br((s=>qb(s.path)),((s,r)=>s.isEqual(r))),this.garbageCollector=e0(this,n)}static mi(e,n){return new qc(e,n)}Ei(){}di(e){return F.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>n.next((r=>s+r))))}wr(e){let n=0;return this.pr(e,(s=>{n++})).next((()=>n))}pr(e,n){return F.forEach(this.pi,((s,r)=>this.br(e,s,r).next((i=>i?F.resolve():n(r)))))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,(o=>this.br(e,o,n).next((a=>{a||(s++,i.removeEntry(o,ue.min()))})))).next((()=>i.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),F.resolve()}removeReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=lc(e.data.value)),n}br(e,n,s){return F.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const r=this.pi.get(n);return F.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Yf{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Es=s,this.ds=r}static As(e,n){let s=Ee(),r=Ee();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Yf(e,n.fromCache,s,r)}}class f0{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class d0{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return eS()?8:Bb(Ot())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,s,r){const i={result:null};return this.ys(e,n).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ws(e,n,r,s).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new f0;return this.Ss(e,n,o).next((a=>{if(i.result=a,this.Vs)return this.bs(e,n,o,a.size)}))})).next((()=>i.result))}bs(e,n,s,r){return s.documentReadCount<this.fs?(Jr()<=ge.DEBUG&&Z("QueryEngine","SDK will not create cache indexes for query:",Zr(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),F.resolve()):(Jr()<=ge.DEBUG&&Z("QueryEngine","Query:",Zr(n),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(Jr()<=ge.DEBUG&&Z("QueryEngine","The SDK decides to create cache indexes for query:",Zr(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vn(n))):F.resolve())}ys(e,n){if(ug(n))return F.resolve(null);let s=Vn(n);return this.indexManager.getIndexType(e,s).next((r=>r===0?null:(n.limit!==null&&r===1&&(n=Uc(n,null,"F"),s=Vn(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next((i=>{const o=Ee(...i);return this.ps.getDocuments(e,o).next((a=>this.indexManager.getMinOffset(e,s).next((l=>{const u=this.Ds(n,a);return this.Cs(n,u,o,l.readTime)?this.ys(e,Uc(n,null,"F")):this.vs(e,u,n,l)}))))})))))}ws(e,n,s,r){return ug(n)||r.isEqual(ue.min())?F.resolve(null):this.ps.getDocuments(e,s).next((i=>{const o=this.Ds(n,i);return this.Cs(n,o,s,r)?F.resolve(null):(Jr()<=ge.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Zr(n)),this.vs(e,o,n,Vb(r,Yo)).next((a=>a)))}))}Ds(e,n){let s=new ot(vv(e));return n.forEach(((r,i)=>{Ul(e,i)&&(s=s.add(i))})),s}Cs(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,n,s){return Jr()<=ge.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",Zr(n)),this.ps.getDocumentsMatchingQuery(e,n,Xs.min(),s)}vs(e,n,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next((i=>(n.forEach((o=>{i=i.insert(o.key,o)})),i)))}}const Xf="LocalStore",p0=3e8;class m0{constructor(e,n,s,r){this.persistence=e,this.Fs=n,this.serializer=r,this.Ms=new nt(ye),this.xs=new Br((i=>qf(i)),Hf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new s0(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function g0(t,e,n,s){return new m0(t,e,n,s)}async function Wv(t,e){const n=fe(t);return await n.persistence.runTransaction("Handle user change","readonly",(s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next((i=>(r=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(s)))).next((i=>{const o=[],a=[];let l=Ee();for(const u of r){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of i){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return n.localDocuments.getDocuments(s,l).next((u=>({Ls:u,removedBatchIds:o,addedBatchIds:a})))}))}))}function _0(t,e){const n=fe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const r=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,l,u,h){const d=u.batch,m=d.keys();let g=F.resolve();return m.forEach((S=>{g=g.next((()=>h.getEntry(l,S))).next((P=>{const N=u.docVersions.get(S);ke(N!==null,48541),P.version.compareTo(N)<0&&(d.applyToRemoteDocument(P,u),P.isValidDocument()&&(P.setReadTime(u.commitVersion),h.addEntry(P)))}))})),g.next((()=>a.mutationQueue.removeMutationBatch(l,d)))})(n,s,e,i).next((()=>i.apply(s))).next((()=>n.mutationQueue.performConsistencyCheck(s))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(a){let l=Ee();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l})(e)))).next((()=>n.localDocuments.getDocuments(s,r)))}))}function $v(t){const e=fe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function y0(t,e){const n=fe(t),s=e.snapshotVersion;let r=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});r=n.Ms;const a=[];e.targetChanges.forEach(((h,d)=>{const m=r.get(d);if(!m)return;a.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,d).next((()=>n.Pi.addMatchingKeys(i,h.addedDocuments,d))));let g=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?g=g.withResumeToken(Et.EMPTY_BYTE_STRING,ue.min()).withLastLimboFreeSnapshotVersion(ue.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,s)),r=r.insert(d,g),(function(P,N,O){return P.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=p0?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0})(m,g,h)&&a.push(n.Pi.updateTargetData(i,g))}));let l=gs(),u=Ee();if(e.documentUpdates.forEach((h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))})),a.push(E0(i,o,e.documentUpdates).next((h=>{l=h.ks,u=h.qs}))),!s.isEqual(ue.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next((d=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s)));a.push(h)}return F.waitFor(a).next((()=>o.apply(i))).next((()=>n.localDocuments.getLocalViewOfDocuments(i,l,u))).next((()=>l))})).then((i=>(n.Ms=r,i)))}function E0(t,e,n){let s=Ee(),r=Ee();return n.forEach((i=>s=s.add(i))),e.getEntries(t,s).next((i=>{let o=gs();return n.forEach(((a,l)=>{const u=i.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(a)),l.isNoDocument()&&l.version.isEqual(ue.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Z(Xf,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)})),{ks:o,qs:r}}))}function v0(t,e){const n=fe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=Uf),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function T0(t,e){const n=fe(t);return n.persistence.runTransaction("Allocate target","readwrite",(s=>{let r;return n.Pi.getTargetData(s,e).next((i=>i?(r=i,F.resolve(r)):n.Pi.allocateTargetId(s).next((o=>(r=new Bs(e,o,"TargetPurposeListen",s.currentSequenceNumber),n.Pi.addTargetData(s,r).next((()=>r)))))))})).then((s=>{const r=n.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(s.targetId,s),n.xs.set(e,s.targetId)),s}))}async function Bh(t,e,n){const s=fe(t),r=s.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,(o=>s.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!xi(o))throw o;Z(Xf,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function wg(t,e,n){const s=fe(t);let r=ue.min(),i=Ee();return s.persistence.runTransaction("Execute query","readwrite",(o=>(function(l,u,h){const d=fe(l),m=d.xs.get(h);return m!==void 0?F.resolve(d.Ms.get(m)):d.Pi.getTargetData(u,h)})(s,o,Vn(e)).next((a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,a.targetId).next((l=>{i=l}))})).next((()=>s.Fs.getDocumentsMatchingQuery(o,e,n?r:ue.min(),n?i:Ee()))).next((a=>(I0(s,aP(e),a),{documents:a,Qs:i})))))}function I0(t,e,n){let s=t.Os.get(e)||ue.min();n.forEach(((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)})),t.Os.set(e,s)}class Ag{constructor(){this.activeTargetIds=dP()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class w0{constructor(){this.Mo=new Ag,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,s){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ag,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class A0{Oo(e){}shutdown(){}}const Rg="ConnectivityMonitor";class Cg{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Z(Rg,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Z(Rg,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Xa=null;function jh(){return Xa===null?Xa=(function(){return 268435456+Math.round(2147483648*Math.random())})():Xa++,"0x"+Xa.toString(16)}const $u="RestConnection",R0={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class C0{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===Mc?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,n,s,r,i){const o=jh(),a=this.zo(e,n.toUriEncodedString());Z($u,`Sending RPC '${e}' ${o}:`,a,s);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,r,i);const{host:u}=new URL(a),h=vs(u);return this.Jo(e,a,l,s,h).then((d=>(Z($u,`Received RPC '${e}' ${o}: `,d),d)),(d=>{throw Ei($u,`RPC '${e}' ${o} failed with error: `,d,"url: ",a,"request:",s),d}))}Ho(e,n,s,r,i,o){return this.Go(e,n,s,r,i)}jo(e,n,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Di})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((r,i)=>e[i]=r)),s&&s.headers.forEach(((r,i)=>e[i]=r))}zo(e,n){const s=R0[e];return`${this.Uo}/v1/${n}:${s}`}terminate(){}}class S0{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const wt="WebChannelConnection";class b0 extends C0{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,s,r,i){const o=jh();return new Promise(((a,l)=>{const u=new KE;u.setWithCredentials(!0),u.listenOnce(zE.COMPLETE,(()=>{try{switch(u.getLastErrorCode()){case cc.NO_ERROR:const d=u.getResponseJson();Z(wt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),a(d);break;case cc.TIMEOUT:Z(wt,`RPC '${e}' ${o} timed out`),l(new Q(x.DEADLINE_EXCEEDED,"Request time out"));break;case cc.HTTP_ERROR:const m=u.getStatus();if(Z(wt,`RPC '${e}' ${o} failed with status:`,m,"response text:",u.getResponseText()),m>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);const S=g?.error;if(S&&S.status&&S.message){const P=(function(O){const B=O.toLowerCase().replace(/_/g,"-");return Object.values(x).indexOf(B)>=0?B:x.UNKNOWN})(S.status);l(new Q(P,S.message))}else l(new Q(x.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new Q(x.UNAVAILABLE,"Connection failed."));break;default:le(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Z(wt,`RPC '${e}' ${o} completed.`)}}));const h=JSON.stringify(r);Z(wt,`RPC '${e}' ${o} sending request:`,r),u.send(n,"POST",h,s,15)}))}T_(e,n,s){const r=jh(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=XE(),a=YE(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,s),l.encodeInitMessageHeaders=!0;const h=i.join("");Z(wt,`Creating RPC '${e}' stream ${r}: ${h}`,l);const d=o.createWebChannel(h,l);this.I_(d);let m=!1,g=!1;const S=new S0({Yo:N=>{g?Z(wt,`Not sending because RPC '${e}' stream ${r} is closed:`,N):(m||(Z(wt,`Opening RPC '${e}' stream ${r} transport.`),d.open(),m=!0),Z(wt,`RPC '${e}' stream ${r} sending:`,N),d.send(N))},Zo:()=>d.close()}),P=(N,O,B)=>{N.listen(O,(q=>{try{B(q)}catch($){setTimeout((()=>{throw $}),0)}}))};return P(d,go.EventType.OPEN,(()=>{g||(Z(wt,`RPC '${e}' stream ${r} transport opened.`),S.o_())})),P(d,go.EventType.CLOSE,(()=>{g||(g=!0,Z(wt,`RPC '${e}' stream ${r} transport closed`),S.a_(),this.E_(d))})),P(d,go.EventType.ERROR,(N=>{g||(g=!0,Ei(wt,`RPC '${e}' stream ${r} transport errored. Name:`,N.name,"Message:",N.message),S.a_(new Q(x.UNAVAILABLE,"The operation could not be completed")))})),P(d,go.EventType.MESSAGE,(N=>{if(!g){const O=N.data[0];ke(!!O,16349);const B=O,q=B?.error||B[0]?.error;if(q){Z(wt,`RPC '${e}' stream ${r} received error:`,q);const $=q.status;let ee=(function(E){const y=Ze[E];if(y!==void 0)return Dv(y)})($),oe=q.message;ee===void 0&&(ee=x.INTERNAL,oe="Unknown error status: "+$+" with message "+q.message),g=!0,S.a_(new Q(ee,oe)),d.close()}else Z(wt,`RPC '${e}' stream ${r} received:`,O),S.u_(O)}})),P(a,QE.STAT_EVENT,(N=>{N.stat===bh.PROXY?Z(wt,`RPC '${e}' stream ${r} detected buffering proxy`):N.stat===bh.NOPROXY&&Z(wt,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function Gu(){return typeof document<"u"?document:null}function Wl(t){return new DP(t,!0)}class Gv{constructor(e,n,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-s);r>0&&Z("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Sg="PersistentStream";class Kv{constructor(e,n,s,r,i,o,a,l){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Gv(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===x.RESOURCE_EXHAUSTED?(ms(n.toString()),ms("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===x.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,r])=>{this.D_===n&&this.G_(s,r)}),(s=>{e((()=>{const r=new Q(x.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)}))}))}G_(e,n){const s=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{s((()=>this.z_(r)))})),this.stream.onMessage((r=>{s((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Z(Sg,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Z(Sg,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class P0 extends Kv{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=VP(this.serializer,e),s=(function(i){if(!("targetChange"in i))return ue.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ue.min():o.readTime?Mn(o.readTime):ue.min()})(e);return this.listener.H_(n,s)}Y_(e){const n={};n.database=Uh(this.serializer),n.addTarget=(function(i,o){let a;const l=o.target;if(a=xh(l)?{documents:FP(i,l)}:{query:UP(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Vv(i,o.resumeToken);const u=Mh(i,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(ue.min())>0){a.readTime=jc(i,o.snapshotVersion.toTimestamp());const u=Mh(i,o.expectedCount);u!==null&&(a.expectedCount=u)}return a})(this.serializer,e);const s=jP(this.serializer,e);s&&(n.labels=s),this.q_(n)}Z_(e){const n={};n.database=Uh(this.serializer),n.removeTarget=e,this.q_(n)}}class N0 extends Kv{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ke(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ke(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ke(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=LP(e.writeResults,e.commitTime),s=Mn(e.commitTime);return this.listener.na(s,n)}ra(){const e={};e.database=Uh(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((s=>MP(this.serializer,s)))};this.q_(n)}}class k0{}class D0 extends k0{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Q(x.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Go(e,Lh(n,s),r,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Q(x.UNKNOWN,i.toString())}))}Ho(e,n,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(e,Lh(n,s),r,o,a,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===x.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Q(x.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class O0{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ms(n),this.aa=!1):Z("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Or="RemoteStore";class x0{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((o=>{s.enqueueAndForget((async()=>{jr(this)&&(Z(Or,"Restarting streams for network reachability change."),await(async function(l){const u=fe(l);u.Ea.add(4),await _a(u),u.Ra.set("Unknown"),u.Ea.delete(4),await $l(u)})(this))}))})),this.Ra=new O0(s,r)}}async function $l(t){if(jr(t))for(const e of t.da)await e(!0)}async function _a(t){for(const e of t.da)await e(!1)}function zv(t,e){const n=fe(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),td(n)?ed(n):Mi(n).O_()&&Zf(n,e))}function Jf(t,e){const n=fe(t),s=Mi(n);n.Ia.delete(e),s.O_()&&Qv(n,e),n.Ia.size===0&&(s.O_()?s.L_():jr(n)&&n.Ra.set("Unknown"))}function Zf(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Mi(t).Y_(e)}function Qv(t,e){t.Va.Ue(e),Mi(t).Z_(e)}function ed(t){t.Va=new bP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Mi(t).start(),t.Ra.ua()}function td(t){return jr(t)&&!Mi(t).x_()&&t.Ia.size>0}function jr(t){return fe(t).Ea.size===0}function Yv(t){t.Va=void 0}async function V0(t){t.Ra.set("Online")}async function M0(t){t.Ia.forEach(((e,n)=>{Zf(t,e)}))}async function L0(t,e){Yv(t),td(t)?(t.Ra.ha(e),ed(t)):t.Ra.set("Unknown")}async function F0(t,e,n){if(t.Ra.set("Online"),e instanceof xv&&e.state===2&&e.cause)try{await(async function(r,i){const o=i.cause;for(const a of i.targetIds)r.Ia.has(a)&&(await r.remoteSyncer.rejectListen(a,o),r.Ia.delete(a),r.Va.removeTarget(a))})(t,e)}catch(s){Z(Or,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Hc(t,s)}else if(e instanceof fc?t.Va.Ze(e):e instanceof Ov?t.Va.st(e):t.Va.tt(e),!n.isEqual(ue.min()))try{const s=await $v(t.localStore);n.compareTo(s)>=0&&await(function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach(((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.Ia.get(u);h&&i.Ia.set(u,h.withResumeToken(l.resumeToken,o))}})),a.targetMismatches.forEach(((l,u)=>{const h=i.Ia.get(l);if(!h)return;i.Ia.set(l,h.withResumeToken(Et.EMPTY_BYTE_STRING,h.snapshotVersion)),Qv(i,l);const d=new Bs(h.target,l,u,h.sequenceNumber);Zf(i,d)})),i.remoteSyncer.applyRemoteEvent(a)})(t,n)}catch(s){Z(Or,"Failed to raise snapshot:",s),await Hc(t,s)}}async function Hc(t,e,n){if(!xi(e))throw e;t.Ea.add(1),await _a(t),t.Ra.set("Offline"),n||(n=()=>$v(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Z(Or,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await $l(t)}))}function Xv(t,e){return e().catch((n=>Hc(t,n,e)))}async function Gl(t){const e=fe(t),n=tr(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Uf;for(;U0(e);)try{const r=await v0(e.localStore,s);if(r===null){e.Ta.length===0&&n.L_();break}s=r.batchId,B0(e,r)}catch(r){await Hc(e,r)}Jv(e)&&Zv(e)}function U0(t){return jr(t)&&t.Ta.length<10}function B0(t,e){t.Ta.push(e);const n=tr(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Jv(t){return jr(t)&&!tr(t).x_()&&t.Ta.length>0}function Zv(t){tr(t).start()}async function j0(t){tr(t).ra()}async function q0(t){const e=tr(t);for(const n of t.Ta)e.ea(n.mutations)}async function H0(t,e,n){const s=t.Ta.shift(),r=$f.from(s,e,n);await Xv(t,(()=>t.remoteSyncer.applySuccessfulWrite(r))),await Gl(t)}async function W0(t,e){e&&tr(t).X_&&await(async function(s,r){if((function(o){return RP(o)&&o!==x.ABORTED})(r.code)){const i=s.Ta.shift();tr(s).B_(),await Xv(s,(()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r))),await Gl(s)}})(t,e),Jv(t)&&Zv(t)}async function bg(t,e){const n=fe(t);n.asyncQueue.verifyOperationInProgress(),Z(Or,"RemoteStore received new credentials");const s=jr(n);n.Ea.add(3),await _a(n),s&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await $l(n)}async function $0(t,e){const n=fe(t);e?(n.Ea.delete(2),await $l(n)):e||(n.Ea.add(2),await _a(n),n.Ra.set("Unknown"))}function Mi(t){return t.ma||(t.ma=(function(n,s,r){const i=fe(n);return i.sa(),new P0(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)})(t.datastore,t.asyncQueue,{Xo:V0.bind(null,t),t_:M0.bind(null,t),r_:L0.bind(null,t),H_:F0.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),td(t)?ed(t):t.Ra.set("Unknown")):(await t.ma.stop(),Yv(t))}))),t.ma}function tr(t){return t.fa||(t.fa=(function(n,s,r){const i=fe(n);return i.sa(),new N0(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:j0.bind(null,t),r_:W0.bind(null,t),ta:q0.bind(null,t),na:H0.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await Gl(t)):(await t.fa.stop(),t.Ta.length>0&&(Z(Or,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class nd{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new os,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,a=new nd(e,n,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(x.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sd(t,e){if(ms("AsyncQueue",`${e}: ${t}`),xi(t))return new Q(x.UNAVAILABLE,`${e}: ${t}`);throw t}class hi{static emptySet(e){return new hi(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||ne.comparator(n.key,s.key):(n,s)=>ne.comparator(n.key,s.key),this.keyedMap=_o(),this.sortedSet=new nt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,s)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof hi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new hi;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}class Pg{constructor(){this.ga=new nt(ne.comparator)}track(e){const n=e.doc.key,s=this.ga.get(n);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(n,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(n):e.type===1&&s.type===2?this.ga=this.ga.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):le(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,s)=>{e.push(s)})),e}}class Ri{constructor(e,n,s,r,i,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,s,r,i){const o=[];return n.forEach((a=>{o.push({type:0,doc:a})})),new Ri(e,n,hi.emptySet(n),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}class G0{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class K0{constructor(){this.queries=Ng(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,s){const r=fe(n),i=r.queries;r.queries=Ng(),i.forEach(((o,a)=>{for(const l of a.Sa)l.onError(s)}))})(this,new Q(x.ABORTED,"Firestore shutting down"))}}function Ng(){return new Br((t=>Ev(t)),Fl)}async function rd(t,e){const n=fe(t);let s=3;const r=e.query;let i=n.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new G0,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await n.onListen(r,!0);break;case 1:i.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const a=sd(o,`Initialization of query '${Zr(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&od(n)}async function id(t,e){const n=fe(t),s=e.query;let r=3;const i=n.queries.get(s);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function z0(t,e){const n=fe(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const a of o.Sa)a.Fa(r)&&(s=!0);o.wa=r}}s&&od(n)}function Q0(t,e,n){const s=fe(t),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(n);s.queries.delete(e)}function od(t){t.Ca.forEach((e=>{e.next()}))}var qh,kg;(kg=qh||(qh={})).Ma="default",kg.Cache="cache";class ad{constructor(e,n,s){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Ri(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const s=n!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Ri.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qh.Cache}}class eT{constructor(e){this.key=e}}class tT{constructor(e){this.key=e}}class Y0{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ee(),this.mutatedKeys=Ee(),this.eu=vv(e),this.tu=new hi(this.eu)}get nu(){return this.Ya}ru(e,n){const s=n?n.iu:new Pg,r=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((h,d)=>{const m=r.get(h),g=Ul(this.query,d)?d:null,S=!!m&&this.mutatedKeys.has(m.key),P=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let N=!1;m&&g?m.data.isEqual(g.data)?S!==P&&(s.track({type:3,doc:g}),N=!0):this.su(m,g)||(s.track({type:2,doc:g}),N=!0,(l&&this.eu(g,l)>0||u&&this.eu(g,u)<0)&&(a=!0)):!m&&g?(s.track({type:0,doc:g}),N=!0):m&&!g&&(s.track({type:1,doc:m}),N=!0,(l||u)&&(a=!0)),N&&(g?(o=o.add(g),i=P?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),s.track({type:1,doc:h})}return{tu:o,iu:s,Cs:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((h,d)=>(function(g,S){const P=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return le(20277,{Rt:N})}};return P(g)-P(S)})(h.type,d.type)||this.eu(h.doc,d.doc))),this.ou(s),r=r??!1;const a=n&&!r?this._u():[],l=this.Xa.size===0&&this.current&&!r?1:0,u=l!==this.Za;return this.Za=l,o.length!==0||u?{snapshot:new Ri(this.query,e.tu,i,o,e.mutatedKeys,l===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Pg,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ee(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const n=[];return e.forEach((s=>{this.Xa.has(s)||n.push(new tT(s))})),this.Xa.forEach((s=>{e.has(s)||n.push(new eT(s))})),n}cu(e){this.Ya=e.Qs,this.Xa=Ee();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Ri.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const cd="SyncEngine";class X0{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class J0{constructor(e){this.key=e,this.hu=!1}}class Z0{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Br((a=>Ev(a)),Fl),this.Iu=new Map,this.Eu=new Set,this.du=new nt(ne.comparator),this.Au=new Map,this.Ru=new zf,this.Vu={},this.mu=new Map,this.fu=Ai.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function eN(t,e,n=!0){const s=aT(t);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await nT(s,e,n,!0),r}async function tN(t,e){const n=aT(t);await nT(n,e,!0,!1)}async function nT(t,e,n,s){const r=await T0(t.localStore,Vn(e)),i=r.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return s&&(a=await nN(t,e,i,o==="current",r.resumeToken)),t.isPrimaryClient&&n&&zv(t.remoteStore,r),a}async function nN(t,e,n,s,r){t.pu=(d,m,g)=>(async function(P,N,O,B){let q=N.view.ru(O);q.Cs&&(q=await wg(P.localStore,N.query,!1).then((({documents:C})=>N.view.ru(C,q))));const $=B&&B.targetChanges.get(N.targetId),ee=B&&B.targetMismatches.get(N.targetId)!=null,oe=N.view.applyChanges(q,P.isPrimaryClient,$,ee);return Og(P,N.targetId,oe.au),oe.snapshot})(t,d,m,g);const i=await wg(t.localStore,e,!0),o=new Y0(e,i.Qs),a=o.ru(i.documents),l=ga.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),u=o.applyChanges(a,t.isPrimaryClient,l);Og(t,n,u.au);const h=new X0(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),u.snapshot}async function sN(t,e,n){const s=fe(t),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter((o=>!Fl(o,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await Bh(s.localStore,r.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(r.targetId),n&&Jf(s.remoteStore,r.targetId),Hh(s,r.targetId)})).catch(Oi)):(Hh(s,r.targetId),await Bh(s.localStore,r.targetId,!0))}async function rN(t,e){const n=fe(t),s=n.Tu.get(e),r=n.Iu.get(s.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),Jf(n.remoteStore,s.targetId))}async function iN(t,e,n){const s=fN(t);try{const r=await(function(o,a){const l=fe(o),u=He.now(),h=a.reduce(((g,S)=>g.add(S.key)),Ee());let d,m;return l.persistence.runTransaction("Locally write mutations","readwrite",(g=>{let S=gs(),P=Ee();return l.Ns.getEntries(g,h).next((N=>{S=N,S.forEach(((O,B)=>{B.isValidDocument()||(P=P.add(O))}))})).next((()=>l.localDocuments.getOverlayedDocuments(g,S))).next((N=>{d=N;const O=[];for(const B of a){const q=vP(B,d.get(B.key).overlayedDocument);q!=null&&O.push(new or(B.key,q,hv(q.value.mapValue),Bt.exists(!0)))}return l.mutationQueue.addMutationBatch(g,u,O,a)})).next((N=>{m=N;const O=N.applyToLocalDocumentSet(d,P);return l.documentOverlayCache.saveOverlays(g,N.batchId,O)}))})).then((()=>({batchId:m.batchId,changes:Iv(d)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),(function(o,a,l){let u=o.Vu[o.currentUser.toKey()];u||(u=new nt(ye)),u=u.insert(a,l),o.Vu[o.currentUser.toKey()]=u})(s,r.batchId,n),await ya(s,r.changes),await Gl(s.remoteStore)}catch(r){const i=sd(r,"Failed to persist write");n.reject(i)}}async function sT(t,e){const n=fe(t);try{const s=await y0(n.localStore,e);e.targetChanges.forEach(((r,i)=>{const o=n.Au.get(i);o&&(ke(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?ke(o.hu,14607):r.removedDocuments.size>0&&(ke(o.hu,42227),o.hu=!1))})),await ya(n,s,e)}catch(s){await Oi(s)}}function Dg(t,e,n){const s=fe(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.Tu.forEach(((i,o)=>{const a=o.view.va(e);a.snapshot&&r.push(a.snapshot)})),(function(o,a){const l=fe(o);l.onlineState=a;let u=!1;l.queries.forEach(((h,d)=>{for(const m of d.Sa)m.va(a)&&(u=!0)})),u&&od(l)})(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function oN(t,e,n){const s=fe(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Au.get(e),i=r&&r.key;if(i){let o=new nt(ne.comparator);o=o.insert(i,St.newNoDocument(i,ue.min()));const a=Ee().add(i),l=new Hl(ue.min(),new Map,new nt(ye),o,a);await sT(s,l),s.du=s.du.remove(i),s.Au.delete(e),ld(s)}else await Bh(s.localStore,e,!1).then((()=>Hh(s,e,n))).catch(Oi)}async function aN(t,e){const n=fe(t),s=e.batch.batchId;try{const r=await _0(n.localStore,e);iT(n,s,null),rT(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await ya(n,r)}catch(r){await Oi(r)}}async function cN(t,e,n){const s=fe(t);try{const r=await(function(o,a){const l=fe(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",(u=>{let h;return l.mutationQueue.lookupMutationBatch(u,a).next((d=>(ke(d!==null,37113),h=d.keys(),l.mutationQueue.removeMutationBatch(u,d)))).next((()=>l.mutationQueue.performConsistencyCheck(u))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,a))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h))).next((()=>l.localDocuments.getDocuments(u,h)))}))})(s.localStore,e);iT(s,e,n),rT(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await ya(s,r)}catch(r){await Oi(r)}}function rT(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function iT(t,e,n){const s=fe(t);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function Hh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Iu.get(e))t.Tu.delete(s),n&&t.Pu.yu(s,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((s=>{t.Ru.containsKey(s)||oT(t,s)}))}function oT(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Jf(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),ld(t))}function Og(t,e,n){for(const s of n)s instanceof eT?(t.Ru.addReference(s.key,e),lN(t,s)):s instanceof tT?(Z(cd,"Document no longer in limbo: "+s.key),t.Ru.removeReference(s.key,e),t.Ru.containsKey(s.key)||oT(t,s.key)):le(19791,{wu:s})}function lN(t,e){const n=e.key,s=n.path.canonicalString();t.du.get(n)||t.Eu.has(s)||(Z(cd,"New document in limbo: "+n),t.Eu.add(s),ld(t))}function ld(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ne(Ue.fromString(e)),s=t.fu.next();t.Au.set(s,new J0(n)),t.du=t.du.insert(n,s),zv(t.remoteStore,new Bs(Vn(Ll(n.path)),s,"TargetPurposeLimboResolution",xl.ce))}}async function ya(t,e,n){const s=fe(t),r=[],i=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach(((a,l)=>{o.push(s.pu(l,e,n).then((u=>{if((u||n)&&s.isPrimaryClient){const h=u?!u.fromCache:n?.targetChanges.get(l.targetId)?.current;s.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(u){r.push(u);const h=Yf.As(l.targetId,u);i.push(h)}})))})),await Promise.all(o),s.Pu.H_(r),await(async function(l,u){const h=fe(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>F.forEach(u,(m=>F.forEach(m.Es,(g=>h.persistence.referenceDelegate.addReference(d,m.targetId,g))).next((()=>F.forEach(m.ds,(g=>h.persistence.referenceDelegate.removeReference(d,m.targetId,g)))))))))}catch(d){if(!xi(d))throw d;Z(Xf,"Failed to update sequence numbers: "+d)}for(const d of u){const m=d.targetId;if(!d.fromCache){const g=h.Ms.get(m),S=g.snapshotVersion,P=g.withLastLimboFreeSnapshotVersion(S);h.Ms=h.Ms.insert(m,P)}}})(s.localStore,i))}async function uN(t,e){const n=fe(t);if(!n.currentUser.isEqual(e)){Z(cd,"User change. New user:",e.toKey());const s=await Wv(n.localStore,e);n.currentUser=e,(function(i,o){i.mu.forEach((a=>{a.forEach((l=>{l.reject(new Q(x.CANCELLED,o))}))})),i.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await ya(n,s.Ls)}}function hN(t,e){const n=fe(t),s=n.Au.get(e);if(s&&s.hu)return Ee().add(s.key);{let r=Ee();const i=n.Iu.get(e);if(!i)return r;for(const o of i){const a=n.Tu.get(o);r=r.unionWith(a.view.nu)}return r}}function aT(t){const e=fe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=sT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oN.bind(null,e),e.Pu.H_=z0.bind(null,e.eventManager),e.Pu.yu=Q0.bind(null,e.eventManager),e}function fN(t){const e=fe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=aN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=cN.bind(null,e),e}class Wc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Wl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return g0(this.persistence,new d0,e.initialUser,this.serializer)}Cu(e){return new Hv(Qf.mi,this.serializer)}Du(e){return new w0}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Wc.provider={build:()=>new Wc};class dN extends Wc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ke(this.persistence.referenceDelegate instanceof qc,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new JP(s,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?qt.withCacheSize(this.cacheSizeBytes):qt.DEFAULT;return new Hv((s=>qc.mi(s,n)),this.serializer)}}class Wh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Dg(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=uN.bind(null,this.syncEngine),await $0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new K0})()}createDatastore(e){const n=Wl(e.databaseInfo.databaseId),s=(function(i){return new b0(i)})(e.databaseInfo);return(function(i,o,a,l){return new D0(i,o,a,l)})(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return(function(s,r,i,o,a){return new x0(s,r,i,o,a)})(this.localStore,this.datastore,e.asyncQueue,(n=>Dg(this.syncEngine,n,0)),(function(){return Cg.v()?new Cg:new A0})())}createSyncEngine(e,n){return(function(r,i,o,a,l,u,h){const d=new Z0(r,i,o,a,l,u);return h&&(d.gu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const s=fe(n);Z(Or,"RemoteStore shutting down."),s.Ea.add(5),await _a(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Wh.provider={build:()=>new Wh};class ud{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ms("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const nr="FirestoreClient";class pN{constructor(e,n,s,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=Rt.UNAUTHENTICATED,this.clientId=Ff.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,(async o=>{Z(nr,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(s,(o=>(Z(nr,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new os;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=sd(n,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function Ku(t,e){t.asyncQueue.verifyOperationInProgress(),Z(nr,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener((async r=>{s.isEqual(r)||(await Wv(e.localStore,r),s=r)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function xg(t,e){t.asyncQueue.verifyOperationInProgress();const n=await mN(t);Z(nr,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((s=>bg(e.remoteStore,s))),t.setAppCheckTokenChangeListener(((s,r)=>bg(e.remoteStore,r))),t._onlineComponents=e}async function mN(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Z(nr,"Using user provided OfflineComponentProvider");try{await Ku(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(r){return r.name==="FirebaseError"?r.code===x.FAILED_PRECONDITION||r.code===x.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(n))throw n;Ei("Error using user provided cache. Falling back to memory cache: "+n),await Ku(t,new Wc)}}else Z(nr,"Using default OfflineComponentProvider"),await Ku(t,new dN(void 0));return t._offlineComponents}async function cT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Z(nr,"Using user provided OnlineComponentProvider"),await xg(t,t._uninitializedComponentsProvider._online)):(Z(nr,"Using default OnlineComponentProvider"),await xg(t,new Wh))),t._onlineComponents}function gN(t){return cT(t).then((e=>e.syncEngine))}async function $c(t){const e=await cT(t),n=e.eventManager;return n.onListen=eN.bind(null,e.syncEngine),n.onUnlisten=sN.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=tN.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=rN.bind(null,e.syncEngine),n}function _N(t,e,n={}){const s=new os;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,a,l,u){const h=new ud({next:m=>{h.Nu(),o.enqueueAndForget((()=>id(i,d)));const g=m.docs.has(a);!g&&m.fromCache?u.reject(new Q(x.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&m.fromCache&&l&&l.source==="server"?u.reject(new Q(x.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),d=new ad(Ll(a.path),h,{includeMetadataChanges:!0,qa:!0});return rd(i,d)})(await $c(t),t.asyncQueue,e,n,s))),s.promise}function yN(t,e,n={}){const s=new os;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,a,l,u){const h=new ud({next:m=>{h.Nu(),o.enqueueAndForget((()=>id(i,d))),m.fromCache&&l.source==="server"?u.reject(new Q(x.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),d=new ad(a,h,{includeMetadataChanges:!0,qa:!0});return rd(i,d)})(await $c(t),t.asyncQueue,e,n,s))),s.promise}function lT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const Vg=new Map;const uT="firestore.googleapis.com",Mg=!0;class Lg{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Q(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=uT,this.ssl=Mg}else this.host=e.host,this.ssl=e.ssl??Mg;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=qv;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<YP)throw new Q(x.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xb("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lT(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Q(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Q(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Q(x.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,r){return s.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kl{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Lg({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Lg(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new Ab;switch(s.type){case"firstParty":return new bb(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Q(x.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const s=Vg.get(n);s&&(Z("ComponentProvider","Removing Datastore"),Vg.delete(n),s.terminate())})(this),Promise.resolve()}}function EN(t,e,n,s={}){t=Ut(t,Kl);const r=vs(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},a=`${e}:${n}`;r&&(bl(`https://${a}`),Pl("Firestore",!0)),i.host!==uT&&i.host!==a&&Ei("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:r,emulatorOptions:s};if(!fs(l,o)&&(t._setSettings(l),s.mockUserToken)){let u,h;if(typeof s.mockUserToken=="string")u=s.mockUserToken,h=Rt.MOCK_USER;else{u=xf(s.mockUserToken,t._app?.options.projectId);const d=s.mockUserToken.sub||s.mockUserToken.user_id;if(!d)throw new Q(x.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Rt(d)}t._authCredentials=new Rb(new ZE(u,h))}}class Is{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Is(this.firestore,e,this._query)}}class Qe{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ks(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Qe(this.firestore,e,this._key)}toJSON(){return{type:Qe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,s){if(pa(n,Qe._jsonSchema))return new Qe(e,s||null,new ne(Ue.fromString(n.referencePath)))}}Qe._jsonSchemaVersion="firestore/documentReference/1.0",Qe._jsonSchema={type:tt("string",Qe._jsonSchemaVersion),referencePath:tt("string")};class Ks extends Is{constructor(e,n,s){super(e,n,Ll(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Qe(this.firestore,null,new ne(e))}withConverter(e){return new Ks(this.firestore,e,this._path)}}function HM(t,e,...n){if(t=$e(t),ev("collection","path",e),t instanceof Kl){const s=Ue.fromString(e,...n);return Ym(s),new Ks(t,null,s)}{if(!(t instanceof Qe||t instanceof Ks))throw new Q(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Ue.fromString(e,...n));return Ym(s),new Ks(t.firestore,null,s)}}function Eo(t,e,...n){if(t=$e(t),arguments.length===1&&(e=Ff.newId()),ev("doc","path",e),t instanceof Kl){const s=Ue.fromString(e,...n);return Qm(s),new Qe(t,null,new ne(s))}{if(!(t instanceof Qe||t instanceof Ks))throw new Q(x.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(Ue.fromString(e,...n));return Qm(s),new Qe(t.firestore,t instanceof Ks?t.converter:null,new ne(s))}}const Fg="AsyncQueue";class Ug{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Gv(this,"async_queue_retry"),this._c=()=>{const s=Gu();s&&Z(Fg,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const n=Gu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Gu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new os;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!xi(e))throw e;Z(Fg,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,ms("INTERNAL UNHANDLED ERROR: ",Bg(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=n,n}enqueueAfterDelay(e,n,s){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const r=nd.createAndSchedule(this,e,n,s,(i=>this.hc(i)));return this.tc.push(r),r}uc(){this.nc&&le(47125,{Pc:Bg(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,s)=>n.targetTimeMs-s.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Bg(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function jg(t){return(function(n,s){if(typeof n!="object"||n===null)return!1;const r=n;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1})(t,["next","error","complete"])}class jn extends Kl{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new Ug,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ug(e),this._firestoreClient=void 0,await e}}}function vN(t,e){const n=typeof t=="object"?t:Dl(),s=typeof t=="string"?t:Mc,r=da(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=Df("firestore");i&&EN(r,...i)}return r}function Ea(t){if(t._terminated)throw new Q(x.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||TN(t),t._firestoreClient}function TN(t){const e=t._freezeSettings(),n=(function(r,i,o,a){return new $b(r,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,lT(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new pN(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(r){const i=r?._online.build();return{_offline:r?._offline.build(i),_online:i}})(t._componentsProvider))}class sn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new sn(Et.fromBase64String(e))}catch(n){throw new Q(x.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new sn(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:sn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(pa(e,sn._jsonSchema))return sn.fromBase64String(e.bytes)}}sn._jsonSchemaVersion="firestore/bytes/1.0",sn._jsonSchema={type:tt("string",sn._jsonSchemaVersion),bytes:tt("string")};class va{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Q(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _t(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ta{constructor(e){this._methodName=e}}class Ln{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Q(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Q(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ye(this._lat,e._lat)||ye(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ln._jsonSchemaVersion}}static fromJSON(e){if(pa(e,Ln._jsonSchema))return new Ln(e.latitude,e.longitude)}}Ln._jsonSchemaVersion="firestore/geoPoint/1.0",Ln._jsonSchema={type:tt("string",Ln._jsonSchemaVersion),latitude:tt("number"),longitude:tt("number")};class Fn{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Fn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(pa(e,Fn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Fn(e.vectorValues);throw new Q(x.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fn._jsonSchemaVersion="firestore/vectorValue/1.0",Fn._jsonSchema={type:tt("string",Fn._jsonSchemaVersion),vectorValues:tt("object")};const IN=/^__.*__$/;class wN{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new or(e,this.data,this.fieldMask,n,this.fieldTransforms):new ma(e,this.data,n,this.fieldTransforms)}}class hT{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new or(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function fT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw le(40011,{Ac:t})}}class zl{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new zl({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){const n=this.path?.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Gc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(fT(this.Ac)&&IN.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class AN{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||Wl(e)}Cc(e,n,s,r=!1){return new zl({Ac:e,methodName:n,Dc:s,path:_t.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ia(t){const e=t._freezeSettings(),n=Wl(t._databaseId);return new AN(t._databaseId,!!e.ignoreUndefinedProperties,n)}function hd(t,e,n,s,r,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,r);pd("Data must be an object, but it was:",o,s);const a=mT(s,o);let l,u;if(i.merge)l=new Zt(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const d of i.mergeFields){const m=$h(e,d,n);if(!o.contains(m))throw new Q(x.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);_T(h,m)||h.push(m)}l=new Zt(h),u=o.fieldTransforms.filter((d=>l.covers(d.field)))}else l=null,u=o.fieldTransforms;return new wN(new Ht(a),l,u)}class Ql extends Ta{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ql}}function RN(t,e,n){return new zl({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class fd extends Ta{_toFieldTransform(e){return new Pv(e.path,new ta)}isEqual(e){return e instanceof fd}}class dd extends Ta{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=RN(this,e,!0),s=this.vc.map((i=>Li(i,n))),r=new wi(s);return new Pv(e.path,r)}isEqual(e){return e instanceof dd&&fs(this.vc,e.vc)}}function dT(t,e,n,s){const r=t.Cc(1,e,n);pd("Data must be an object, but it was:",r,s);const i=[],o=Ht.empty();ir(s,((l,u)=>{const h=md(e,l,n);u=$e(u);const d=r.yc(h);if(u instanceof Ql)i.push(h);else{const m=Li(u,d);m!=null&&(i.push(h),o.set(h,m))}}));const a=new Zt(i);return new hT(o,a,r.fieldTransforms)}function pT(t,e,n,s,r,i){const o=t.Cc(1,e,n),a=[$h(e,s,n)],l=[r];if(i.length%2!=0)throw new Q(x.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)a.push($h(e,i[m])),l.push(i[m+1]);const u=[],h=Ht.empty();for(let m=a.length-1;m>=0;--m)if(!_T(u,a[m])){const g=a[m];let S=l[m];S=$e(S);const P=o.yc(g);if(S instanceof Ql)u.push(g);else{const N=Li(S,P);N!=null&&(u.push(g),h.set(g,N))}}const d=new Zt(u);return new hT(h,d,o.fieldTransforms)}function CN(t,e,n,s=!1){return Li(n,t.Cc(s?4:3,e))}function Li(t,e){if(gT(t=$e(t)))return pd("Unsupported field value:",e,t),mT(t,e);if(t instanceof Ta)return(function(s,r){if(!fT(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,r){const i=[];let o=0;for(const a of s){let l=Li(a,r.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}})(t,e)}return(function(s,r){if((s=$e(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return pP(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=He.fromDate(s);return{timestampValue:jc(r.serializer,i)}}if(s instanceof He){const i=new He(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:jc(r.serializer,i)}}if(s instanceof Ln)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof sn)return{bytesValue:Vv(r.serializer,s._byteString)};if(s instanceof Qe){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Kf(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Fn)return(function(o,a){return{mapValue:{fields:{[lv]:{stringValue:uv},[Lc]:{arrayValue:{values:o.toArray().map((u=>{if(typeof u!="number")throw a.Sc("VectorValues must only contain numeric values.");return Wf(a.serializer,u)}))}}}}}})(s,r);throw r.Sc(`Unsupported field value: ${Ol(s)}`)})(t,e)}function mT(t,e){const n={};return sv(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ir(t,((s,r)=>{const i=Li(r,e.mc(s));i!=null&&(n[s]=i)})),{mapValue:{fields:n}}}function gT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof He||t instanceof Ln||t instanceof sn||t instanceof Qe||t instanceof Ta||t instanceof Fn)}function pd(t,e,n){if(!gT(n)||!tv(n)){const s=Ol(n);throw s==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+s)}}function $h(t,e,n){if((e=$e(e))instanceof va)return e._internalPath;if(typeof e=="string")return md(t,e);throw Gc("Field path arguments must be of type string or ",t,!1,void 0,n)}const SN=new RegExp("[~\\*/\\[\\]]");function md(t,e,n){if(e.search(SN)>=0)throw Gc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new va(...e.split("."))._internalPath}catch{throw Gc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Gc(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${s}`),o&&(l+=` in document ${r}`),l+=")"),new Q(x.INVALID_ARGUMENT,a+t+l)}function _T(t,e){return t.some((n=>n.isEqual(e)))}class yT{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Qe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new bN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Yl("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class bN extends yT{data(){return super.data()}}function Yl(t,e){return typeof e=="string"?md(t,e):e instanceof va?e._internalPath:e._delegate._internalPath}function ET(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Q(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class gd{}class _d extends gd{}function WM(t,e,...n){let s=[];e instanceof gd&&s.push(e),s=s.concat(n),(function(i){const o=i.filter((l=>l instanceof yd)).length,a=i.filter((l=>l instanceof Xl)).length;if(o>1||o>0&&a>0)throw new Q(x.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const r of s)t=r._apply(t);return t}class Xl extends _d{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new Xl(e,n,s)}_apply(e){const n=this._parse(e);return vT(e._query,n),new Is(e.firestore,e.converter,Vh(e._query,n))}_parse(e){const n=Ia(e.firestore);return(function(i,o,a,l,u,h,d){let m;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Q(x.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Hg(d,h);const S=[];for(const P of d)S.push(qg(l,i,P));m={arrayValue:{values:S}}}else m=qg(l,i,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Hg(d,h),m=CN(a,o,d,h==="in"||h==="not-in");return et.create(u,h,m)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function $M(t,e,n){const s=e,r=Yl("where",t);return Xl._create(r,s,n)}class yd extends gd{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new yd(e,n)}_parse(e){const n=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return n.length===1?n[0]:An.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(r,i){let o=r;const a=i.getFlattenedFilters();for(const l of a)vT(o,l),o=Vh(o,l)})(e._query,n),new Is(e.firestore,e.converter,Vh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ed extends _d{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Ed(e,n)}_apply(e){const n=(function(r,i,o){if(r.startAt!==null)throw new Q(x.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new Q(x.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ea(i,o)})(e._query,this._field,this._direction);return new Is(e.firestore,e.converter,(function(r,i){const o=r.explicitOrderBy.concat([i]);return new Vi(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)})(e._query,n))}}function GM(t,e="asc"){const n=e,s=Yl("orderBy",t);return Ed._create(s,n)}class vd extends _d{constructor(e,n,s){super(),this.type=e,this._limit=n,this._limitType=s}static _create(e,n,s){return new vd(e,n,s)}_apply(e){return new Is(e.firestore,e.converter,Uc(e._query,this._limit,this._limitType))}}function KM(t){return vd._create("limit",t,"F")}function qg(t,e,n){if(typeof(n=$e(n))=="string"){if(n==="")throw new Q(x.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yv(e)&&n.indexOf("/")!==-1)throw new Q(x.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(Ue.fromString(n));if(!ne.isDocumentKey(s))throw new Q(x.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return rg(t,new ne(s))}if(n instanceof Qe)return rg(t,n._key);throw new Q(x.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ol(n)}.`)}function Hg(t,e){if(!Array.isArray(t)||t.length===0)throw new Q(x.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vT(t,e){const n=(function(r,i){for(const o of r)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null})(t.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Q(x.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q(x.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class PN{convertValue(e,n="none"){switch(er(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Zs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw le(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return ir(e,((r,i)=>{s[r]=this.convertValue(i,n)})),s}convertVectorValue(e){const n=e.fields?.[Lc].arrayValue?.values?.map((s=>Xe(s.doubleValue)));return new Fn(n)}convertGeoPoint(e){return new Ln(Xe(e.latitude),Xe(e.longitude))}convertArray(e,n){return(e.values||[]).map((s=>this.convertValue(s,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const s=Ml(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(Xo(e));default:return null}}convertTimestamp(e){const n=Js(e);return new He(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=Ue.fromString(e);ke(jv(s),9688,{name:e});const r=new Jo(s.get(1),s.get(3)),i=new ne(s.popFirst(5));return r.isEqual(n)||ms(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}function Td(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class vo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Nr extends yT{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new dc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(Yl("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(x.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Nr._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Nr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Nr._jsonSchema={type:tt("string",Nr._jsonSchemaVersion),bundleSource:tt("string","DocumentSnapshot"),bundleName:tt("string"),bundle:tt("string")};class dc extends Nr{data(e={}){return super.data(e)}}class kr{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new vo(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((s=>{e.call(n,new dc(this._firestore,this._userDataWriter,s.key,s,new vo(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Q(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map((a=>{const l=new dc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new vo(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}}))}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((a=>i||a.type!==3)).map((a=>{const l=new dc(r._firestore,r._userDataWriter,a.doc.key,a.doc,new vo(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:NN(a.type),doc:l,oldIndex:u,newIndex:h}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(x.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=kr._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ff.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],s=[],r=[];return this.docs.forEach((i=>{i._document!==null&&(n.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function NN(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return le(61501,{type:t})}}function kN(t){t=Ut(t,Qe);const e=Ut(t.firestore,jn);return _N(Ea(e),t._key).then((n=>TT(e,t,n)))}kr._jsonSchemaVersion="firestore/querySnapshot/1.0",kr._jsonSchema={type:tt("string",kr._jsonSchemaVersion),bundleSource:tt("string","QuerySnapshot"),bundleName:tt("string"),bundle:tt("string")};class Id extends PN{constructor(e){super(),this.firestore=e}convertBytes(e){return new sn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Qe(this.firestore,null,n)}}function zM(t){t=Ut(t,Is);const e=Ut(t.firestore,jn),n=Ea(e),s=new Id(e);return ET(t._query),yN(n,t._query).then((r=>new kr(e,s,t,r)))}function DN(t,e,n){t=Ut(t,Qe);const s=Ut(t.firestore,jn),r=Td(t.converter,e,n);return wa(s,[hd(Ia(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,Bt.none())])}function ON(t,e,n,...s){t=Ut(t,Qe);const r=Ut(t.firestore,jn),i=Ia(r);let o;return o=typeof(e=$e(e))=="string"||e instanceof va?pT(i,"updateDoc",t._key,e,n,s):dT(i,"updateDoc",t._key,e),wa(r,[o.toMutation(t._key,Bt.exists(!0))])}function QM(t){return wa(Ut(t.firestore,jn),[new ql(t._key,Bt.none())])}function YM(t,e){const n=Ut(t.firestore,jn),s=Eo(t),r=Td(t.converter,e);return wa(n,[hd(Ia(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,Bt.exists(!1))]).then((()=>s))}function xN(t,...e){t=$e(t);let n={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||jg(e[s])||(n=e[s++]);const r={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(jg(e[s])){const l=e[s];e[s]=l.next?.bind(l),e[s+1]=l.error?.bind(l),e[s+2]=l.complete?.bind(l)}let i,o,a;if(t instanceof Qe)o=Ut(t.firestore,jn),a=Ll(t._key.path),i={next:l=>{e[s]&&e[s](TT(o,t,l))},error:e[s+1],complete:e[s+2]};else{const l=Ut(t,Is);o=Ut(l.firestore,jn),a=l._query;const u=new Id(o);i={next:h=>{e[s]&&e[s](new kr(o,u,l,h))},error:e[s+1],complete:e[s+2]},ET(t._query)}return(function(u,h,d,m){const g=new ud(m),S=new ad(h,g,d);return u.asyncQueue.enqueueAndForget((async()=>rd(await $c(u),S))),()=>{g.Nu(),u.asyncQueue.enqueueAndForget((async()=>id(await $c(u),S)))}})(Ea(o),a,r,i)}function wa(t,e){return(function(s,r){const i=new os;return s.asyncQueue.enqueueAndForget((async()=>iN(await gN(s),r,i))),i.promise})(Ea(t),e)}function TT(t,e,n){const s=n.docs.get(e._key),r=new Id(t);return new Nr(t,r,e._key,s,new vo(n.hasPendingWrites,n.fromCache),e.converter)}class VN{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Ia(e)}set(e,n,s){this._verifyNotCommitted();const r=zu(e,this._firestore),i=Td(r.converter,n,s),o=hd(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(o.toMutation(r._key,Bt.none())),this}update(e,n,s,...r){this._verifyNotCommitted();const i=zu(e,this._firestore);let o;return o=typeof(n=$e(n))=="string"||n instanceof va?pT(this._dataReader,"WriteBatch.update",i._key,n,s,r):dT(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Bt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=zu(e,this._firestore);return this._mutations=this._mutations.concat(new ql(n._key,Bt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Q(x.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function zu(t,e){if((t=$e(t)).firestore!==e)throw new Q(x.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function XM(){return new fd("serverTimestamp")}function JM(...t){return new dd("arrayUnion",t)}function ZM(t){return Ea(t=Ut(t,jn)),new VN(t,(e=>wa(t,e)))}(function(e,n=!0){(function(r){Di=r})(rr),Ys(new ds("firestore",((s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),a=new jn(new Cb(s.getProvider("auth-internal")),new Pb(o,s.getProvider("app-check-internal")),(function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Q(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jo(u.options.projectId,h)})(o,r),o);return i={useFetchStreams:n,...i},a._setSettings(i),a}),"PUBLIC").setMultipleInstances(!0)),an($m,Gm,e),an($m,Gm,"esm2020")})();function IT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const MN=IT,wT=new fa("auth","Firebase",IT());const Kc=new kl("@firebase/auth");function LN(t,...e){Kc.logLevel<=ge.WARN&&Kc.warn(`Auth (${rr}): ${t}`,...e)}function pc(t,...e){Kc.logLevel<=ge.ERROR&&Kc.error(`Auth (${rr}): ${t}`,...e)}function ln(t,...e){throw Ad(t,...e)}function En(t,...e){return Ad(t,...e)}function wd(t,e,n){const s={...MN(),[e]:n};return new fa("auth","Firebase",s).create(e,{appName:t.name})}function as(t){return wd(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function FN(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&ln(t,"argument-error"),wd(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ad(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return wT.create(t,...e)}function ce(t,e,...n){if(!t)throw Ad(e,...n)}function ts(t){const e="INTERNAL ASSERTION FAILED: "+t;throw pc(e),new Error(e)}function _s(t,e){t||ts(e)}function Gh(){return typeof self<"u"&&self.location?.href||""}function UN(){return Wg()==="http:"||Wg()==="https:"}function Wg(){return typeof self<"u"&&self.location?.protocol||null}function BN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(UN()||XC()||"connection"in navigator)?navigator.onLine:!0}function jN(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class Aa{constructor(e,n){this.shortDelay=e,this.longDelay=n,_s(n>e,"Short delay should be less than long delay!"),this.isMobile=Vf()||UE()}get(){return BN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Rd(t,e){_s(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class AT{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ts("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ts("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ts("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const qN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const HN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],WN=new Aa(3e4,6e4);function ar(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function cr(t,e,n,s,r={}){return RT(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=ki({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u={method:e,headers:l,...i};return YC()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&vs(t.emulatorConfig.host)&&(u.credentials="include"),AT.fetch()(await CT(t,t.config.apiHost,n,a),u)})}async function RT(t,e,n){t._canInitEmulator=!1;const s={...qN,...e};try{const r=new GN(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ja(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ja(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Ja(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Ja(t,"user-disabled",o);const h=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw wd(t,h,u);ln(t,h)}}catch(r){if(r instanceof Hn)throw r;ln(t,"network-request-failed",{message:String(r)})}}async function Ra(t,e,n,s,r={}){const i=await cr(t,e,n,s,r);return"mfaPendingCredential"in i&&ln(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function CT(t,e,n,s){const r=`${e}${n}?${s}`,i=t,o=i.config.emulator?Rd(t.config,r):`${t.config.apiScheme}://${r}`;return HN.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function $N(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(En(this.auth,"network-request-failed")),WN.get())})}}function Ja(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=En(t,e,s);return r.customData._tokenResponse=n,r}function $g(t){return t!==void 0&&t.enterprise!==void 0}class KN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return $N(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function zN(t,e){return cr(t,"GET","/v2/recaptchaConfig",ar(t,e))}async function QN(t,e){return cr(t,"POST","/v1/accounts:delete",e)}async function zc(t,e){return cr(t,"POST","/v1/accounts:lookup",e)}function xo(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function YN(t,e=!1){const n=$e(t),s=await n.getIdToken(e),r=Cd(s);ce(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i?.sign_in_provider;return{claims:r,token:s,authTime:xo(Qu(r.auth_time)),issuedAtTime:xo(Qu(r.iat)),expirationTime:xo(Qu(r.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function Qu(t){return Number(t)*1e3}function Cd(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return pc("JWT malformed, contained fewer than 3 sections"),null;try{const r=Dc(n);return r?JSON.parse(r):(pc("Failed to decode base64 JWT payload"),null)}catch(r){return pc("Caught error parsing JWT payload as JSON",r?.toString()),null}}function Gg(t){const e=Cd(t);return ce(e,"internal-error"),ce(typeof e.exp<"u","internal-error"),ce(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function sa(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Hn&&XN(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function XN({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class JN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Kh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=xo(this.lastLoginAt),this.creationTime=xo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Qc(t){const e=t.auth,n=await t.getIdToken(),s=await sa(t,zc(e,{idToken:n}));ce(s?.users.length,e,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const i=r.providerUserInfo?.length?ST(r.providerUserInfo):[],o=ek(t.providerData,i),a=t.isAnonymous,l=!(t.email&&r.passwordHash)&&!o?.length,u=a?l:!1,h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Kh(r.createdAt,r.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function ZN(t){const e=$e(t);await Qc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ek(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function ST(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function tk(t,e){const n=await RT(t,{},async()=>{const s=ki({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=await CT(t,r,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:s};return t.emulatorConfig&&vs(t.emulatorConfig.host)&&(l.credentials="include"),AT.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function nk(t,e){return cr(t,"POST","/v2/accounts:revokeToken",ar(t,e))}class fi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ce(e.idToken,"internal-error"),ce(typeof e.idToken<"u","internal-error"),ce(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Gg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ce(e.length!==0,"internal-error");const n=Gg(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ce(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await tk(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new fi;return s&&(ce(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(ce(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(ce(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fi,this.toJSON())}_performRefresh(){return ts("not implemented")}}function Ns(t,e){ce(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class mn{constructor({uid:e,auth:n,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new JN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Kh(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await sa(this,this.stsTokenManager.getToken(this.auth,e));return ce(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return YN(this,e)}reload(){return ZN(this)}_assign(e){this!==e&&(ce(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new mn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Qc(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ft(this.auth.app))return Promise.reject(as(this.auth));const e=await this.getIdToken();return await sa(this,QN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,r=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,l=n._redirectEventId??void 0,u=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:d,emailVerified:m,isAnonymous:g,providerData:S,stsTokenManager:P}=n;ce(d&&P,e,"internal-error");const N=fi.fromJSON(this.name,P);ce(typeof d=="string",e,"internal-error"),Ns(s,e.name),Ns(r,e.name),ce(typeof m=="boolean",e,"internal-error"),ce(typeof g=="boolean",e,"internal-error"),Ns(i,e.name),Ns(o,e.name),Ns(a,e.name),Ns(l,e.name),Ns(u,e.name),Ns(h,e.name);const O=new mn({uid:d,auth:e,email:r,emailVerified:m,displayName:s,isAnonymous:g,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:N,createdAt:u,lastLoginAt:h});return S&&Array.isArray(S)&&(O.providerData=S.map(B=>({...B}))),l&&(O._redirectEventId=l),O}static async _fromIdTokenResponse(e,n,s=!1){const r=new fi;r.updateFromServerResponse(n);const i=new mn({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await Qc(i),i}static async _fromGetAccountInfoResponse(e,n,s){const r=n.users[0];ce(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?ST(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!i?.length,a=new fi;a.updateFromIdToken(s);const l=new mn({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Kh(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!i?.length};return Object.assign(l,u),l}}const Kg=new Map;function ns(t){_s(t instanceof Function,"Expected a class definition");let e=Kg.get(t);return e?(_s(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Kg.set(t,e),e)}class bT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}bT.type="NONE";const zg=bT;function mc(t,e,n){return`firebase:${t}:${e}:${n}`}class di{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=mc(this.userKey,r.apiKey,i),this.fullPersistenceKey=mc("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await zc(this.auth,{idToken:e}).catch(()=>{});return n?mn._fromGetAccountInfoResponse(this.auth,n,e):null}return mn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new di(ns(zg),e,s);const r=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=r[0]||ns(zg);const o=mc(s,e.config.apiKey,e.name);let a=null;for(const u of n)try{const h=await u._get(o);if(h){let d;if(typeof h=="string"){const m=await zc(e,{idToken:h}).catch(()=>{});if(!m)break;d=await mn._fromGetAccountInfoResponse(e,m,h)}else d=mn._fromJSON(e,h);u!==i&&(a=d),i=u;break}}catch{}const l=r.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new di(i,e,s):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new di(i,e,s))}}function Qg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(DT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(PT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(xT(e))return"Blackberry";if(VT(e))return"Webos";if(NT(e))return"Safari";if((e.includes("chrome/")||kT(e))&&!e.includes("edge/"))return"Chrome";if(OT(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if(s?.length===2)return s[1]}return"Other"}function PT(t=Ot()){return/firefox\//i.test(t)}function NT(t=Ot()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function kT(t=Ot()){return/crios\//i.test(t)}function DT(t=Ot()){return/iemobile/i.test(t)}function OT(t=Ot()){return/android/i.test(t)}function xT(t=Ot()){return/blackberry/i.test(t)}function VT(t=Ot()){return/webos/i.test(t)}function Sd(t=Ot()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function sk(t=Ot()){return Sd(t)&&!!window.navigator?.standalone}function rk(){return JC()&&document.documentMode===10}function MT(t=Ot()){return Sd(t)||OT(t)||VT(t)||xT(t)||/windows phone/i.test(t)||DT(t)}function LT(t,e=[]){let n;switch(t){case"Browser":n=Qg(Ot());break;case"Worker":n=`${Qg(Ot())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${rr}/${s}`}class ik{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function ok(t,e={}){return cr(t,"GET","/v2/passwordPolicy",ar(t,e))}const ak=6;class ck{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??ak,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class lk{constructor(e,n,s,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Yg(this),this.idTokenSubscription=new Yg(this),this.beforeStateQueue=new ik(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ns(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await di.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await zc(this,{idToken:e}),s=await mn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ft(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=s?._redirectEventId,a=await this.tryRedirectSignIn(e);(!i||i===o)&&a?.user&&(s=a.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ce(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Qc(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=jN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ft(this.app))return Promise.reject(as(this));const n=e?$e(e):null;return n&&ce(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ce(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ft(this.app)?Promise.reject(as(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ft(this.app)?Promise.reject(as(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ns(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ok(this),n=new ck(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new fa("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await nk(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ns(e)||this._popupRedirectResolver;ce(n,this,"argument-error"),this.redirectPersistenceManager=await di.create(this,[ns(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ce(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,s,r);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=LT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(Ft(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&LN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function lr(t){return $e(t)}class Yg{constructor(e){this.auth=e,this.observer=null,this.addObserver=lS(n=>this.observer=n)}get next(){return ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Jl={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uk(t){Jl=t}function FT(t){return Jl.loadJS(t)}function hk(){return Jl.recaptchaEnterpriseScript}function fk(){return Jl.gapiScript}function dk(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class pk{constructor(){this.enterprise=new mk}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class mk{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const gk="recaptcha-enterprise",UT="NO_RECAPTCHA";class _k{constructor(e){this.type=gk,this.auth=lr(e)}async verify(e="verify",n=!1){async function s(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{zN(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new KN(l);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function r(i,o,a){const l=window.grecaptcha;$g(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(UT)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new pk().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{s(this.auth).then(a=>{if(!n&&$g(window.grecaptcha))r(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=hk();l.length!==0&&(l+=a),FT(l).then(()=>{r(a,i,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function Xg(t,e,n,s=!1,r=!1){const i=new _k(t);let o;if(r)o=UT;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return s?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function zh(t,e,n,s,r){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Xg(t,e,n,n==="getOobCode");return s(t,i)}else return s(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Xg(t,e,n,n==="getOobCode");return s(t,o)}else return Promise.reject(i)})}function yk(t,e){const n=da(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(fs(i,e??{}))return r;ln(r,"already-initialized")}return n.initialize({options:e})}function Ek(t,e){const n=e?.persistence||[],s=(Array.isArray(n)?n:[n]).map(ns);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e?.popupRedirectResolver)}function vk(t,e,n){const s=lr(t);ce(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=BT(e),{host:o,port:a}=Tk(e),l=a===null?"":`:${a}`,u={url:`${i}//${o}${l}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){ce(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),ce(fs(u,s.config.emulator)&&fs(h,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=u,s.emulatorConfig=h,s.settings.appVerificationDisabledForTesting=!0,vs(o)?(bl(`${i}//${o}${l}`),Pl("Auth",!0)):Ik()}function BT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Tk(t){const e=BT(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:Jg(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:Jg(o)}}}function Jg(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Ik(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class bd{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ts("not implemented")}_getIdTokenResponse(e){return ts("not implemented")}_linkToIdToken(e,n){return ts("not implemented")}_getReauthenticationResolver(e){return ts("not implemented")}}async function wk(t,e){return cr(t,"POST","/v1/accounts:signUp",e)}async function Ak(t,e){return Ra(t,"POST","/v1/accounts:signInWithPassword",ar(t,e))}async function Rk(t,e){return Ra(t,"POST","/v1/accounts:signInWithEmailLink",ar(t,e))}async function Ck(t,e){return Ra(t,"POST","/v1/accounts:signInWithEmailLink",ar(t,e))}class ra extends bd{constructor(e,n,s,r=null){super("password",s),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new ra(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new ra(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zh(e,n,"signInWithPassword",Ak);case"emailLink":return Rk(e,{email:this._email,oobCode:this._password});default:ln(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zh(e,s,"signUpPassword",wk);case"emailLink":return Ck(e,{idToken:n,email:this._email,oobCode:this._password});default:ln(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function pi(t,e){return Ra(t,"POST","/v1/accounts:signInWithIdp",ar(t,e))}const Sk="http://localhost";class xr extends bd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new xr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ln("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...i}=n;if(!s||!r)return null;const o=new xr(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return pi(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,pi(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,pi(e,n)}buildRequest(){const e={requestUri:Sk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ki(n)}return e}}function bk(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Pk(t){const e=po(mo(t)).link,n=e?po(mo(e)).deep_link_id:null,s=po(mo(t)).deep_link_id;return(s?po(mo(s)).link:null)||s||n||e||t}class Pd{constructor(e){const n=po(mo(e)),s=n.apiKey??null,r=n.oobCode??null,i=bk(n.mode??null);ce(s&&r&&i,"argument-error"),this.apiKey=s,this.operation=i,this.code=r,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Pk(e);try{return new Pd(n)}catch{return null}}}class Fi{constructor(){this.providerId=Fi.PROVIDER_ID}static credential(e,n){return ra._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=Pd.parseLink(n);return ce(s,"argument-error"),ra._fromEmailAndCode(e,s.code,s.tenantId)}}Fi.PROVIDER_ID="password";Fi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Fi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Nd{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ca extends Nd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ls extends Ca{constructor(){super("facebook.com")}static credential(e){return xr._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ls.credential(e.oauthAccessToken)}catch{return null}}}Ls.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ls.PROVIDER_ID="facebook.com";class es extends Ca{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return xr._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return es.credential(n,s)}catch{return null}}}es.GOOGLE_SIGN_IN_METHOD="google.com";es.PROVIDER_ID="google.com";class Fs extends Ca{constructor(){super("github.com")}static credential(e){return xr._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fs.credentialFromTaggedObject(e)}static credentialFromError(e){return Fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fs.credential(e.oauthAccessToken)}catch{return null}}}Fs.GITHUB_SIGN_IN_METHOD="github.com";Fs.PROVIDER_ID="github.com";class Us extends Ca{constructor(){super("twitter.com")}static credential(e,n){return xr._fromParams({providerId:Us.PROVIDER_ID,signInMethod:Us.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Us.credentialFromTaggedObject(e)}static credentialFromError(e){return Us.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Us.credential(n,s)}catch{return null}}}Us.TWITTER_SIGN_IN_METHOD="twitter.com";Us.PROVIDER_ID="twitter.com";async function Nk(t,e){return Ra(t,"POST","/v1/accounts:signUp",ar(t,e))}class Vr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await mn._fromIdTokenResponse(e,s,r),o=Zg(s);return new Vr({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=Zg(s);return new Vr({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function Zg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Yc extends Hn{constructor(e,n,s,r){super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,Yc.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new Yc(e,n,s,r)}}function jT(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Yc._fromErrorAndOperation(t,i,e,s):i})}async function kk(t,e,n=!1){const s=await sa(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Vr._forOperation(t,"link",s)}async function Dk(t,e,n=!1){const{auth:s}=t;if(Ft(s.app))return Promise.reject(as(s));const r="reauthenticate";try{const i=await sa(t,jT(s,r,e,t),n);ce(i.idToken,s,"internal-error");const o=Cd(i.idToken);ce(o,s,"internal-error");const{sub:a}=o;return ce(t.uid===a,s,"user-mismatch"),Vr._forOperation(t,r,i)}catch(i){throw i?.code==="auth/user-not-found"&&ln(s,"user-mismatch"),i}}async function qT(t,e,n=!1){if(Ft(t.app))return Promise.reject(as(t));const s="signIn",r=await jT(t,s,e),i=await Vr._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}async function Ok(t,e){return qT(lr(t),e)}async function HT(t){const e=lr(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function xk(t,e,n){if(Ft(t.app))return Promise.reject(as(t));const s=lr(t),o=await zh(s,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Nk).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&HT(t),l}),a=await Vr._fromIdTokenResponse(s,"signIn",o);return await s._updateCurrentUser(a.user),a}function Vk(t,e,n){return Ft(t.app)?Promise.reject(as(t)):Ok($e(t),Fi.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&HT(t),s})}function Mk(t,e,n,s){return $e(t).onIdTokenChanged(e,n,s)}function Lk(t,e,n){return $e(t).beforeAuthStateChanged(e,n)}function Fk(t,e,n,s){return $e(t).onAuthStateChanged(e,n,s)}function Uk(t){return $e(t).signOut()}const Xc="__sak";class WT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Xc,"1"),this.storage.removeItem(Xc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Bk=1e3,jk=10;class $T extends WT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=MT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const s=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);rk()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,jk):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},Bk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}$T.type="LOCAL";const qk=$T;class GT extends WT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}GT.type="SESSION";const KT=GT;function Hk(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class Zl{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new Zl(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async u=>u(n.origin,i)),l=await Hk(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Zl.receivers=[];function kd(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}class Wk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const u=kd("",20);r.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(d){const m=d;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(m.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Un(){return window}function $k(t){Un().location.href=t}function zT(){return typeof Un().WorkerGlobalScope<"u"&&typeof Un().importScripts=="function"}async function Gk(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Kk(){return navigator?.serviceWorker?.controller||null}function zk(){return zT()?self:null}const QT="firebaseLocalStorageDb",Qk=1,Jc="firebaseLocalStorage",YT="fbase_key";class Sa{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function eu(t,e){return t.transaction([Jc],e?"readwrite":"readonly").objectStore(Jc)}function Yk(){const t=indexedDB.deleteDatabase(QT);return new Sa(t).toPromise()}function Qh(){const t=indexedDB.open(QT,Qk);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(Jc,{keyPath:YT})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(Jc)?e(s):(s.close(),await Yk(),e(await Qh()))})})}async function e_(t,e,n){const s=eu(t,!0).put({[YT]:e,value:n});return new Sa(s).toPromise()}async function Xk(t,e){const n=eu(t,!1).get(e),s=await new Sa(n).toPromise();return s===void 0?null:s.value}function t_(t,e){const n=eu(t,!0).delete(e);return new Sa(n).toPromise()}const Jk=800,Zk=3;class XT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Qh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>Zk)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return zT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Zl._getInstance(zk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Gk(),!this.activeServiceWorker)return;this.sender=new Wk(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Kk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Qh();return await e_(e,Xc,"1"),await t_(e,Xc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>e_(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>Xk(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>t_(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=eu(r,!1).getAll();return new Sa(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Jk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}XT.type="LOCAL";const eD=XT;new Aa(3e4,6e4);function JT(t,e){return e?ns(e):(ce(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class Dd extends bd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return pi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return pi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return pi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function tD(t){return qT(t.auth,new Dd(t),t.bypassAuthState)}function nD(t){const{auth:e,user:n}=t;return ce(n,e,"internal-error"),Dk(n,new Dd(t),t.bypassAuthState)}async function sD(t){const{auth:e,user:n}=t;return ce(n,e,"internal-error"),kk(n,new Dd(t),t.bypassAuthState)}class ZT{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tD;case"linkViaPopup":case"linkViaRedirect":return sD;case"reauthViaPopup":case"reauthViaRedirect":return nD;default:ln(this.auth,"internal-error")}}resolve(e){_s(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_s(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const rD=new Aa(2e3,1e4);async function iD(t,e,n){if(Ft(t.app))return Promise.reject(En(t,"operation-not-supported-in-this-environment"));const s=lr(t);FN(t,e,Nd);const r=JT(s,n);return new Rr(s,"signInViaPopup",e,r).executeNotNull()}class Rr extends ZT{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,Rr.currentPopupAction&&Rr.currentPopupAction.cancel(),Rr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ce(e,this.auth,"internal-error"),e}async onExecution(){_s(this.filter.length===1,"Popup operations only handle one event");const e=kd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(En(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(En(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Rr.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(En(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,rD.get())};e()}}Rr.currentPopupAction=null;const oD="pendingRedirect",gc=new Map;class aD extends ZT{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=gc.get(this.auth._key());if(!e){try{const s=await cD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}gc.set(this.auth._key(),e)}return this.bypassAuthState||gc.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function cD(t,e){const n=hD(e),s=uD(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}function lD(t,e){gc.set(t._key(),e)}function uD(t){return ns(t._redirectPersistence)}function hD(t){return mc(oD,t.config.apiKey,t.name)}async function fD(t,e,n=!1){if(Ft(t.app))return Promise.reject(as(t));const s=lr(t),r=JT(s,e),o=await new aD(s,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}const dD=600*1e3;class pD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!mD(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!eI(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";n.onError(En(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=dD&&this.cachedEventUids.clear(),this.cachedEventUids.has(n_(e))}saveEventToCache(e){this.cachedEventUids.add(n_(e)),this.lastProcessedEventTime=Date.now()}}function n_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function eI({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function mD(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eI(t);default:return!1}}async function gD(t,e={}){return cr(t,"GET","/v1/projects",e)}const _D=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yD=/^https?/;async function ED(t){if(t.config.emulator)return;const{authorizedDomains:e}=await gD(t);for(const n of e)try{if(vD(n))return}catch{}ln(t,"unauthorized-domain")}function vD(t){const e=Gh(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!yD.test(n))return!1;if(_D.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}const TD=new Aa(3e4,6e4);function s_(){const t=Un().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function ID(t){return new Promise((e,n)=>{function s(){s_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{s_(),n(En(t,"network-request-failed"))},timeout:TD.get()})}if(Un().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Un().gapi?.load)s();else{const r=dk("iframefcb");return Un()[r]=()=>{gapi.load?s():n(En(t,"network-request-failed"))},FT(`${fk()}?onload=${r}`).catch(i=>n(i))}}).catch(e=>{throw _c=null,e})}let _c=null;function wD(t){return _c=_c||ID(t),_c}const AD=new Aa(5e3,15e3),RD="__/auth/iframe",CD="emulator/auth/iframe",SD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},bD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function PD(t){const e=t.config;ce(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Rd(e,CD):`https://${t.config.authDomain}/${RD}`,s={apiKey:e.apiKey,appName:t.name,v:rr},r=bD.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${ki(s).slice(1)}`}async function ND(t){const e=await wD(t),n=Un().gapi;return ce(n,t,"internal-error"),e.open({where:document.body,url:PD(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:SD,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=En(t,"network-request-failed"),a=Un().setTimeout(()=>{i(o)},AD.get());function l(){Un().clearTimeout(a),r(s)}s.ping(l).then(l,()=>{i(o)})}))}const kD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DD=500,OD=600,xD="_blank",VD="http://localhost";class r_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function MD(t,e,n,s=DD,r=OD){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const l={...kD,width:s.toString(),height:r.toString(),top:i,left:o},u=Ot().toLowerCase();n&&(a=kT(u)?xD:n),PT(u)&&(e=e||VD,l.scrollbars="yes");const h=Object.entries(l).reduce((m,[g,S])=>`${m}${g}=${S},`,"");if(sk(u)&&a!=="_self")return LD(e||"",a),new r_(null);const d=window.open(e||"",a,h);ce(d,t,"popup-blocked");try{d.focus()}catch{}return new r_(d)}function LD(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}const FD="__/auth/handler",UD="emulator/auth/handler",BD=encodeURIComponent("fac");async function i_(t,e,n,s,r,i){ce(t.config.authDomain,t,"auth-domain-config-required"),ce(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:rr,eventId:r};if(e instanceof Nd){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Ih(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries({}))o[h]=d}if(e instanceof Ca){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await t._getAppCheckToken(),u=l?`#${BD}=${encodeURIComponent(l)}`:"";return`${jD(t)}?${ki(a).slice(1)}${u}`}function jD({config:t}){return t.emulator?Rd(t,UD):`https://${t.authDomain}/${FD}`}const Yu="webStorageSupport";class qD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=KT,this._completeRedirectFn=fD,this._overrideRedirectResult=lD}async _openPopup(e,n,s,r){_s(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await i_(e,n,s,Gh(),r);return MD(e,i,kd())}async _openRedirect(e,n,s,r){await this._originValidation(e);const i=await i_(e,n,s,Gh(),r);return $k(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(_s(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await ND(e),s=new pD(e);return n.register("authEvent",r=>(ce(r?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Yu,{type:Yu},r=>{const i=r?.[0]?.[Yu];i!==void 0&&n(!!i),ln(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=ED(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return MT()||NT()||Sd()}}const HD=qD;var o_="@firebase/auth",a_="1.11.1";class WD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function $D(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function GD(t){Ys(new ds("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=s.options;ce(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:LT(t)},u=new lk(s,r,i,l);return Ek(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),Ys(new ds("auth-internal",e=>{const n=lr(e.getProvider("auth").getImmediate());return(s=>new WD(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),an(o_,a_,$D(t)),an(o_,a_,"esm2020")}const KD=300,zD=FE("authIdTokenMaxAge")||KD;let c_=null;const QD=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>zD)return;const r=n?.token;c_!==r&&(c_=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function YD(t=Dl()){const e=da(t,"auth");if(e.isInitialized())return e.getImmediate();const n=yk(t,{popupRedirectResolver:HD,persistence:[eD,qk,KT]}),s=FE("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=QD(i.toString());Lk(n,o,()=>o(n.currentUser)),Mk(n,a=>o(a))}}const r=ME("auth");return r&&vk(n,`http://${r}`),n}function XD(){return document.getElementsByTagName("head")?.[0]??document}uk({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=En("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",XD().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});GD("Browser");var l_={};const u_="@firebase/database",h_="1.1.0";let tI="";function JD(t){tI=t}class ZD{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),gt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:zo(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class eO{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Ts(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const nI=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new ZD(e)}}catch{}return new eO},Cr=nI("localStorage"),tO=nI("sessionStorage");const mi=new kl("@firebase/database"),nO=(function(){let t=1;return function(){return t++}})(),sI=function(t){const e=dS(t),n=new cS;n.update(e);const s=n.digest();return kf.encodeByteArray(s)},ba=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=ba.apply(null,s):typeof s=="object"?e+=gt(s):e+=s,e+=" "}return e};let Vo=null,f_=!0;const sO=function(t,e){z(!0,"Can't turn on custom loggers persistently."),mi.logLevel=ge.VERBOSE,Vo=mi.log.bind(mi)},bt=function(...t){if(f_===!0&&(f_=!1,Vo===null&&tO.get("logging_enabled")===!0&&sO()),Vo){const e=ba.apply(null,t);Vo(e)}},Pa=function(t){return function(...e){bt(t,...e)}},Yh=function(...t){const e="FIREBASE INTERNAL ERROR: "+ba(...t);mi.error(e)},ys=function(...t){const e=`FIREBASE FATAL ERROR: ${ba(...t)}`;throw mi.error(e),new Error(e)},tn=function(...t){const e="FIREBASE WARNING: "+ba(...t);mi.warn(e)},rO=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&tn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},rI=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},iO=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Ci="[MIN_NAME]",Mr="[MAX_NAME]",Ui=function(t,e){if(t===e)return 0;if(t===Ci||e===Mr)return-1;if(e===Ci||t===Mr)return 1;{const n=d_(t),s=d_(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},oO=function(t,e){return t===e?0:t<e?-1:1},io=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+gt(e))},Od=function(t){if(typeof t!="object"||t===null)return gt(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=gt(e[s]),n+=":",n+=Od(t[e[s]]);return n+="}",n},iI=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let r=0;r<n;r+=e)r+e>n?s.push(t.substring(r,n)):s.push(t.substring(r,r+e));return s};function un(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const oI=function(t){z(!rI(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let r,i,o,a,l;t===0?(i=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),i=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-s-n))));const u=[];for(l=n;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)u.push(i%2?1:0),i=Math.floor(i/2);u.push(r?1:0),u.reverse();const h=u.join("");let d="";for(l=0;l<64;l+=8){let m=parseInt(h.substr(l,8),2).toString(16);m.length===1&&(m="0"+m),d=d+m}return d.toLowerCase()},aO=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},cO=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},lO=new RegExp("^-?(0*)\\d{1,10}$"),uO=-2147483648,hO=2147483647,d_=function(t){if(lO.test(t)){const e=Number(t);if(e>=uO&&e<=hO)return e}return null},Na=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw tn("Exception was thrown by user callback.",n),e},Math.floor(0))}},fO=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Mo=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};class dO{constructor(e,n){this.appCheckProvider=n,this.appName=e.name,Ft(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(s=>this.appCheck=s)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.appCheckProvider?.get().then(n=>n.addTokenListener(e))}notifyForInvalidToken(){tn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}class pO{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(bt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',tn(e)}}class yc{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}yc.OWNER="owner";const xd="5",aI="v",cI="s",lI="r",uI="f",hI=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,fI="ls",dI="p",Xh="ac",pI="websocket",mI="long_polling";class gI{constructor(e,n,s,r,i=!1,o="",a=!1,l=!1,u=null){this.secure=n,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Cr.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Cr.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function mO(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function _I(t,e,n){z(typeof e=="string","typeof type must == string"),z(typeof n=="object","typeof params must == object");let s;if(e===pI)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===mI)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);mO(t)&&(n.ns=t.namespace);const r=[];return un(n,(i,o)=>{r.push(i+"="+o)}),s+r.join("&")}class gO{constructor(){this.counters_={}}incrementCounter(e,n=1){Ts(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return jC(this.counters_)}}const Xu={},Ju={};function Vd(t){const e=t.toString();return Xu[e]||(Xu[e]=new gO),Xu[e]}function _O(t,e){const n=t.toString();return Ju[n]||(Ju[n]=e()),Ju[n]}class yO{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&Na(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const p_="start",EO="close",vO="pLPCommand",TO="pRTLPCB",yI="id",EI="pw",vI="ser",IO="cb",wO="seg",AO="ts",RO="d",CO="dframe",TI=1870,II=30,SO=TI-II,bO=25e3,PO=3e4;class si{constructor(e,n,s,r,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Pa(e),this.stats_=Vd(n),this.urlFn=l=>(this.appCheckToken&&(l[Xh]=this.appCheckToken),_I(n,mI,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new yO(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(PO)),iO(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Md((...i)=>{const[o,a,l,u,h]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===p_)this.id=a,this.password=l;else if(o===EO)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[p_]="t",s[vI]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[IO]=this.scriptTagHolder.uniqueCallbackIdentifier),s[aI]=xd,this.transportSessionId&&(s[cI]=this.transportSessionId),this.lastSessionId&&(s[fI]=this.lastSessionId),this.applicationId&&(s[dI]=this.applicationId),this.appCheckToken&&(s[Xh]=this.appCheckToken),typeof location<"u"&&location.hostname&&hI.test(location.hostname)&&(s[lI]=uI);const r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){si.forceAllow_=!0}static forceDisallow(){si.forceDisallow_=!0}static isAvailable(){return si.forceAllow_?!0:!si.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!aO()&&!cO()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=gt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=xE(n),r=iI(s,SO);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[CO]="t",s[yI]=e,s[EI]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=gt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Md{constructor(e,n,s,r){this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=nO(),window[vO+this.uniqueCallbackIdentifier]=e,window[TO+this.uniqueCallbackIdentifier]=n,this.myIFrame=Md.createIFrame_();let i="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(i='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){bt("frame writing exception"),a.stack&&bt(a.stack),bt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||bt("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[yI]=this.myID,e[EI]=this.myPW,e[vI]=this.currentSerial;let n=this.urlFn(e),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+II+s.length<=TI;){const o=this.pendingSegs.shift();s=s+"&"+wO+r+"="+o.seg+"&"+AO+r+"="+o.ts+"&"+RO+r+"="+o.d,r++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(s,Math.floor(bO)),i=()=>{clearTimeout(r),s()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const r=s.readyState;(!r||r==="loaded"||r==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{bt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}const NO=16384,kO=45e3;let Zc=null;typeof MozWebSocket<"u"?Zc=MozWebSocket:typeof WebSocket<"u"&&(Zc=WebSocket);class pn{constructor(e,n,s,r,i,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Pa(this.connId),this.stats_=Vd(n),this.connURL=pn.connectionURL_(n,o,a,r,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,r,i){const o={};return o[aI]=xd,typeof location<"u"&&location.hostname&&hI.test(location.hostname)&&(o[lI]=uI),n&&(o[cI]=n),s&&(o[fI]=s),r&&(o[Xh]=r),i&&(o[dI]=i),_I(e,pI,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Cr.set("previous_websocket_failure",!0);try{let s;ZC(),this.mySock=new Zc(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){pn.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&Zc!==null&&!pn.forceDisallow_}static previouslyFailed(){return Cr.isInMemoryStorage||Cr.get("previous_websocket_failure")===!0}markConnectionHealthy(){Cr.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=zo(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(z(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=gt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=iI(n,NO);s.length>1&&this.sendString_(String(s.length));for(let r=0;r<s.length;r++)this.sendString_(s[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(kO))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}pn.responsesRequiredToBeHealthy=2;pn.healthyTimeout=3e4;class ia{static get ALL_TRANSPORTS(){return[si,pn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const n=pn&&pn.isAvailable();let s=n&&!pn.previouslyFailed();if(e.webSocketOnly&&(n||tn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[pn];else{const r=this.transports_=[];for(const i of ia.ALL_TRANSPORTS)i&&i.isAvailable()&&r.push(i);ia.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ia.globalTransportInitialized_=!1;const DO=6e4,OO=5e3,xO=10*1024,VO=100*1024,Zu="t",m_="d",MO="s",g_="r",LO="e",__="o",y_="a",E_="n",v_="p",FO="h";class UO{constructor(e,n,s,r,i,o,a,l,u,h){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Pa("c:"+this.id+":"),this.transportManager_=new ia(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Mo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>VO?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>xO?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Zu in e){const n=e[Zu];n===y_?this.upgradeIfSecondaryHealthy_():n===g_?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===__&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=io("t",e),s=io("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:v_,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:y_,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:E_,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=io("t",e),s=io("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=io(Zu,e);if(m_ in e){const s=e[m_];if(n===FO){const r={...s};this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(n===E_){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===MO?this.onConnectionShutdown_(s):n===g_?this.onReset_(s):n===LO?Yh("Server Error: "+s):n===__?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Yh("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),xd!==s&&tn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),Mo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(DO))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Mo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(OO))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:v_,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Cr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class wI{put(e,n,s,r){}merge(e,n,s,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}class AI{constructor(e){this.allowedEvents_=e,this.listeners_={},z(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const r=this.getInitialEvent(e);r&&n.apply(s,r)}off(e,n,s){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===n&&(!s||s===r[i].context)){r.splice(i,1);return}}validateEventType_(e){z(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}class el extends AI{static getInstance(){return new el}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Vf()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return z(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const T_=32,I_=768;class We{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function xe(){return new We("")}function Ae(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function sr(t){return t.pieces_.length-t.pieceNum_}function qe(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new We(t.pieces_,e)}function RI(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function BO(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function CI(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function SI(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new We(e,0)}function ft(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof We)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&n.push(s[r])}return new We(n,0)}function Ie(t){return t.pieceNum_>=t.pieces_.length}function rn(t,e){const n=Ae(t),s=Ae(e);if(n===null)return e;if(n===s)return rn(qe(t),qe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function bI(t,e){if(sr(t)!==sr(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function gn(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(sr(t)>sr(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class jO{constructor(e,n){this.errorPrefix_=n,this.parts_=CI(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Nl(this.parts_[s]);PI(this)}}function qO(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Nl(e),PI(t)}function HO(t){const e=t.parts_.pop();t.byteLength_-=Nl(e),t.parts_.length>0&&(t.byteLength_-=1)}function PI(t){if(t.byteLength_>I_)throw new Error(t.errorPrefix_+"has a key path longer than "+I_+" bytes ("+t.byteLength_+").");if(t.parts_.length>T_)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+T_+") or object contains a cycle "+Tr(t))}function Tr(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}class Ld extends AI{static getInstance(){return new Ld}constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}getInitialEvent(e){return z(e==="visible","Unknown event type: "+e),[this.visible_]}}const oo=1e3,WO=300*1e3,w_=30*1e3,$O=1.3,GO=3e4,KO="server_kill",A_=3;class cs extends wI{constructor(e,n,s,r,i,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=cs.nextPersistentConnectionId_++,this.log_=Pa("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=oo,this.maxReconnectDelay_=WO,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Ld.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&el.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const r=++this.requestNumber_,i={r,a:e,b:n};this.log_(gt(i)),z(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),s&&(this.requestCBHash_[r]=s)}get(e){this.initConnection_();const n=new Of,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),n.promise}listen(e,n,s,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),z(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),z(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:e,tag:s};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+s+" for "+r);const i={p:s},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const l=a.d,u=a.s;cs.warnOnListenWarnings_(l,n),(this.listens.get(s)&&this.listens.get(s).get(r))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(s,r),e.onComplete&&e.onComplete(u,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Ts(e,"w")){const s=yi(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();tn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||aS(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=w_)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=oS(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,r=>{const i=r.s,o=r.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+r),z(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,r)&&this.connected_&&this.sendUnlisten_(s,r,e._queryObject,n)}sendUnlisten_(e,n,s,r){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";r&&(i.q=s,i.t=r),this.sendRequest(o,i)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,r){const i={p:n,d:s};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,n,s,r){this.putInternal("p",e,n,s,r)}merge(e,n,s,r){this.putInternal("m",e,n,s,r)}putInternal(e,n,s,r,i){this.initConnection_();const o={p:n,d:s};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const i=s.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+gt(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Yh("Unrecognized action received from server: "+gt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){z(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=oo,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=oo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>GO&&(this.reconnectDelay_=oo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*$O)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+cs.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,s())},u=function(d){z(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:l,sendRequest:u};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,m]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?bt("getToken() completed but was canceled"):(bt("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=m&&m.token,a=new UO(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,g=>{tn(g+" ("+this.repoInfo_.toString()+")"),this.interrupt(KO)},i))}catch(d){this.log_("Failed to get token: "+d),o||(this.repoInfo_.nodeAdmin&&tn(d),l())}}}interrupt(e){bt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){bt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Ih(this.interruptReasons_)&&(this.reconnectDelay_=oo,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(i=>Od(i)).join("$"):s="default";const r=this.removeListen_(e,s);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,n){const s=new We(e).toString();let r;if(this.listens.has(s)){const i=this.listens.get(s);r=i.get(n),i.delete(n),i.size===0&&this.listens.delete(s)}else r=void 0;return r}onAuthRevoked_(e,n){bt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=A_&&(this.reconnectDelay_=w_,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){bt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=A_&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+tI.replace(/\./g,"-")]=1,Vf()?e["framework.cordova"]=1:UE()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=el.getInstance().currentlyOnline();return Ih(this.interruptReasons_)&&e}}cs.nextPersistentConnectionId_=0;cs.nextConnectionId_=0;class Re{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new Re(e,n)}}class tu{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new Re(Ci,e),r=new Re(Ci,n);return this.compare(s,r)!==0}minPost(){return Re.MIN}}let Za;class NI extends tu{static get __EMPTY_NODE(){return Za}static set __EMPTY_NODE(e){Za=e}compare(e,n){return Ui(e.name,n.name)}isDefinedOn(e){throw Ni("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return Re.MIN}maxPost(){return new Re(Mr,Za)}makePost(e,n){return z(typeof e=="string","KeyIndex indexValue must always be a string."),new Re(e,Za)}toString(){return".key"}}const gi=new NI;class ec{constructor(e,n,s,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ht{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??ht.RED,this.left=r??$t.EMPTY_NODE,this.right=i??$t.EMPTY_NODE}copy(e,n,s,r,i){return new ht(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return i<0?r=r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return $t.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,r;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return $t.EMPTY_NODE;r=s.right.min_(),s=s.copy(r.key,r.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ht.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ht.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ht.RED=!0;ht.BLACK=!1;class zO{copy(e,n,s,r,i){return this}insert(e,n,s){return new ht(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class $t{constructor(e,n=$t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new $t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,ht.BLACK,null,null))}remove(e){return new $t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ht.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,r=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(r=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ec(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ec(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ec(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ec(this.root_,null,this.comparator_,!0,e)}}$t.EMPTY_NODE=new zO;function QO(t,e){return Ui(t.name,e.name)}function Fd(t,e){return Ui(t,e)}let Jh;function YO(t){Jh=t}const kI=function(t){return typeof t=="number"?"number:"+oI(t):"string:"+t},DI=function(t){if(t.isLeafNode()){const e=t.val();z(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Ts(e,".sv"),"Priority must be a string or number.")}else z(t===Jh||t.isEmpty(),"priority of unexpected type.");z(t===Jh||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let R_;class lt{static set __childrenNodeConstructor(e){R_=e}static get __childrenNodeConstructor(){return R_}constructor(e,n=lt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,z(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),DI(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new lt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:lt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ie(e)?this:Ae(e)===".priority"?this.priorityNode_:lt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:lt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=Ae(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(z(s!==".priority"||sr(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,lt.__childrenNodeConstructor.EMPTY_NODE.updateChild(qe(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+kI(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=oI(this.value_):e+=this.value_,this.lazyHash_=sI(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===lt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof lt.__childrenNodeConstructor?-1:(z(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,r=lt.VALUE_TYPE_ORDER.indexOf(n),i=lt.VALUE_TYPE_ORDER.indexOf(s);return z(r>=0,"Unknown leaf type: "+n),z(i>=0,"Unknown leaf type: "+s),r===i?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}lt.VALUE_TYPE_ORDER=["object","boolean","number","string"];let OI,xI;function XO(t){OI=t}function JO(t){xI=t}class ZO extends tu{compare(e,n){const s=e.node.getPriority(),r=n.node.getPriority(),i=s.compareTo(r);return i===0?Ui(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return Re.MIN}maxPost(){return new Re(Mr,new lt("[PRIORITY-POST]",xI))}makePost(e,n){const s=OI(e);return new Re(n,new lt("[PRIORITY-POST]",s))}toString(){return".priority"}}const Dt=new ZO;const e1=Math.log(2);class t1{constructor(e){const n=i=>parseInt(Math.log(i)/e1,10),s=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const r=s(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const tl=function(t,e,n,s){t.sort(e);const r=function(l,u){const h=u-l;let d,m;if(h===0)return null;if(h===1)return d=t[l],m=n?n(d):d,new ht(m,d.node,ht.BLACK,null,null);{const g=parseInt(h/2,10)+l,S=r(l,g),P=r(g+1,u);return d=t[g],m=n?n(d):d,new ht(m,d.node,ht.BLACK,S,P)}},i=function(l){let u=null,h=null,d=t.length;const m=function(S,P){const N=d-S,O=d;d-=S;const B=r(N+1,O),q=t[N],$=n?n(q):q;g(new ht($,q.node,P,null,B))},g=function(S){u?(u.left=S,u=S):(h=S,u=S)};for(let S=0;S<l.count;++S){const P=l.nextBitIsOne(),N=Math.pow(2,l.count-(S+1));P?m(N,ht.BLACK):(m(N,ht.BLACK),m(N,ht.RED))}return h},o=new t1(t.length),a=i(o);return new $t(s||e,a)};let eh;const Yr={};class ss{static get Default(){return z(Yr&&Dt,"ChildrenNode.ts has not been loaded"),eh=eh||new ss({".priority":Yr},{".priority":Dt}),eh}constructor(e,n){this.indexes_=e,this.indexSet_=n}get(e){const n=yi(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof $t?n:null}hasIndex(e){return Ts(this.indexSet_,e.toString())}addIndex(e,n){z(e!==gi,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let r=!1;const i=n.getIterator(Re.Wrap);let o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),s.push(o),o=i.getNext();let a;r?a=tl(s,e.getCompare()):a=Yr;const l=e.toString(),u={...this.indexSet_};u[l]=e;const h={...this.indexes_};return h[l]=a,new ss(h,u)}addToIndexes(e,n){const s=Oc(this.indexes_,(r,i)=>{const o=yi(this.indexSet_,i);if(z(o,"Missing index implementation for "+i),r===Yr)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(Re.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),tl(a,o.getCompare())}else return Yr;else{const a=n.get(e.name);let l=r;return a&&(l=l.remove(new Re(e.name,a))),l.insert(e,e.node)}});return new ss(s,this.indexSet_)}removeFromIndexes(e,n){const s=Oc(this.indexes_,r=>{if(r===Yr)return r;{const i=n.get(e.name);return i?r.remove(new Re(e.name,i)):r}});return new ss(s,this.indexSet_)}}let ao;class Ne{static get EMPTY_NODE(){return ao||(ao=new Ne(new $t(Fd),null,ss.Default))}constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&DI(this.priorityNode_),this.children_.isEmpty()&&z(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ao}updatePriority(e){return this.children_.isEmpty()?this:new Ne(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?ao:n}}getChild(e){const n=Ae(e);return n===null?this:this.getImmediateChild(n).getChild(qe(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(z(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new Re(e,n);let r,i;n.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(s,this.children_)):(r=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(s,this.children_));const o=r.isEmpty()?ao:this.priorityNode_;return new Ne(r,o,i)}}updateChild(e,n){const s=Ae(e);if(s===null)return n;{z(Ae(e)!==".priority"||sr(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(s).updateChild(qe(e),n);return this.updateImmediateChild(s,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,r=0,i=!0;if(this.forEachChild(Dt,(o,a)=>{n[o]=a.val(e),s++,i&&Ne.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1}),!e&&i&&r<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+kI(this.getPriority().val())+":"),this.forEachChild(Dt,(n,s)=>{const r=s.hash();r!==""&&(e+=":"+n+":"+r)}),this.lazyHash_=e===""?"":sI(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const r=this.resolveIndex_(s);if(r){const i=r.getPredecessorKey(new Re(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new Re(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new Re(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,Re.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)<0;)r.getNext(),i=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,Re.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)>0;)r.getNext(),i=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ka?-1:0}withIndex(e){if(e===gi||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new Ne(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===gi||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(Dt),r=n.getIterator(Dt);let i=s.getNext(),o=r.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=s.getNext(),o=r.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===gi?null:this.indexMap_.get(e.toString())}}Ne.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class n1 extends Ne{constructor(){super(new $t(Fd),Ne.EMPTY_NODE,ss.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Ne.EMPTY_NODE}isEmpty(){return!1}}const ka=new n1;Object.defineProperties(Re,{MIN:{value:new Re(Ci,Ne.EMPTY_NODE)},MAX:{value:new Re(Mr,ka)}});NI.__EMPTY_NODE=Ne.EMPTY_NODE;lt.__childrenNodeConstructor=Ne;YO(ka);JO(ka);const s1=!0;function Pt(t,e=null){if(t===null)return Ne.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),z(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new lt(n,Pt(e))}if(!(t instanceof Array)&&s1){const n=[];let s=!1;if(un(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=Pt(a);l.isEmpty()||(s=s||!l.getPriority().isEmpty(),n.push(new Re(o,l)))}}),n.length===0)return Ne.EMPTY_NODE;const i=tl(n,QO,o=>o.name,Fd);if(s){const o=tl(n,Dt.getCompare());return new Ne(i,Pt(e),new ss({".priority":o},{".priority":Dt}))}else return new Ne(i,Pt(e),ss.Default)}else{let n=Ne.EMPTY_NODE;return un(t,(s,r)=>{if(Ts(t,s)&&s.substring(0,1)!=="."){const i=Pt(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(s,i))}}),n.updatePriority(Pt(e))}}XO(Pt);class r1 extends tu{constructor(e){super(),this.indexPath_=e,z(!Ie(e)&&Ae(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),r=this.extractChild(n.node),i=s.compareTo(r);return i===0?Ui(e.name,n.name):i}makePost(e,n){const s=Pt(e),r=Ne.EMPTY_NODE.updateChild(this.indexPath_,s);return new Re(n,r)}maxPost(){const e=Ne.EMPTY_NODE.updateChild(this.indexPath_,ka);return new Re(Mr,e)}toString(){return CI(this.indexPath_,0).join("/")}}class i1 extends tu{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Ui(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return Re.MIN}maxPost(){return Re.MAX}makePost(e,n){const s=Pt(e);return new Re(n,s)}toString(){return".value"}}const o1=new i1;function a1(t){return{type:"value",snapshotNode:t}}function c1(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function l1(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function C_(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function u1(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}class Ud{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Dt}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return z(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return z(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ci}hasEnd(){return this.endSet_}getIndexEndValue(){return z(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return z(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Mr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return z(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Dt}copy(){const e=new Ud;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function S_(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Dt?n="$priority":t.index_===o1?n="$value":t.index_===gi?n="$key":(z(t.index_ instanceof r1,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=gt(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=gt(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+gt(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=gt(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+gt(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function b_(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Dt&&(e.i=t.index_.toString()),e}class nl extends wI{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(z(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,n,s,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=Pa("p:rest:"),this.listens_={}}listen(e,n,s,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=nl.getListenId_(e,s),a={};this.listens_[o]=a;const l=S_(e._queryParams);this.restRequest_(i+".json",l,(u,h)=>{let d=h;if(u===404&&(d=null,u=null),u===null&&this.onDataUpdate_(i,d,!1,s),yi(this.listens_,o)===a){let m;u?u===401?m="permission_denied":m="rest_error:"+u:m="ok",r(m,null)}})}unlisten(e,n){const s=nl.getListenId_(e,n);delete this.listens_[s]}get(e){const n=S_(e._queryParams),s=e._path.toString(),r=new Of;return this.restRequest_(s+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(s,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(n.auth=r.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ki(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=zo(a.responseText)}catch{tn("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,l)}else a.status!==401&&a.status!==404&&tn("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}class h1{constructor(){this.rootNode_=Ne.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}function sl(){return{value:null,children:new Map}}function VI(t,e,n){if(Ie(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=Ae(e);t.children.has(s)||t.children.set(s,sl());const r=t.children.get(s);e=qe(e),VI(r,e,n)}}function Zh(t,e,n){t.value!==null?n(e,t.value):f1(t,(s,r)=>{const i=new We(e.toString()+"/"+s);Zh(r,i,n)})}function f1(t,e){t.children.forEach((n,s)=>{e(s,n)})}class d1{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n={...e};return this.last_&&un(this.last_,(s,r)=>{n[s]=n[s]-r}),this.last_=e,n}}const P_=10*1e3,p1=30*1e3,m1=300*1e3;class g1{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new d1(e);const s=P_+(p1-P_)*Math.random();Mo(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;un(e,(r,i)=>{i>0&&Ts(this.statsToReport_,r)&&(n[r]=i,s=!0)}),s&&this.server_.reportStats(n),Mo(this.reportStats_.bind(this),Math.floor(Math.random()*2*m1))}}var On;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(On||(On={}));function MI(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function LI(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function FI(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}class rl{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=On.ACK_USER_WRITE,this.source=MI()}operationForChild(e){if(Ie(this.path)){if(this.affectedTree.value!=null)return z(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new We(e));return new rl(xe(),n,this.revert)}}else return z(Ae(this.path)===e,"operationForChild called for unrelated child."),new rl(qe(this.path),this.affectedTree,this.revert)}}class Lr{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=On.OVERWRITE}operationForChild(e){return Ie(this.path)?new Lr(this.source,xe(),this.snap.getImmediateChild(e)):new Lr(this.source,qe(this.path),this.snap)}}class oa{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=On.MERGE}operationForChild(e){if(Ie(this.path)){const n=this.children.subtree(new We(e));return n.isEmpty()?null:n.value?new Lr(this.source,xe(),n.value):new oa(this.source,xe(),n)}else return z(Ae(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new oa(this.source,qe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Bd{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ie(e))return this.isFullyInitialized()&&!this.filtered_;const n=Ae(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function _1(t,e,n,s){const r=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(u1(o.childName,o.snapshotNode))}),co(t,r,"child_removed",e,s,n),co(t,r,"child_added",e,s,n),co(t,r,"child_moved",i,s,n),co(t,r,"child_changed",e,s,n),co(t,r,"value",e,s,n),r}function co(t,e,n,s,r,i){const o=s.filter(a=>a.type===n);o.sort((a,l)=>E1(t,a,l)),o.forEach(a=>{const l=y1(t,a,i);r.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,t.query_))})})}function y1(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function E1(t,e,n){if(e.childName==null||n.childName==null)throw Ni("Should only compare child_ events.");const s=new Re(e.childName,e.snapshotNode),r=new Re(n.childName,n.snapshotNode);return t.index_.compare(s,r)}function UI(t,e){return{eventCache:t,serverCache:e}}function Lo(t,e,n,s){return UI(new Bd(e,n,s),t.serverCache)}function BI(t,e,n,s){return UI(t.eventCache,new Bd(e,n,s))}function ef(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Fr(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let th;const v1=()=>(th||(th=new $t(oO)),th);class je{static fromObject(e){let n=new je(null);return un(e,(s,r)=>{n=n.set(new We(s),r)}),n}constructor(e,n=v1()){this.value=e,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:xe(),value:this.value};if(Ie(e))return null;{const s=Ae(e),r=this.children.get(s);if(r!==null){const i=r.findRootMostMatchingPathAndValue(qe(e),n);return i!=null?{path:ft(new We(s),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ie(e))return this;{const n=Ae(e),s=this.children.get(n);return s!==null?s.subtree(qe(e)):new je(null)}}set(e,n){if(Ie(e))return new je(n,this.children);{const s=Ae(e),i=(this.children.get(s)||new je(null)).set(qe(e),n),o=this.children.insert(s,i);return new je(this.value,o)}}remove(e){if(Ie(e))return this.children.isEmpty()?new je(null):new je(null,this.children);{const n=Ae(e),s=this.children.get(n);if(s){const r=s.remove(qe(e));let i;return r.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,r),this.value===null&&i.isEmpty()?new je(null):new je(this.value,i)}else return this}}get(e){if(Ie(e))return this.value;{const n=Ae(e),s=this.children.get(n);return s?s.get(qe(e)):null}}setTree(e,n){if(Ie(e))return n;{const s=Ae(e),i=(this.children.get(s)||new je(null)).setTree(qe(e),n);let o;return i.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,i),new je(this.value,o)}}fold(e){return this.fold_(xe(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((r,i)=>{s[r]=i.fold_(ft(e,r),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,xe(),n)}findOnPath_(e,n,s){const r=this.value?s(n,this.value):!1;if(r)return r;if(Ie(e))return null;{const i=Ae(e),o=this.children.get(i);return o?o.findOnPath_(qe(e),ft(n,i),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,xe(),n)}foreachOnPath_(e,n,s){if(Ie(e))return this;{this.value&&s(n,this.value);const r=Ae(e),i=this.children.get(r);return i?i.foreachOnPath_(qe(e),ft(n,r),s):new je(null)}}foreach(e){this.foreach_(xe(),e)}foreach_(e,n){this.children.inorderTraversal((s,r)=>{r.foreach_(ft(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}class vn{constructor(e){this.writeTree_=e}static empty(){return new vn(new je(null))}}function Fo(t,e,n){if(Ie(e))return new vn(new je(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const r=s.path;let i=s.value;const o=rn(r,e);return i=i.updateChild(o,n),new vn(t.writeTree_.set(r,i))}else{const r=new je(n),i=t.writeTree_.setTree(e,r);return new vn(i)}}}function N_(t,e,n){let s=t;return un(n,(r,i)=>{s=Fo(s,ft(e,r),i)}),s}function k_(t,e){if(Ie(e))return vn.empty();{const n=t.writeTree_.setTree(e,new je(null));return new vn(n)}}function tf(t,e){return qr(t,e)!=null}function qr(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(rn(n.path,e)):null}function D_(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Dt,(s,r)=>{e.push(new Re(s,r))}):t.writeTree_.children.inorderTraversal((s,r)=>{r.value!=null&&e.push(new Re(s,r.value))}),e}function zs(t,e){if(Ie(e))return t;{const n=qr(t,e);return n!=null?new vn(new je(n)):new vn(t.writeTree_.subtree(e))}}function nf(t){return t.writeTree_.isEmpty()}function Si(t,e){return jI(xe(),t.writeTree_,e)}function jI(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((r,i)=>{r===".priority"?(z(i.value!==null,"Priority writes must always be leaf nodes"),s=i.value):n=jI(ft(t,r),i,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(ft(t,".priority"),s)),n}}function qI(t,e){return KI(e,t)}function T1(t,e,n,s,r){z(s>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:r}),r&&(t.visibleWrites=Fo(t.visibleWrites,e,n)),t.lastWriteId=s}function I1(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function w1(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);z(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let r=s.visible,i=!1,o=t.allWrites.length-1;for(;r&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&A1(a,s.path)?r=!1:gn(s.path,a.path)&&(i=!0)),o--}if(r){if(i)return R1(t),!0;if(s.snap)t.visibleWrites=k_(t.visibleWrites,s.path);else{const a=s.children;un(a,l=>{t.visibleWrites=k_(t.visibleWrites,ft(s.path,l))})}return!0}else return!1}function A1(t,e){if(t.snap)return gn(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&gn(ft(t.path,n),e))return!0;return!1}function R1(t){t.visibleWrites=HI(t.allWrites,C1,xe()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function C1(t){return t.visible}function HI(t,e,n){let s=vn.empty();for(let r=0;r<t.length;++r){const i=t[r];if(e(i)){const o=i.path;let a;if(i.snap)gn(n,o)?(a=rn(n,o),s=Fo(s,a,i.snap)):gn(o,n)&&(a=rn(o,n),s=Fo(s,xe(),i.snap.getChild(a)));else if(i.children){if(gn(n,o))a=rn(n,o),s=N_(s,a,i.children);else if(gn(o,n))if(a=rn(o,n),Ie(a))s=N_(s,xe(),i.children);else{const l=yi(i.children,Ae(a));if(l){const u=l.getChild(qe(a));s=Fo(s,xe(),u)}}}else throw Ni("WriteRecord should have .snap or .children")}}return s}function WI(t,e,n,s,r){if(!s&&!r){const i=qr(t.visibleWrites,e);if(i!=null)return i;{const o=zs(t.visibleWrites,e);if(nf(o))return n;if(n==null&&!tf(o,xe()))return null;{const a=n||Ne.EMPTY_NODE;return Si(o,a)}}}else{const i=zs(t.visibleWrites,e);if(!r&&nf(i))return n;if(!r&&n==null&&!tf(i,xe()))return null;{const o=function(u){return(u.visible||r)&&(!s||!~s.indexOf(u.writeId))&&(gn(u.path,e)||gn(e,u.path))},a=HI(t.allWrites,o,e),l=n||Ne.EMPTY_NODE;return Si(a,l)}}}function S1(t,e,n){let s=Ne.EMPTY_NODE;const r=qr(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Dt,(i,o)=>{s=s.updateImmediateChild(i,o)}),s;if(n){const i=zs(t.visibleWrites,e);return n.forEachChild(Dt,(o,a)=>{const l=Si(zs(i,new We(o)),a);s=s.updateImmediateChild(o,l)}),D_(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const i=zs(t.visibleWrites,e);return D_(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function b1(t,e,n,s,r){z(s||r,"Either existingEventSnap or existingServerSnap must exist");const i=ft(e,n);if(tf(t.visibleWrites,i))return null;{const o=zs(t.visibleWrites,i);return nf(o)?r.getChild(n):Si(o,r.getChild(n))}}function P1(t,e,n,s){const r=ft(e,n),i=qr(t.visibleWrites,r);if(i!=null)return i;if(s.isCompleteForChild(n)){const o=zs(t.visibleWrites,r);return Si(o,s.getNode().getImmediateChild(n))}else return null}function N1(t,e){return qr(t.visibleWrites,e)}function k1(t,e,n,s,r,i,o){let a;const l=zs(t.visibleWrites,e),u=qr(l,xe());if(u!=null)a=u;else if(n!=null)a=Si(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],d=o.getCompare(),m=i?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let g=m.getNext();for(;g&&h.length<r;)d(g,s)!==0&&h.push(g),g=m.getNext();return h}else return[]}function D1(){return{visibleWrites:vn.empty(),allWrites:[],lastWriteId:-1}}function sf(t,e,n,s){return WI(t.writeTree,t.treePath,e,n,s)}function $I(t,e){return S1(t.writeTree,t.treePath,e)}function O_(t,e,n,s){return b1(t.writeTree,t.treePath,e,n,s)}function il(t,e){return N1(t.writeTree,ft(t.treePath,e))}function O1(t,e,n,s,r,i){return k1(t.writeTree,t.treePath,e,n,s,r,i)}function jd(t,e,n){return P1(t.writeTree,t.treePath,e,n)}function GI(t,e){return KI(ft(t.treePath,e),t.writeTree)}function KI(t,e){return{treePath:t,writeTree:e}}class x1{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;z(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),z(s!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const i=r.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(s,C_(s,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(s,l1(s,r.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(s,c1(s,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(s,C_(s,e.snapshotNode,r.oldSnap));else throw Ni("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}class V1{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const zI=new V1;class qd{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Bd(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return jd(this.writes_,e,s)}}getChildAfterChild(e,n,s){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Fr(this.viewCache_),i=O1(this.writes_,r,n,1,s,e);return i.length===0?null:i[0]}}function M1(t,e){z(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),z(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function L1(t,e,n,s,r){const i=new x1;let o,a;if(n.type===On.OVERWRITE){const u=n;u.source.fromUser?o=rf(t,e,u.path,u.snap,s,r,i):(z(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!Ie(u.path),o=ol(t,e,u.path,u.snap,s,r,a,i))}else if(n.type===On.MERGE){const u=n;u.source.fromUser?o=U1(t,e,u.path,u.children,s,r,i):(z(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=of(t,e,u.path,u.children,s,r,a,i))}else if(n.type===On.ACK_USER_WRITE){const u=n;u.revert?o=q1(t,e,u.path,s,r,i):o=B1(t,e,u.path,u.affectedTree,s,r,i)}else if(n.type===On.LISTEN_COMPLETE)o=j1(t,e,n.path,s,i);else throw Ni("Unknown operation type: "+n.type);const l=i.getChanges();return F1(e,o,l),{viewCache:o,changes:l}}function F1(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),i=ef(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!s.getNode().equals(i)||!s.getNode().getPriority().equals(i.getPriority()))&&n.push(a1(ef(e)))}}function QI(t,e,n,s,r,i){const o=e.eventCache;if(il(s,n)!=null)return e;{let a,l;if(Ie(n))if(z(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=Fr(e),h=u instanceof Ne?u:Ne.EMPTY_NODE,d=$I(s,h);a=t.filter.updateFullNode(e.eventCache.getNode(),d,i)}else{const u=sf(s,Fr(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,i)}else{const u=Ae(n);if(u===".priority"){z(sr(n)===1,"Can't have a priority with additional path components");const h=o.getNode();l=e.serverCache.getNode();const d=O_(s,n,h,l);d!=null?a=t.filter.updatePriority(h,d):a=o.getNode()}else{const h=qe(n);let d;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const m=O_(s,n,o.getNode(),l);m!=null?d=o.getNode().getImmediateChild(u).updateChild(h,m):d=o.getNode().getImmediateChild(u)}else d=jd(s,u,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),u,d,h,r,i):a=o.getNode()}}return Lo(e,a,o.isFullyInitialized()||Ie(n),t.filter.filtersNodes())}}function ol(t,e,n,s,r,i,o,a){const l=e.serverCache;let u;const h=o?t.filter:t.filter.getIndexedFilter();if(Ie(n))u=h.updateFullNode(l.getNode(),s,null);else if(h.filtersNodes()&&!l.isFiltered()){const g=l.getNode().updateChild(n,s);u=h.updateFullNode(l.getNode(),g,null)}else{const g=Ae(n);if(!l.isCompleteForPath(n)&&sr(n)>1)return e;const S=qe(n),N=l.getNode().getImmediateChild(g).updateChild(S,s);g===".priority"?u=h.updatePriority(l.getNode(),N):u=h.updateChild(l.getNode(),g,N,S,zI,null)}const d=BI(e,u,l.isFullyInitialized()||Ie(n),h.filtersNodes()),m=new qd(r,d,i);return QI(t,d,n,r,m,a)}function rf(t,e,n,s,r,i,o){const a=e.eventCache;let l,u;const h=new qd(r,e,i);if(Ie(n))u=t.filter.updateFullNode(e.eventCache.getNode(),s,o),l=Lo(e,u,!0,t.filter.filtersNodes());else{const d=Ae(n);if(d===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),s),l=Lo(e,u,a.isFullyInitialized(),a.isFiltered());else{const m=qe(n),g=a.getNode().getImmediateChild(d);let S;if(Ie(m))S=s;else{const P=h.getCompleteChild(d);P!=null?RI(m)===".priority"&&P.getChild(SI(m)).isEmpty()?S=P:S=P.updateChild(m,s):S=Ne.EMPTY_NODE}if(g.equals(S))l=e;else{const P=t.filter.updateChild(a.getNode(),d,S,m,h,o);l=Lo(e,P,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function x_(t,e){return t.eventCache.isCompleteForChild(e)}function U1(t,e,n,s,r,i,o){let a=e;return s.foreach((l,u)=>{const h=ft(n,l);x_(e,Ae(h))&&(a=rf(t,a,h,u,r,i,o))}),s.foreach((l,u)=>{const h=ft(n,l);x_(e,Ae(h))||(a=rf(t,a,h,u,r,i,o))}),a}function V_(t,e,n){return n.foreach((s,r)=>{e=e.updateChild(s,r)}),e}function of(t,e,n,s,r,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;Ie(n)?u=s:u=new je(null).setTree(n,s);const h=e.serverCache.getNode();return u.children.inorderTraversal((d,m)=>{if(h.hasChild(d)){const g=e.serverCache.getNode().getImmediateChild(d),S=V_(t,g,m);l=ol(t,l,new We(d),S,r,i,o,a)}}),u.children.inorderTraversal((d,m)=>{const g=!e.serverCache.isCompleteForChild(d)&&m.value===null;if(!h.hasChild(d)&&!g){const S=e.serverCache.getNode().getImmediateChild(d),P=V_(t,S,m);l=ol(t,l,new We(d),P,r,i,o,a)}}),l}function B1(t,e,n,s,r,i,o){if(il(r,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(s.value!=null){if(Ie(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return ol(t,e,n,l.getNode().getChild(n),r,i,a,o);if(Ie(n)){let u=new je(null);return l.getNode().forEachChild(gi,(h,d)=>{u=u.set(new We(h),d)}),of(t,e,n,u,r,i,a,o)}else return e}else{let u=new je(null);return s.foreach((h,d)=>{const m=ft(n,h);l.isCompleteForPath(m)&&(u=u.set(h,l.getNode().getChild(m)))}),of(t,e,n,u,r,i,a,o)}}function j1(t,e,n,s,r){const i=e.serverCache,o=BI(e,i.getNode(),i.isFullyInitialized()||Ie(n),i.isFiltered());return QI(t,o,n,s,zI,r)}function q1(t,e,n,s,r,i){let o;if(il(s,n)!=null)return e;{const a=new qd(s,e,r),l=e.eventCache.getNode();let u;if(Ie(n)||Ae(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=sf(s,Fr(e));else{const d=e.serverCache.getNode();z(d instanceof Ne,"serverChildren would be complete if leaf node"),h=$I(s,d)}h=h,u=t.filter.updateFullNode(l,h,i)}else{const h=Ae(n);let d=jd(s,h,e.serverCache);d==null&&e.serverCache.isCompleteForChild(h)&&(d=l.getImmediateChild(h)),d!=null?u=t.filter.updateChild(l,h,d,qe(n),a,i):e.eventCache.getNode().hasChild(h)?u=t.filter.updateChild(l,h,Ne.EMPTY_NODE,qe(n),a,i):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=sf(s,Fr(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,i)))}return o=e.serverCache.isFullyInitialized()||il(s,xe())!=null,Lo(e,u,o,t.filter.filtersNodes())}}function H1(t,e){const n=Fr(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Ie(e)&&!n.getImmediateChild(Ae(e)).isEmpty())?n.getChild(e):null}function M_(t,e,n,s){e.type===On.MERGE&&e.source.queryId!==null&&(z(Fr(t.viewCache_),"We should always have a full cache before handling merges"),z(ef(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,i=L1(t.processor_,r,e,n,s);return M1(t.processor_,i.viewCache),z(i.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,W1(t,i.changes,i.viewCache.eventCache.getNode())}function W1(t,e,n,s){const r=t.eventRegistrations_;return _1(t.eventGenerator_,e,n,r)}let L_;function $1(t){z(!L_,"__referenceConstructor has already been defined"),L_=t}function Hd(t,e,n,s){const r=e.source.queryId;if(r!==null){const i=t.views.get(r);return z(i!=null,"SyncTree gave us an op for an invalid query."),M_(i,e,n,s)}else{let i=[];for(const o of t.views.values())i=i.concat(M_(o,e,n,s));return i}}function Wd(t,e){let n=null;for(const s of t.views.values())n=n||H1(s,e);return n}let F_;function G1(t){z(!F_,"__referenceConstructor has already been defined"),F_=t}class U_{constructor(e){this.listenProvider_=e,this.syncPointTree_=new je(null),this.pendingWriteTree_=D1(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function K1(t,e,n,s,r){return T1(t.pendingWriteTree_,e,n,s,r),r?su(t,new Lr(MI(),e,n)):[]}function ri(t,e,n=!1){const s=I1(t.pendingWriteTree_,e);if(w1(t.pendingWriteTree_,e)){let i=new je(null);return s.snap!=null?i=i.set(xe(),!0):un(s.children,o=>{i=i.set(new We(o),!0)}),su(t,new rl(s.path,i,n))}else return[]}function nu(t,e,n){return su(t,new Lr(LI(),e,n))}function z1(t,e,n){const s=je.fromObject(n);return su(t,new oa(LI(),e,s))}function Q1(t,e,n,s){const r=ZI(t,s);if(r!=null){const i=ew(r),o=i.path,a=i.queryId,l=rn(o,e),u=new Lr(FI(a),l,n);return tw(t,o,u)}else return[]}function Y1(t,e,n,s){const r=ZI(t,s);if(r){const i=ew(r),o=i.path,a=i.queryId,l=rn(o,e),u=je.fromObject(n),h=new oa(FI(a),l,u);return tw(t,o,h)}else return[]}function YI(t,e,n){const r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=rn(o,e),u=Wd(a,l);if(u)return u});return WI(r,e,i,n,!0)}function su(t,e){return XI(e,t.syncPointTree_,null,qI(t.pendingWriteTree_,xe()))}function XI(t,e,n,s){if(Ie(t.path))return JI(t,e,n,s);{const r=e.get(xe());n==null&&r!=null&&(n=Wd(r,xe()));let i=[];const o=Ae(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const u=n?n.getImmediateChild(o):null,h=GI(s,o);i=i.concat(XI(a,l,u,h))}return r&&(i=i.concat(Hd(r,t,s,n))),i}}function JI(t,e,n,s){const r=e.get(xe());n==null&&r!=null&&(n=Wd(r,xe()));let i=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,u=GI(s,o),h=t.operationForChild(o);h&&(i=i.concat(JI(h,a,l,u)))}),r&&(i=i.concat(Hd(r,t,s,n))),i}function ZI(t,e){return t.tagToQueryMap.get(e)}function ew(t){const e=t.indexOf("$");return z(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new We(t.substr(0,e))}}function tw(t,e,n){const s=t.syncPointTree_.get(e);z(s,"Missing sync point for query tag that we're tracking");const r=qI(t.pendingWriteTree_,e);return Hd(s,n,r,null)}class $d{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new $d(n)}node(){return this.node_}}class Gd{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=ft(this.path_,e);return new Gd(this.syncTree_,n)}node(){return YI(this.syncTree_,this.path_)}}const X1=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},B_=function(t,e,n){if(!t||typeof t!="object")return t;if(z(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return J1(t[".sv"],e,n);if(typeof t[".sv"]=="object")return Z1(t[".sv"],e);z(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},J1=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:z(!1,"Unexpected server value: "+t)}},Z1=function(t,e,n){t.hasOwnProperty("increment")||z(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&z(!1,"Unexpected increment value: "+s);const r=e.node();if(z(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return typeof o!="number"?s:o+s},ex=function(t,e,n,s){return Kd(e,new Gd(n,t),s)},tx=function(t,e,n){return Kd(t,new $d(e),n)};function Kd(t,e,n){const s=t.getPriority().val(),r=B_(s,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=B_(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new lt(a,Pt(r)):t}else{const o=t;return i=o,r!==o.getPriority().val()&&(i=i.updatePriority(new lt(r))),o.forEachChild(Dt,(a,l)=>{const u=Kd(l,e.getImmediateChild(a),n);u!==l&&(i=i.updateImmediateChild(a,u))}),i}}class zd{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function Qd(t,e){let n=e instanceof We?e:new We(e),s=t,r=Ae(n);for(;r!==null;){const i=yi(s.node.children,r)||{children:{},childCount:0};s=new zd(r,s,i),n=qe(n),r=Ae(n)}return s}function Bi(t){return t.node.value}function nw(t,e){t.node.value=e,af(t)}function sw(t){return t.node.childCount>0}function nx(t){return Bi(t)===void 0&&!sw(t)}function ru(t,e){un(t.node.children,(n,s)=>{e(new zd(n,t,s))})}function rw(t,e,n,s){n&&e(t),ru(t,r=>{rw(r,e,!0)})}function sx(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function Da(t){return new We(t.parent===null?t.name:Da(t.parent)+"/"+t.name)}function af(t){t.parent!==null&&rx(t.parent,t.name,t)}function rx(t,e,n){const s=nx(n),r=Ts(t.node.children,e);s&&r?(delete t.node.children[e],t.node.childCount--,af(t)):!s&&!r&&(t.node.children[e]=n.node,t.node.childCount++,af(t))}const ix=/[\[\].#$\/\u0000-\u001F\u007F]/,ox=/[\[\].#$\u0000-\u001F\u007F]/,nh=10*1024*1024,iw=function(t){return typeof t=="string"&&t.length!==0&&!ix.test(t)},ax=function(t){return typeof t=="string"&&t.length!==0&&!ox.test(t)},cx=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),ax(t)},ow=function(t,e,n){const s=n instanceof We?new jO(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Tr(s));if(typeof e=="function")throw new Error(t+"contains a function "+Tr(s)+" with contents = "+e.toString());if(rI(e))throw new Error(t+"contains "+e.toString()+" "+Tr(s));if(typeof e=="string"&&e.length>nh/3&&Nl(e)>nh)throw new Error(t+"contains a string greater than "+nh+" utf8 bytes "+Tr(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,i=!1;if(un(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!iw(o)))throw new Error(t+" contains an invalid key ("+o+") "+Tr(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);qO(s,o),ow(t,a,s),HO(s)}),r&&i)throw new Error(t+' contains ".value" child '+Tr(s)+" in addition to actual children.")}},lx=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!iw(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!cx(n))throw new Error(fS(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};class ux{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function hx(t,e){let n=null;for(let s=0;s<e.length;s++){const r=e[s],i=r.getPath();n!==null&&!bI(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(r)}n&&t.eventLists_.push(n)}function Hr(t,e,n){hx(t,n),fx(t,s=>gn(s,e)||gn(e,s))}function fx(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const r=t.eventLists_[s];if(r){const i=r.path;e(i)?(dx(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function dx(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();Vo&&bt("event: "+n.toString()),Na(s)}}}const px="repo_interrupt",mx=25;class gx{constructor(e,n,s,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ux,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=sl(),this.transactionQueueTree_=new zd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function _x(t,e,n){if(t.stats_=Vd(t.repoInfo_),t.forceRestClient_||fO())t.server_=new nl(t.repoInfo_,(s,r,i,o)=>{j_(t,s,r,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>q_(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{gt(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new cs(t.repoInfo_,e,(s,r,i,o)=>{j_(t,s,r,i,o)},s=>{q_(t,s)},s=>{Ex(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=_O(t.repoInfo_,()=>new g1(t.stats_,t.server_)),t.infoData_=new h1,t.infoSyncTree_=new U_({startListening:(s,r,i,o)=>{let a=[];const l=t.infoData_.getNode(s._path);return l.isEmpty()||(a=nu(t.infoSyncTree_,s._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Yd(t,"connected",!1),t.serverSyncTree_=new U_({startListening:(s,r,i,o)=>(t.server_.listen(s,i,r,(a,l)=>{const u=o(a,l);Hr(t.eventQueue_,s._path,u)}),[]),stopListening:(s,r)=>{t.server_.unlisten(s,r)}})}function yx(t){const n=t.infoData_.getNode(new We(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function aw(t){return X1({timestamp:yx(t)})}function j_(t,e,n,s,r){t.dataUpdateCount++;const i=new We(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(s){const l=Oc(n,u=>Pt(u));o=Y1(t.serverSyncTree_,i,l,r)}else{const l=Pt(n);o=Q1(t.serverSyncTree_,i,l,r)}else if(s){const l=Oc(n,u=>Pt(u));o=z1(t.serverSyncTree_,i,l)}else{const l=Pt(n);o=nu(t.serverSyncTree_,i,l)}let a=i;o.length>0&&(a=Jd(t,i)),Hr(t.eventQueue_,a,o)}function q_(t,e){Yd(t,"connected",e),e===!1&&Tx(t)}function Ex(t,e){un(e,(n,s)=>{Yd(t,n,s)})}function Yd(t,e,n){const s=new We("/.info/"+e),r=Pt(n);t.infoData_.updateSnapshot(s,r);const i=nu(t.infoSyncTree_,s,r);Hr(t.eventQueue_,s,i)}function vx(t){return t.nextWriteId_++}function Tx(t){cw(t,"onDisconnectEvents");const e=aw(t),n=sl();Zh(t.onDisconnect_,xe(),(r,i)=>{const o=ex(r,i,t.serverSyncTree_,e);VI(n,r,o)});let s=[];Zh(n,xe(),(r,i)=>{s=s.concat(nu(t.serverSyncTree_,r,i));const o=Rx(t,r);Jd(t,o)}),t.onDisconnect_=sl(),Hr(t.eventQueue_,xe(),s)}function Ix(t){t.persistentConnection_&&t.persistentConnection_.interrupt(px)}function cw(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),bt(n,...e)}function lw(t,e,n){return YI(t.serverSyncTree_,e,n)||Ne.EMPTY_NODE}function Xd(t,e=t.transactionQueueTree_){if(e||iu(t,e),Bi(e)){const n=hw(t,e);z(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&wx(t,Da(e),n)}else sw(e)&&ru(e,n=>{Xd(t,n)})}function wx(t,e,n){const s=n.map(u=>u.currentWriteId),r=lw(t,e,s);let i=r;const o=r.hash();for(let u=0;u<n.length;u++){const h=n[u];z(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const d=rn(e,h.path);i=i.updateChild(d,h.currentOutputSnapshotRaw)}const a=i.val(!0),l=e;t.server_.put(l.toString(),a,u=>{cw(t,"transaction put response",{path:l.toString(),status:u});let h=[];if(u==="ok"){const d=[];for(let m=0;m<n.length;m++)n[m].status=2,h=h.concat(ri(t.serverSyncTree_,n[m].currentWriteId)),n[m].onComplete&&d.push(()=>n[m].onComplete(null,!0,n[m].currentOutputSnapshotResolved)),n[m].unwatcher();iu(t,Qd(t.transactionQueueTree_,e)),Xd(t,t.transactionQueueTree_),Hr(t.eventQueue_,e,h);for(let m=0;m<d.length;m++)Na(d[m])}else{if(u==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{tn("transaction at "+l.toString()+" failed: "+u);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=u}Jd(t,e)}},o)}function Jd(t,e){const n=uw(t,e),s=Da(n),r=hw(t,n);return Ax(t,r,s),s}function Ax(t,e,n){if(e.length===0)return;const s=[];let r=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=rn(n,l.path);let h=!1,d;if(z(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)h=!0,d=l.abortReason,r=r.concat(ri(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=mx)h=!0,d="maxretry",r=r.concat(ri(t.serverSyncTree_,l.currentWriteId,!0));else{const m=lw(t,l.path,o);l.currentInputSnapshot=m;const g=e[a].update(m.val());if(g!==void 0){ow("transaction failed: Data returned ",g,l.path);let S=Pt(g);typeof g=="object"&&g!=null&&Ts(g,".priority")||(S=S.updatePriority(m.getPriority()));const N=l.currentWriteId,O=aw(t),B=tx(S,m,O);l.currentOutputSnapshotRaw=S,l.currentOutputSnapshotResolved=B,l.currentWriteId=vx(t),o.splice(o.indexOf(N),1),r=r.concat(K1(t.serverSyncTree_,l.path,B,l.currentWriteId,l.applyLocally)),r=r.concat(ri(t.serverSyncTree_,N,!0))}else h=!0,d="nodata",r=r.concat(ri(t.serverSyncTree_,l.currentWriteId,!0))}Hr(t.eventQueue_,n,r),r=[],h&&(e[a].status=2,(function(m){setTimeout(m,Math.floor(0))})(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(d),!1,null))))}iu(t,t.transactionQueueTree_);for(let a=0;a<s.length;a++)Na(s[a]);Xd(t,t.transactionQueueTree_)}function uw(t,e){let n,s=t.transactionQueueTree_;for(n=Ae(e);n!==null&&Bi(s)===void 0;)s=Qd(s,n),e=qe(e),n=Ae(e);return s}function hw(t,e){const n=[];return fw(t,e,n),n.sort((s,r)=>s.order-r.order),n}function fw(t,e,n){const s=Bi(e);if(s)for(let r=0;r<s.length;r++)n.push(s[r]);ru(e,r=>{fw(t,r,n)})}function iu(t,e){const n=Bi(e);if(n){let s=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[s]=n[r],s++);n.length=s,nw(e,n.length>0?n:void 0)}ru(e,s=>{iu(t,s)})}function Rx(t,e){const n=Da(uw(t,e)),s=Qd(t.transactionQueueTree_,e);return sx(s,r=>{sh(t,r)}),sh(t,s),rw(s,r=>{sh(t,r)}),n}function sh(t,e){const n=Bi(e);if(n){const s=[];let r=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(z(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(z(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(ri(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?nw(e,void 0):n.length=i+1,Hr(t.eventQueue_,Da(e),r);for(let o=0;o<s.length;o++)Na(s[o])}}function Cx(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let r=n[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function Sx(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):tn(`Invalid query segment '${n}' in query '${t}'`)}return e}const H_=function(t,e){const n=bx(t),s=n.namespace;n.domain==="firebase.com"&&ys(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&ys("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||rO();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new gI(n.host,n.secure,s,r,e,"",s!==n.subdomain),path:new We(n.pathString)}},bx=function(t){let e="",n="",s="",r="",i="",o=!0,a="https",l=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let h=t.indexOf("/");h===-1&&(h=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(h,d)),h<d&&(r=Cx(t.substring(h,d)));const m=Sx(t.substring(Math.min(t.length,d)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;const g=e.slice(0,u);if(g.toLowerCase()==="localhost")n="localhost";else if(g.split(".").length<=2)n=g;else{const S=e.indexOf(".");s=e.substring(0,S).toLowerCase(),n=e.substring(S+1),i=s}"ns"in m&&(i=m.ns)}return{host:e,port:l,domain:n,subdomain:s,secure:o,scheme:a,pathString:r,namespace:i}};class Zd{constructor(e,n,s,r){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=r}get key(){return Ie(this._path)?null:RI(this._path)}get ref(){return new ji(this._repo,this._path)}get _queryIdentifier(){const e=b_(this._queryParams),n=Od(e);return n==="{}"?"default":n}get _queryObject(){return b_(this._queryParams)}isEqual(e){if(e=$e(e),!(e instanceof Zd))return!1;const n=this._repo===e._repo,s=bI(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&s&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+BO(this._path)}}class ji extends Zd{constructor(e,n){super(e,n,new Ud,!1)}get parent(){const e=SI(this._path);return e===null?null:new ji(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}$1(ji);G1(ji);const Px="FIREBASE_DATABASE_EMULATOR_HOST",cf={};let Nx=!1;function kx(t,e,n,s){const r=e.lastIndexOf(":"),i=e.substring(0,r),o=vs(i);t.repoInfo_=new gI(e,o,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0,n),s&&(t.authTokenProvider_=s)}function Dx(t,e,n,s,r){let i=s||t.options.databaseURL;i===void 0&&(t.options.projectId||ys("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),bt("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=H_(i,r),a=o.repoInfo,l;typeof process<"u"&&l_&&(l=l_[Px]),l?(i=`http://${l}?ns=${a.namespace}`,o=H_(i,r),a=o.repoInfo):o.repoInfo.secure;const u=new pO(t.name,t.options,e);lx("Invalid Firebase Database URL",o),Ie(o.path)||ys("Database URL must point to the root of a Firebase Database (not including a child path).");const h=xx(a,t,u,new dO(t,n));return new Vx(h,t)}function Ox(t,e){const n=cf[e];(!n||n[t.key]!==t)&&ys(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Ix(t),delete n[t.key]}function xx(t,e,n,s){let r=cf[e.name];r||(r={},cf[e.name]=r);let i=r[t.toURLString()];return i&&ys("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new gx(t,Nx,n,s),r[t.toURLString()]=i,i}class Vx{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(_x(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ji(this._repo,xe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Ox(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&ys("Cannot call "+e+" on a deleted database.")}}function Mx(t=Dl(),e){const n=da(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=Df("database");s&&Lx(n,...s)}return n}function Lx(t,e,n,s={}){t=$e(t),t._checkNotDeleted("useEmulator");const r=`${e}:${n}`,i=t._repoInternal;if(t._instanceStarted){if(r===t._repoInternal.repoInfo_.host&&fs(s,i.repoInfo_.emulatorOptions))return;ys("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(i.repoInfo_.nodeAdmin)s.mockUserToken&&ys('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new yc(yc.OWNER);else if(s.mockUserToken){const a=typeof s.mockUserToken=="string"?s.mockUserToken:xf(s.mockUserToken,t.app.options.projectId);o=new yc(a)}vs(e)&&(bl(e),Pl("Database",!0)),kx(i,r,s,o)}function Fx(t){JD(rr),Ys(new ds("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return Dx(s,r,i,n)},"PUBLIC").setMultipleInstances(!0)),an(u_,h_,t),an(u_,h_,"esm2020")}cs.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};cs.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Fx();const dw="firebasestorage.googleapis.com",Ux="storageBucket",Bx=120*1e3,jx=600*1e3;class Wn extends Hn{constructor(e,n,s=0){super(rh(e),`Firebase Storage: ${n} (${rh(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Wn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return rh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var qn;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(qn||(qn={}));function rh(t){return"storage/"+t}function qx(){const t="An unknown error occurred, please check the error payload for server response.";return new Wn(qn.UNKNOWN,t)}function Hx(){return new Wn(qn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Wx(){return new Wn(qn.CANCELED,"User canceled the upload/download.")}function $x(t){return new Wn(qn.INVALID_URL,"Invalid URL '"+t+"'.")}function Gx(t){return new Wn(qn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function W_(t){return new Wn(qn.INVALID_ARGUMENT,t)}function pw(){return new Wn(qn.APP_DELETED,"The Firebase app was deleted.")}function Kx(t){return new Wn(qn.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}class _n{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=_n.makeFromUrl(e,n)}catch{return new _n(e,"")}if(s.path==="")return s;throw Gx(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i($){$.path.charAt($.path.length-1)==="/"&&($.path_=$.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function u($){$.path_=decodeURIComponent($.path)}const h="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",g=new RegExp(`^https?://${d}/${h}/b/${r}/o${m}`,"i"),S={bucket:1,path:3},P=n===dw?"(?:storage.googleapis.com|storage.cloud.google.com)":n,N="([^?#]*)",O=new RegExp(`^https?://${P}/${r}/${N}`,"i"),q=[{regex:a,indices:l,postModify:i},{regex:g,indices:S,postModify:u},{regex:O,indices:{bucket:1,path:2},postModify:u}];for(let $=0;$<q.length;$++){const ee=q[$],oe=ee.regex.exec(e);if(oe){const C=oe[ee.indices.bucket];let E=oe[ee.indices.path];E||(E=""),s=new _n(C,E),ee.postModify(s);break}}if(s==null)throw $x(e);return s}}class zx{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function Qx(t,e,n){let s=1,r=null,i=null,o=!1,a=0;function l(){return a===2}let u=!1;function h(...N){u||(u=!0,e.apply(null,N))}function d(N){r=setTimeout(()=>{r=null,t(g,l())},N)}function m(){i&&clearTimeout(i)}function g(N,...O){if(u){m();return}if(N){m(),h.call(null,N,...O);return}if(l()||o){m(),h.call(null,N,...O);return}s<64&&(s*=2);let q;a===1?(a=2,q=0):q=(s+Math.random())*1e3,d(q)}let S=!1;function P(N){S||(S=!0,m(),!u&&(r!==null?(N||(a=2),clearTimeout(r),d(0)):N||(a=1)))}return d(0),i=setTimeout(()=>{o=!0,P(!0)},n),P}function Yx(t){t(!1)}function Xx(t){return t!==void 0}function $_(t,e,n,s){if(s<e)throw W_(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw W_(`Invalid value for '${t}'. Expected ${n} or less.`)}function Jx(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}var al;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(al||(al={}));function Zx(t,e){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||r||i}class eV{constructor(e,n,s,r,i,o,a,l,u,h,d,m=!0,g=!1){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=d,this.retry=m,this.isUsingEmulator=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((S,P)=>{this.resolve_=S,this.reject_=P,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new tc(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,u=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===al.NO_ERROR,l=i.getStatus();if(!a||Zx(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===al.ABORT;s(!1,new tc(!1,null,h));return}const u=this.successCodes_.indexOf(l)!==-1;s(!0,new tc(u,i))})},n=(s,r)=>{const i=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());Xx(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=qx();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(r.canceled){const l=this.appDelete_?pw():Wx();o(l)}else{const l=Hx();o(l)}};this.canceled_?n(!1,new tc(!1,null,!0)):this.backoffId_=Qx(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Yx(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class tc{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function tV(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function nV(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function sV(t,e){e&&(t["X-Firebase-GMPID"]=e)}function rV(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function iV(t,e,n,s,r,i,o=!0,a=!1){const l=Jx(t.urlParams),u=t.url+l,h=Object.assign({},t.headers);return sV(h,e),tV(h,n),nV(h,i),rV(h,s),new eV(u,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o,a)}function oV(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function aV(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}class cl{constructor(e,n){this._service=e,n instanceof _n?this._location=n:this._location=_n.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new cl(e,n)}get root(){const e=new _n(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return aV(this._location.path)}get storage(){return this._service}get parent(){const e=oV(this._location.path);if(e===null)return null;const n=new _n(this._location.bucket,e);return new cl(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw Kx(e)}}function G_(t,e){const n=e?.[Ux];return n==null?null:_n.makeFromBucketSpec(n,t)}function cV(t,e,n,s={}){t.host=`${e}:${n}`;const r=vs(e);r&&(bl(`https://${t.host}/b`),Pl("Storage",!0)),t._isUsingEmulator=!0,t._protocol=r?"https":"http";const{mockUserToken:i}=s;i&&(t._overrideAuthToken=typeof i=="string"?i:xf(i,t.app.options.projectId))}class lV{constructor(e,n,s,r,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=dw,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Bx,this._maxUploadRetryTime=jx,this._requests=new Set,r!=null?this._bucket=_n.makeFromBucketSpec(r,this._host):this._bucket=G_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=_n.makeFromBucketSpec(this._url,e):this._bucket=G_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Ft(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new cl(this,e)}_makeRequest(e,n,s,r,i=!0){if(this._deleted)return new zx(pw());{const o=iV(e,this._appId,s,r,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const K_="@firebase/storage",z_="0.14.0";const mw="storage";function uV(t=Dl(),e){t=$e(t);const s=da(t,mw).getImmediate({identifier:e}),r=Df("storage");return r&&hV(s,...r),s}function hV(t,e,n,s={}){cV(t,e,n,s)}function fV(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new lV(n,s,r,e,rr)}function dV(){Ys(new ds(mw,fV,"PUBLIC").setMultipleInstances(!0)),an(K_,z_,""),an(K_,z_,"esm2020")}dV();const pV={apiKey:"AIzaSyBEWc4Q1UV9eEtZfeVjQwXL2F5HCTYjgQQ",authDomain:"secret-trails.firebaseapp.com",projectId:"secret-trails",storageBucket:"secret-trails.firebasestorage.app",messagingSenderId:"658406616234",appId:"1:658406616234:web:0b4cfd4b4d84250add74d3",databaseURL:"https://secret-trails-default-rtdb.firebaseio.com/"},ou=HE(pV),nc=vN(ou),lo=YD(ou);Mx(ou);uV(ou);const sc={GM:"gm",PLAYER:"player"},uo=kE("user",()=>{const t=au(),e=is(null),n=is(!1),s=is(null);let r=null;const i=it(()=>e.value?.role===sc.GM),o=it(()=>e.value?.role===sc.PLAYER),a=it(()=>e.value?.displayName||t.userEmail?.split("@")[0]||"Adventurer"),l=it(()=>e.value?.role);async function u(P,N={}){try{n.value=!0,s.value=null;const O={email:t.userEmail,displayName:N.displayName||t.userEmail?.split("@")[0]||"Adventurer",role:N.role||sc.PLAYER,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),settings:{theme:"dark",notifications:!0}};return await DN(Eo(nc,"users",P),O),e.value=O,O}catch(O){throw s.value=O.message,O}finally{n.value=!1}}async function h(P){try{n.value=!0,s.value=null;const N=Eo(nc,"users",P),O=await kN(N);return O.exists()?(e.value=O.data(),e.value):await u(P)}catch(N){throw s.value=N.message,N}finally{n.value=!1}}function d(P){r&&r();const N=Eo(nc,"users",P);r=xN(N,O=>{O.exists()&&(e.value=O.data())},O=>{s.value=O.message})}async function m(P,N){try{n.value=!0,s.value=null;const O={...N,updatedAt:new Date().toISOString()};return await ON(Eo(nc,"users",P),O),e.value={...e.value,...O},e.value}catch(O){throw s.value=O.message,O}finally{n.value=!1}}async function g(P,N){if(!Object.values(sc).includes(N))throw new Error(`Invalid role: ${N}`);return m(P,{role:N})}function S(){r&&(r(),r=null),e.value=null,s.value=null}return{profile:e,loading:n,error:s,isGM:i,isPlayer:o,displayName:a,userRole:l,createProfile:u,fetchProfile:h,subscribeToProfile:d,updateProfile:m,setRole:g,clearProfile:S}}),au=kE("auth",()=>{const t=is(null),e=is(!0),n=is(null),s=it(()=>!!t.value),r=it(()=>t.value?.uid),i=it(()=>t.value?.email);async function o(d,m){try{n.value=null;const g=await Vk(lo,d,m);t.value=g.user;const S=uo();return await S.fetchProfile(g.user.uid),S.subscribeToProfile(g.user.uid),g.user}catch(g){throw n.value=g.message,g}}async function a(d,m){try{n.value=null,console.log("1. Starting registration...");const g=await xk(lo,d,m);console.log("2. Firebase Auth user created:",g.user.uid),t.value=g.user,console.log("3. Creating user profile in Firestore...");const S=uo();return await S.createProfile(g.user.uid),console.log("4. Profile created!"),S.subscribeToProfile(g.user.uid),console.log("5. Subscribed to profile, registration complete!"),g.user}catch(g){throw console.error("Registration error:",g),n.value=g.message,g}}async function l(){try{n.value=null;const d=new es,m=await iD(lo,d);t.value=m.user;const g=uo();return await g.fetchProfile(m.user.uid),g.subscribeToProfile(m.user.uid),m.user}catch(d){throw n.value=d.message,d}}async function u(){try{uo().clearProfile(),await Uk(lo),t.value=null}catch(d){throw n.value=d.message,d}}function h(){Fk(lo,async d=>{if(t.value=d,d){const m=uo();try{await m.fetchProfile(d.uid),m.subscribeToProfile(d.uid)}catch(g){console.error("Failed to load user profile:",g)}}e.value=!1})}return{user:t,loading:e,error:n,isAuthenticated:s,userId:r,userEmail:i,login:o,register:a,loginWithGoogle:l,logout:u,initAuthListener:h}}),mV={class:"app"},gV={key:0,class:"loading-screen"},_V={__name:"App",setup(t){const e=au();return(n,s)=>{const r=oR("router-view");return li(),am("div",mV,[qs(e).loading?(li(),am("div",gV,[...s[0]||(s[0]=[Sc("div",{class:"loading-spinner"},null,-1),Sc("p",null,"...",-1)])])):(li(),Cc(r,{key:1}))])}}},yV="modulepreload",EV=function(t){return"/secret-trails/"+t},Q_={},cu=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){let l=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");r=l(n.map(u=>{if(u=EV(u),u in Q_)return;Q_[u]=!0;const h=u.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":yV,h||(m.as="script"),m.crossOrigin="",m.href=u,a&&m.setAttribute("nonce",a),document.head.appendChild(m),h)return new Promise((g,S)=>{m.addEventListener("load",g),m.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};const ni=typeof document<"u";function gw(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function vV(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&gw(t.default)}const be=Object.assign;function ih(t,e){const n={};for(const s in e){const r=e[s];n[s]=Rn(r)?r.map(t):t(r)}return n}const Uo=()=>{},Rn=Array.isArray;function Y_(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}const _w=/#/g,TV=/&/g,IV=/\//g,wV=/=/g,AV=/\?/g,yw=/\+/g,RV=/%5B/g,CV=/%5D/g,Ew=/%5E/g,SV=/%60/g,vw=/%7B/g,bV=/%7C/g,Tw=/%7D/g,PV=/%20/g;function ep(t){return t==null?"":encodeURI(""+t).replace(bV,"|").replace(RV,"[").replace(CV,"]")}function NV(t){return ep(t).replace(vw,"{").replace(Tw,"}").replace(Ew,"^")}function lf(t){return ep(t).replace(yw,"%2B").replace(PV,"+").replace(_w,"%23").replace(TV,"%26").replace(SV,"`").replace(vw,"{").replace(Tw,"}").replace(Ew,"^")}function kV(t){return lf(t).replace(wV,"%3D")}function DV(t){return ep(t).replace(_w,"%23").replace(AV,"%3F")}function OV(t){return DV(t).replace(IV,"%2F")}function aa(t){if(t==null)return null;try{return decodeURIComponent(""+t)}catch{}return""+t}const xV=/\/$/,VV=t=>t.replace(xV,"");function oh(t,e,n="/"){let s,r={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return l=a>=0&&l>a?-1:l,l>=0&&(s=e.slice(0,l),i=e.slice(l,a>0?a:e.length),r=t(i.slice(1))),a>=0&&(s=s||e.slice(0,a),o=e.slice(a,e.length)),s=UV(s??e,n),{fullPath:s+i+o,path:s,query:r,hash:aa(o)}}function MV(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function X_(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function LV(t,e,n){const s=e.matched.length-1,r=n.matched.length-1;return s>-1&&s===r&&bi(e.matched[s],n.matched[r])&&Iw(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function bi(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Iw(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!FV(t[n],e[n]))return!1;return!0}function FV(t,e){return Rn(t)?J_(t,e):Rn(e)?J_(e,t):t===e}function J_(t,e){return Rn(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function UV(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/"),r=s[s.length-1];(r===".."||r===".")&&s.push("");let i=n.length-1,o,a;for(o=0;o<s.length;o++)if(a=s[o],a!==".")if(a==="..")i>1&&i--;else break;return n.slice(0,i).join("/")+"/"+s.slice(o).join("/")}const ks={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};let uf=(function(t){return t.pop="pop",t.push="push",t})({}),ah=(function(t){return t.back="back",t.forward="forward",t.unknown="",t})({});function BV(t){if(!t)if(ni){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),VV(t)}const jV=/^[^#]+#/;function qV(t,e){return t.replace(jV,"#")+e}function HV(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const lu=()=>({left:window.scrollX,top:window.scrollY});function WV(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=HV(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Z_(t,e){return(history.state?history.state.position-e:-1)+t}const hf=new Map;function $V(t,e){hf.set(t,e)}function GV(t){const e=hf.get(t);return hf.delete(t),e}function KV(t){return typeof t=="string"||t&&typeof t=="object"}function ww(t){return typeof t=="string"||typeof t=="symbol"}let ze=(function(t){return t[t.MATCHER_NOT_FOUND=1]="MATCHER_NOT_FOUND",t[t.NAVIGATION_GUARD_REDIRECT=2]="NAVIGATION_GUARD_REDIRECT",t[t.NAVIGATION_ABORTED=4]="NAVIGATION_ABORTED",t[t.NAVIGATION_CANCELLED=8]="NAVIGATION_CANCELLED",t[t.NAVIGATION_DUPLICATED=16]="NAVIGATION_DUPLICATED",t})({});const Aw=Symbol("");ze.MATCHER_NOT_FOUND+"",ze.NAVIGATION_GUARD_REDIRECT+"",ze.NAVIGATION_ABORTED+"",ze.NAVIGATION_CANCELLED+"",ze.NAVIGATION_DUPLICATED+"";function Pi(t,e){return be(new Error,{type:t,[Aw]:!0},e)}function zn(t,e){return t instanceof Error&&Aw in t&&(e==null||!!(t.type&e))}const zV=["params","query","hash"];function QV(t){if(typeof t=="string")return t;if(t.path!=null)return t.path;const e={};for(const n of zV)n in t&&(e[n]=t[n]);return JSON.stringify(e,null,2)}function YV(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<n.length;++s){const r=n[s].replace(yw," "),i=r.indexOf("="),o=aa(i<0?r:r.slice(0,i)),a=i<0?null:aa(r.slice(i+1));if(o in e){let l=e[o];Rn(l)||(l=e[o]=[l]),l.push(a)}else e[o]=a}return e}function ey(t){let e="";for(let n in t){const s=t[n];if(n=kV(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(Rn(s)?s.map(r=>r&&lf(r)):[s&&lf(s)]).forEach(r=>{r!==void 0&&(e+=(e.length?"&":"")+n,r!=null&&(e+="="+r))})}return e}function XV(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=Rn(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}const JV=Symbol(""),ty=Symbol(""),uu=Symbol(""),tp=Symbol(""),ff=Symbol("");function ho(){let t=[];function e(s){return t.push(s),()=>{const r=t.indexOf(s);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function Ms(t,e,n,s,r,i=o=>o()){const o=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((a,l)=>{const u=m=>{m===!1?l(Pi(ze.NAVIGATION_ABORTED,{from:n,to:e})):m instanceof Error?l(m):KV(m)?l(Pi(ze.NAVIGATION_GUARD_REDIRECT,{from:e,to:m})):(o&&s.enterCallbacks[r]===o&&typeof m=="function"&&o.push(m),a())},h=i(()=>t.call(s&&s.instances[r],e,n,u));let d=Promise.resolve(h);t.length<3&&(d=d.then(u)),d.catch(m=>l(m))})}function ch(t,e,n,s,r=i=>i()){const i=[];for(const o of t)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(gw(l)){const u=(l.__vccOpts||l)[e];u&&i.push(Ms(u,n,s,o,a,r))}else{let u=l();i.push(()=>u.then(h=>{if(!h)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const d=vV(h)?h.default:h;o.mods[a]=h,o.components[a]=d;const m=(d.__vccOpts||d)[e];return m&&Ms(m,n,s,o,a,r)()}))}}return i}function ZV(t,e){const n=[],s=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(u=>bi(u,a))?s.push(a):n.push(a));const l=t.matched[o];l&&(e.matched.find(u=>bi(u,l))||r.push(l))}return[n,s,r]}let eM=()=>location.protocol+"//"+location.host;function Rw(t,e){const{pathname:n,search:s,hash:r}=e,i=t.indexOf("#");if(i>-1){let o=r.includes(t.slice(i))?t.slice(i).length:1,a=r.slice(o);return a[0]!=="/"&&(a="/"+a),X_(a,"")}return X_(n,t)+s+r}function tM(t,e,n,s){let r=[],i=[],o=null;const a=({state:m})=>{const g=Rw(t,location),S=n.value,P=e.value;let N=0;if(m){if(n.value=g,e.value=m,o&&o===S){o=null;return}N=P?m.position-P.position:0}else s(g);r.forEach(O=>{O(n.value,S,{delta:N,type:uf.pop,direction:N?N>0?ah.forward:ah.back:ah.unknown})})};function l(){o=n.value}function u(m){r.push(m);const g=()=>{const S=r.indexOf(m);S>-1&&r.splice(S,1)};return i.push(g),g}function h(){if(document.visibilityState==="hidden"){const{history:m}=window;if(!m.state)return;m.replaceState(be({},m.state,{scroll:lu()}),"")}}function d(){for(const m of i)m();i=[],window.removeEventListener("popstate",a),window.removeEventListener("pagehide",h),document.removeEventListener("visibilitychange",h)}return window.addEventListener("popstate",a),window.addEventListener("pagehide",h),document.addEventListener("visibilitychange",h),{pauseListeners:l,listen:u,destroy:d}}function ny(t,e,n,s=!1,r=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:r?lu():null}}function nM(t){const{history:e,location:n}=window,s={value:Rw(t,n)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,u,h){const d=t.indexOf("#"),m=d>-1?(n.host&&document.querySelector("base")?t:t.slice(d))+l:eM()+t+l;try{e[h?"replaceState":"pushState"](u,"",m),r.value=u}catch(g){console.error(g),n[h?"replace":"assign"](m)}}function o(l,u){i(l,be({},e.state,ny(r.value.back,l,r.value.forward,!0),u,{position:r.value.position}),!0),s.value=l}function a(l,u){const h=be({},r.value,e.state,{forward:l,scroll:lu()});i(h.current,h,!0),i(l,be({},ny(s.value,l,null),{position:h.position+1},u),!1),s.value=l}return{location:s,state:r,push:a,replace:o}}function sM(t){t=BV(t);const e=nM(t),n=tM(t,e.state,e.location,e.replace);function s(i,o=!0){o||n.pauseListeners(),history.go(i)}const r=be({location:"",base:t,go:s,createHref:qV.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}let Sr=(function(t){return t[t.Static=0]="Static",t[t.Param=1]="Param",t[t.Group=2]="Group",t})({});var rt=(function(t){return t[t.Static=0]="Static",t[t.Param=1]="Param",t[t.ParamRegExp=2]="ParamRegExp",t[t.ParamRegExpEnd=3]="ParamRegExpEnd",t[t.EscapeNext=4]="EscapeNext",t})(rt||{});const rM={type:Sr.Static,value:""},iM=/[a-zA-Z0-9_]/;function oM(t){if(!t)return[[]];if(t==="/")return[[rM]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(g){throw new Error(`ERR (${n})/"${u}": ${g}`)}let n=rt.Static,s=n;const r=[];let i;function o(){i&&r.push(i),i=[]}let a=0,l,u="",h="";function d(){u&&(n===rt.Static?i.push({type:Sr.Static,value:u}):n===rt.Param||n===rt.ParamRegExp||n===rt.ParamRegExpEnd?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:Sr.Param,value:u,regexp:h,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),u="")}function m(){u+=l}for(;a<t.length;){if(l=t[a++],l==="\\"&&n!==rt.ParamRegExp){s=n,n=rt.EscapeNext;continue}switch(n){case rt.Static:l==="/"?(u&&d(),o()):l===":"?(d(),n=rt.Param):m();break;case rt.EscapeNext:m(),n=s;break;case rt.Param:l==="("?n=rt.ParamRegExp:iM.test(l)?m():(d(),n=rt.Static,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case rt.ParamRegExp:l===")"?h[h.length-1]=="\\"?h=h.slice(0,-1)+l:n=rt.ParamRegExpEnd:h+=l;break;case rt.ParamRegExpEnd:d(),n=rt.Static,l!=="*"&&l!=="?"&&l!=="+"&&a--,h="";break;default:e("Unknown state");break}}return n===rt.ParamRegExp&&e(`Unfinished custom RegExp for param "${u}"`),d(),o(),r}const sy="[^/]+?",aM={sensitive:!1,strict:!1,start:!0,end:!0};var Mt=(function(t){return t[t._multiplier=10]="_multiplier",t[t.Root=90]="Root",t[t.Segment=40]="Segment",t[t.SubSegment=30]="SubSegment",t[t.Static=40]="Static",t[t.Dynamic=20]="Dynamic",t[t.BonusCustomRegExp=10]="BonusCustomRegExp",t[t.BonusWildcard=-50]="BonusWildcard",t[t.BonusRepeatable=-20]="BonusRepeatable",t[t.BonusOptional=-8]="BonusOptional",t[t.BonusStrict=.7000000000000001]="BonusStrict",t[t.BonusCaseSensitive=.25]="BonusCaseSensitive",t})(Mt||{});const cM=/[.+*?^${}()[\]/\\]/g;function lM(t,e){const n=be({},aM,e),s=[];let r=n.start?"^":"";const i=[];for(const u of t){const h=u.length?[]:[Mt.Root];n.strict&&!u.length&&(r+="/");for(let d=0;d<u.length;d++){const m=u[d];let g=Mt.Segment+(n.sensitive?Mt.BonusCaseSensitive:0);if(m.type===Sr.Static)d||(r+="/"),r+=m.value.replace(cM,"\\$&"),g+=Mt.Static;else if(m.type===Sr.Param){const{value:S,repeatable:P,optional:N,regexp:O}=m;i.push({name:S,repeatable:P,optional:N});const B=O||sy;if(B!==sy){g+=Mt.BonusCustomRegExp;try{`${B}`}catch($){throw new Error(`Invalid custom RegExp for param "${S}" (${B}): `+$.message)}}let q=P?`((?:${B})(?:/(?:${B}))*)`:`(${B})`;d||(q=N&&u.length<2?`(?:/${q})`:"/"+q),N&&(q+="?"),r+=q,g+=Mt.Dynamic,N&&(g+=Mt.BonusOptional),P&&(g+=Mt.BonusRepeatable),B===".*"&&(g+=Mt.BonusWildcard)}h.push(g)}s.push(h)}if(n.strict&&n.end){const u=s.length-1;s[u][s[u].length-1]+=Mt.BonusStrict}n.strict||(r+="/?"),n.end?r+="$":n.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function a(u){const h=u.match(o),d={};if(!h)return null;for(let m=1;m<h.length;m++){const g=h[m]||"",S=i[m-1];d[S.name]=g&&S.repeatable?g.split("/"):g}return d}function l(u){let h="",d=!1;for(const m of t){(!d||!h.endsWith("/"))&&(h+="/"),d=!1;for(const g of m)if(g.type===Sr.Static)h+=g.value;else if(g.type===Sr.Param){const{value:S,repeatable:P,optional:N}=g,O=S in u?u[S]:"";if(Rn(O)&&!P)throw new Error(`Provided param "${S}" is an array but it is not repeatable (* or + modifiers)`);const B=Rn(O)?O.join("/"):O;if(!B)if(N)m.length<2&&(h.endsWith("/")?h=h.slice(0,-1):d=!0);else throw new Error(`Missing required param "${S}"`);h+=B}}return h||"/"}return{re:o,score:s,keys:i,parse:a,stringify:l}}function uM(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===Mt.Static+Mt.Segment?-1:1:t.length>e.length?e.length===1&&e[0]===Mt.Static+Mt.Segment?1:-1:0}function Cw(t,e){let n=0;const s=t.score,r=e.score;for(;n<s.length&&n<r.length;){const i=uM(s[n],r[n]);if(i)return i;n++}if(Math.abs(r.length-s.length)===1){if(ry(s))return 1;if(ry(r))return-1}return r.length-s.length}function ry(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const hM={strict:!1,end:!0,sensitive:!1};function fM(t,e,n){const s=lM(oM(t.path),n),r=be(s,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function dM(t,e){const n=[],s=new Map;e=Y_(hM,e);function r(d){return s.get(d)}function i(d,m,g){const S=!g,P=oy(d);P.aliasOf=g&&g.record;const N=Y_(e,d),O=[P];if("alias"in d){const $=typeof d.alias=="string"?[d.alias]:d.alias;for(const ee of $)O.push(oy(be({},P,{components:g?g.record.components:P.components,path:ee,aliasOf:g?g.record:P})))}let B,q;for(const $ of O){const{path:ee}=$;if(m&&ee[0]!=="/"){const oe=m.record.path,C=oe[oe.length-1]==="/"?"":"/";$.path=m.record.path+(ee&&C+ee)}if(B=fM($,m,N),g?g.alias.push(B):(q=q||B,q!==B&&q.alias.push(B),S&&d.name&&!ay(B)&&o(d.name)),Sw(B)&&l(B),P.children){const oe=P.children;for(let C=0;C<oe.length;C++)i(oe[C],B,g&&g.children[C])}g=g||B}return q?()=>{o(q)}:Uo}function o(d){if(ww(d)){const m=s.get(d);m&&(s.delete(d),n.splice(n.indexOf(m),1),m.children.forEach(o),m.alias.forEach(o))}else{const m=n.indexOf(d);m>-1&&(n.splice(m,1),d.record.name&&s.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function a(){return n}function l(d){const m=gM(d,n);n.splice(m,0,d),d.record.name&&!ay(d)&&s.set(d.record.name,d)}function u(d,m){let g,S={},P,N;if("name"in d&&d.name){if(g=s.get(d.name),!g)throw Pi(ze.MATCHER_NOT_FOUND,{location:d});N=g.record.name,S=be(iy(m.params,g.keys.filter(q=>!q.optional).concat(g.parent?g.parent.keys.filter(q=>q.optional):[]).map(q=>q.name)),d.params&&iy(d.params,g.keys.map(q=>q.name))),P=g.stringify(S)}else if(d.path!=null)P=d.path,g=n.find(q=>q.re.test(P)),g&&(S=g.parse(P),N=g.record.name);else{if(g=m.name?s.get(m.name):n.find(q=>q.re.test(m.path)),!g)throw Pi(ze.MATCHER_NOT_FOUND,{location:d,currentLocation:m});N=g.record.name,S=be({},m.params,d.params),P=g.stringify(S)}const O=[];let B=g;for(;B;)O.unshift(B.record),B=B.parent;return{name:N,path:P,params:S,matched:O,meta:mM(O)}}t.forEach(d=>i(d));function h(){n.length=0,s.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:h,getRoutes:a,getRecordMatcher:r}}function iy(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function oy(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:pM(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function pM(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="object"?n[s]:n;return e}function ay(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function mM(t){return t.reduce((e,n)=>be(e,n.meta),{})}function gM(t,e){let n=0,s=e.length;for(;n!==s;){const i=n+s>>1;Cw(t,e[i])<0?s=i:n=i+1}const r=_M(t);return r&&(s=e.lastIndexOf(r,s-1)),s}function _M(t){let e=t;for(;e=e.parent;)if(Sw(e)&&Cw(t,e)===0)return e}function Sw({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function cy(t){const e=on(uu),n=on(tp),s=it(()=>{const l=qs(t.to);return e.resolve(l)}),r=it(()=>{const{matched:l}=s.value,{length:u}=l,h=l[u-1],d=n.matched;if(!h||!d.length)return-1;const m=d.findIndex(bi.bind(null,h));if(m>-1)return m;const g=ly(l[u-2]);return u>1&&ly(h)===g&&d[d.length-1].path!==g?d.findIndex(bi.bind(null,l[u-2])):m}),i=it(()=>r.value>-1&&IM(n.params,s.value.params)),o=it(()=>r.value>-1&&r.value===n.matched.length-1&&Iw(n.params,s.value.params));function a(l={}){if(TM(l)){const u=e[qs(t.replace)?"replace":"push"](qs(t.to)).catch(Uo);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:s,href:it(()=>s.value.href),isActive:i,isExactActive:o,navigate:a}}function yM(t){return t.length===1?t[0]:t}const EM=Xy({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:cy,setup(t,{slots:e}){const n=la(cy(t)),{options:s}=on(uu),r=it(()=>({[uy(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[uy(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&yM(e.default(n));return t.custom?i:Nf("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},i)}}}),vM=EM;function TM(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function IM(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(!Rn(r)||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function ly(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const uy=(t,e,n)=>t??e??n,wM=Xy({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const s=on(ff),r=it(()=>t.route||s.value),i=on(ty,0),o=it(()=>{let u=qs(i);const{matched:h}=r.value;let d;for(;(d=h[u])&&!d.components;)u++;return u}),a=it(()=>r.value.matched[o.value]);ic(ty,it(()=>o.value+1)),ic(JV,a),ic(ff,r);const l=is();return Co(()=>[l.value,a.value,t.name],([u,h,d],[m,g,S])=>{h&&(h.instances[d]=u,g&&g!==h&&u&&u===m&&(h.leaveGuards.size||(h.leaveGuards=g.leaveGuards),h.updateGuards.size||(h.updateGuards=g.updateGuards))),u&&h&&(!g||!bi(h,g)||!m)&&(h.enterCallbacks[d]||[]).forEach(P=>P(u))},{flush:"post"}),()=>{const u=r.value,h=t.name,d=a.value,m=d&&d.components[h];if(!m)return hy(n.default,{Component:m,route:u});const g=d.props[h],S=g?g===!0?u.params:typeof g=="function"?g(u):g:null,N=Nf(m,be({},S,e,{onVnodeUnmounted:O=>{O.component.isUnmounted&&(d.instances[h]=null)},ref:l}));return hy(n.default,{Component:N,route:u})||N}}});function hy(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const AM=wM;function RM(t){const e=dM(t.routes,t),n=t.parseQuery||YV,s=t.stringifyQuery||ey,r=t.history,i=ho(),o=ho(),a=ho(),l=kA(ks);let u=ks;ni&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const h=ih.bind(null,M=>""+M),d=ih.bind(null,OV),m=ih.bind(null,aa);function g(M,J){let Y,te;return ww(M)?(Y=e.getRecordMatcher(M),te=J):te=M,e.addRoute(te,Y)}function S(M){const J=e.getRecordMatcher(M);J&&e.removeRoute(J)}function P(){return e.getRoutes().map(M=>M.record)}function N(M){return!!e.getRecordMatcher(M)}function O(M,J){if(J=be({},J||l.value),typeof M=="string"){const b=oh(n,M,J.path),L=e.resolve({path:b.path},J),U=r.createHref(b.fullPath);return be(b,L,{params:m(L.params),hash:aa(b.hash),redirectedFrom:void 0,href:U})}let Y;if(M.path!=null)Y=be({},M,{path:oh(n,M.path,J.path).path});else{const b=be({},M.params);for(const L in b)b[L]==null&&delete b[L];Y=be({},M,{params:d(b)}),J.params=d(J.params)}const te=e.resolve(Y,J),_e=M.hash||"";te.params=h(m(te.params));const T=MV(s,be({},M,{hash:NV(_e),path:te.path})),R=r.createHref(T);return be({fullPath:T,hash:_e,query:s===ey?XV(M.query):M.query||{}},te,{redirectedFrom:void 0,href:R})}function B(M){return typeof M=="string"?oh(n,M,l.value.path):be({},M)}function q(M,J){if(u!==M)return Pi(ze.NAVIGATION_CANCELLED,{from:J,to:M})}function $(M){return C(M)}function ee(M){return $(be(B(M),{replace:!0}))}function oe(M,J){const Y=M.matched[M.matched.length-1];if(Y&&Y.redirect){const{redirect:te}=Y;let _e=typeof te=="function"?te(M,J):te;return typeof _e=="string"&&(_e=_e.includes("?")||_e.includes("#")?_e=B(_e):{path:_e},_e.params={}),be({query:M.query,hash:M.hash,params:_e.path!=null?{}:M.params},_e)}}function C(M,J){const Y=u=O(M),te=l.value,_e=M.state,T=M.force,R=M.replace===!0,b=oe(Y,te);if(b)return C(be(B(b),{state:typeof b=="object"?be({},_e,b.state):_e,force:T,replace:R}),J||Y);const L=Y;L.redirectedFrom=J;let U;return!T&&LV(s,te,Y)&&(U=Pi(ze.NAVIGATION_DUPLICATED,{to:L,from:te}),Gt(te,te,!0,!1)),(U?Promise.resolve(U):A(L,te)).catch(V=>zn(V)?zn(V,ze.NAVIGATION_GUARD_REDIRECT)?V:Cn(V):Te(V,L,te)).then(V=>{if(V){if(zn(V,ze.NAVIGATION_GUARD_REDIRECT))return C(be({replace:R},B(V.to),{state:typeof V.to=="object"?be({},_e,V.to.state):_e,force:T}),J||L)}else V=I(L,te,!0,R,_e);return w(L,te,V),V})}function E(M,J){const Y=q(M,J);return Y?Promise.reject(Y):Promise.resolve()}function y(M){const J=hn.values().next().value;return J&&typeof J.runWithContext=="function"?J.runWithContext(M):M()}function A(M,J){let Y;const[te,_e,T]=ZV(M,J);Y=ch(te.reverse(),"beforeRouteLeave",M,J);for(const b of te)b.leaveGuards.forEach(L=>{Y.push(Ms(L,M,J))});const R=E.bind(null,M,J);return Y.push(R),vt(Y).then(()=>{Y=[];for(const b of i.list())Y.push(Ms(b,M,J));return Y.push(R),vt(Y)}).then(()=>{Y=ch(_e,"beforeRouteUpdate",M,J);for(const b of _e)b.updateGuards.forEach(L=>{Y.push(Ms(L,M,J))});return Y.push(R),vt(Y)}).then(()=>{Y=[];for(const b of T)if(b.beforeEnter)if(Rn(b.beforeEnter))for(const L of b.beforeEnter)Y.push(Ms(L,M,J));else Y.push(Ms(b.beforeEnter,M,J));return Y.push(R),vt(Y)}).then(()=>(M.matched.forEach(b=>b.enterCallbacks={}),Y=ch(T,"beforeRouteEnter",M,J,y),Y.push(R),vt(Y))).then(()=>{Y=[];for(const b of o.list())Y.push(Ms(b,M,J));return Y.push(R),vt(Y)}).catch(b=>zn(b,ze.NAVIGATION_CANCELLED)?b:Promise.reject(b))}function w(M,J,Y){a.list().forEach(te=>y(()=>te(M,J,Y)))}function I(M,J,Y,te,_e){const T=q(M,J);if(T)return T;const R=J===ks,b=ni?history.state:{};Y&&(te||R?r.replace(M.fullPath,be({scroll:R&&b&&b.scroll},_e)):r.push(M.fullPath,_e)),l.value=M,Gt(M,J,Y,R),Cn()}let v;function ve(){v||(v=r.listen((M,J,Y)=>{if(!fn.listening)return;const te=O(M),_e=oe(te,fn.currentRoute.value);if(_e){C(be(_e,{replace:!0,force:!0}),te).catch(Uo);return}u=te;const T=l.value;ni&&$V(Z_(T.fullPath,Y.delta),lu()),A(te,T).catch(R=>zn(R,ze.NAVIGATION_ABORTED|ze.NAVIGATION_CANCELLED)?R:zn(R,ze.NAVIGATION_GUARD_REDIRECT)?(C(be(B(R.to),{force:!0}),te).then(b=>{zn(b,ze.NAVIGATION_ABORTED|ze.NAVIGATION_DUPLICATED)&&!Y.delta&&Y.type===uf.pop&&r.go(-1,!1)}).catch(Uo),Promise.reject()):(Y.delta&&r.go(-Y.delta,!1),Te(R,te,T))).then(R=>{R=R||I(te,T,!1),R&&(Y.delta&&!zn(R,ze.NAVIGATION_CANCELLED)?r.go(-Y.delta,!1):Y.type===uf.pop&&zn(R,ze.NAVIGATION_ABORTED|ze.NAVIGATION_DUPLICATED)&&r.go(-1,!1)),w(te,T,R)}).catch(Uo)}))}let Ge=ho(),De=ho(),de;function Te(M,J,Y){Cn(M);const te=De.list();return te.length?te.forEach(_e=>_e(M,J,Y)):console.error(M),Promise.reject(M)}function jt(){return de&&l.value!==ks?Promise.resolve():new Promise((M,J)=>{Ge.add([M,J])})}function Cn(M){return de||(de=!M,ve(),Ge.list().forEach(([J,Y])=>M?Y(M):J()),Ge.reset()),M}function Gt(M,J,Y,te){const{scrollBehavior:_e}=t;if(!ni||!_e)return Promise.resolve();const T=!Y&&GV(Z_(M.fullPath,0))||(te||!Y)&&history.state&&history.state.scroll||null;return vl().then(()=>_e(M,J,T)).then(R=>R&&WV(R)).catch(R=>Te(R,M,J))}const pt=M=>r.go(M);let $n;const hn=new Set,fn={currentRoute:l,listening:!0,addRoute:g,removeRoute:S,clearRoutes:e.clearRoutes,hasRoute:N,getRoutes:P,resolve:O,options:t,push:$,replace:ee,go:pt,back:()=>pt(-1),forward:()=>pt(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:De.add,isReady:jt,install(M){M.component("RouterLink",vM),M.component("RouterView",AM),M.config.globalProperties.$router=fn,Object.defineProperty(M.config.globalProperties,"$route",{enumerable:!0,get:()=>qs(l)}),ni&&!$n&&l.value===ks&&($n=!0,$(r.location).catch(te=>{}));const J={};for(const te in ks)Object.defineProperty(J,te,{get:()=>l.value[te],enumerable:!0});M.provide(uu,fn),M.provide(tp,Ly(J)),M.provide(ff,l);const Y=M.unmount;hn.add(M),M.unmount=function(){hn.delete(M),hn.size<1&&(u=ks,v&&v(),v=null,l.value=ks,$n=!1,de=!1),Y()}}};function vt(M){return M.reduce((J,Y)=>J.then(()=>y(Y)),Promise.resolve())}return fn}function eL(){return on(uu)}function tL(t){return on(tp)}const CM=()=>cu(()=>import("./LoginPage-Lbv75vD2.js"),__vite__mapDeps([0,1,2])),SM=()=>cu(()=>import("./RegisterPage-DY-lMGyp.js"),__vite__mapDeps([3,1,4])),bM=()=>cu(()=>import("./DashboardPage-CY5k7_dd.js"),__vite__mapDeps([5,6,1,7])),PM=()=>cu(()=>import("./CampaignPage-BFzve2pE.js"),__vite__mapDeps([8,6,1,9])),NM=[{path:"/",redirect:"/dashboard"},{path:"/login",name:"Login",component:CM,meta:{requiresGuest:!0}},{path:"/register",name:"Register",component:SM,meta:{requiresGuest:!0}},{path:"/dashboard",name:"Dashboard",component:bM,meta:{requiresAuth:!0}},{path:"/campaign/:id",name:"Campaign",component:PM,meta:{requiresAuth:!0}}],bw=RM({history:sM(),routes:NM});bw.beforeEach(async(t,e,n)=>{const s=au();s.loading&&await new Promise(i=>{const o=s.$subscribe((a,l)=>{l.loading||(o(),i())})});const r=s.isAuthenticated;t.meta.requiresAuth&&!r?n({name:"Login"}):t.meta.requiresGuest&&r?n({name:"Dashboard"}):n()});const np=PC(_V),kM=DC();np.use(kM);np.use(bw);const DM=au();DM.initAuthListener();np.mount("#app");export{xN as A,XM as B,YM as C,nc as D,zM as E,Xt as F,ZM as G,ON as H,Eo as I,QM as J,it as K,Co as L,vl as M,nE as N,gf as O,VM as P,UM as Q,la as R,tL as S,LM as T,sc as U,$M as V,JM as W,kN as X,Sc as a,MM as b,am as c,OM as d,qs as e,Wt as f,WA as g,oR as h,eL as i,qR as j,uo as k,eE as l,Cc as m,_f as n,li as o,xM as p,kE as q,is as r,WM as s,uA as t,au as u,FM as v,BM as w,KM as x,GM as y,HM as z};
