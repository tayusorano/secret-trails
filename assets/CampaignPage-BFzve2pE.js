import{q as $e,u as de,k as ve,r as h,s as Le,x as tt,y as st,z as N,A as be,B as re,C as ce,D as q,E as me,G as Me,H as Ie,I as oe,J as ke,c as o,o as l,a as e,t as v,b as I,n as z,e as x,F as D,j as se,K as B,L as fe,l as qe,M as Ae,N as Ee,O as we,p as R,w as Q,d as S,v as H,P as at,f as Z,g as F,T as lt,Q as K,m as Y,R as nt,S as ot,i as rt}from"./index-2DRtKDq1.js";import{u as it}from"./campaigns-DDFTsJkA.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ue=$e("chat",()=>{const b=de(),k=ve(),f=h([]),w=h(!1),m=h(null);let $=null;function C(M){$&&$(),w.value=!0;const n=Le(N(q,"campaigns",M,"chat"),st("createdAt","asc"),tt(100));$=be(n,u=>{f.value=u.docs.map(s=>({id:s.id,...s.data()})),w.value=!1},u=>{console.error("Chat subscription error:",u),m.value=u.message,w.value=!1})}async function A(M,n,u="message"){if(!b.userId)throw new Error("Not authenticated");try{const s={text:n,type:u,userId:b.userId,userName:k.displayName,userRole:k.userRole,createdAt:re()};await ce(N(q,"campaigns",M,"chat"),s)}catch(s){throw console.error("Failed to send message:",s),m.value=s.message,s}}async function t(M,n,u,s){if(!b.userId)throw new Error("Not authenticated");try{const a={text:`üé≤ ${n} = ${u}`,type:"roll",userId:b.userId,userName:k.displayName,userRole:k.userRole,diceNotation:n,result:u,details:s,createdAt:re()};await ce(N(q,"campaigns",M,"chat"),a)}catch(a){throw console.error("Failed to send dice roll:",a),m.value=a.message,a}}async function T(M){try{w.value=!0;const n=N(q,"campaigns",M,"chat"),u=await me(n),s=Me(q);u.docs.forEach(a=>{s.delete(a.ref)}),await s.commit(),f.value=[],await A(M,"–ß–∞—Ç –±—ã–ª –æ—á–∏—â–µ–Ω","system")}catch(n){throw console.error("Failed to clear chat:",n),m.value=n.message,n}finally{w.value=!1}}function V(){$&&($(),$=null),f.value=[]}return{messages:f,loading:w,error:m,subscribeToChat:C,sendMessage:A,sendDiceRoll:t,clearChat:T,unsubscribeFromChat:V}}),Ce=$e("characters",()=>{const b=h([]),k=h(!1),f=h(null);let w=null;const m={human:{name:"–ß–µ–ª–æ–≤–µ–∫",ability:"–ò–∑–ª–∏—à–Ω—è—è –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å",description:"–° —à–∞–Ω—Å–æ–º 2-–∏–∑-6 –ª—é–¥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–º–µ—á–∞—é—Ç —Å–∫—Ä—ã—Ç—ã–µ –ª–æ–≤—É—à–∫–∏ –≤ <b>—è—Ä–∫–æ –æ—Å–≤–µ—â—ë–Ω–Ω–æ–π</b> –æ–±–ª–∞—Å—Ç–∏ —Ä–∞–¥–∏—É—Å–æ–º 30'. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–Ω–∏ –ø–æ–ª—É—á–∞—é—Ç –Ω–∞ 10% –±–æ–ª—å—à–µ –û–û."},gmur:{name:"–ì–º—É—Ä",ability:"–ö–∞–º–Ω–µ—Ä–æ–∂–¥—ë–Ω–Ω—ã–π",description:"–ì–º—É—Ä—ã –ø–æ–ª—É—á–∞—é—Ç 1 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–º–µ—Å–ª–æ: <i>—à–∞—Ö—Ç—ë—Ä</i> –∏–ª–∏ <i>–∫—É–∑–Ω–µ—Ü</i>. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–Ω–∏ —Å–æ–≤–µ—Ä—à–∞—é—Ç –±—Ä–æ—Å–æ–∫ 2 –∫–æ—Å—Ç–µ–π –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –û–ó, –≤—ã–±–∏—Ä–∞—è –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞ –∫–∞–∂–¥—ã–π –£–†."},div:{name:"–î–∏–≤—å",ability:"–ú–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å",description:"–° —à–∞–Ω—Å–æ–º 2-–∏–∑-6 –¥–∏–≤—å–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–º–µ—á–∞—é—Ç —Å–∫—Ä—ã—Ç—ã–µ –º–∞–≥–∏–µ–π –ø—Ä–æ—Ö–æ–¥—ã –∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–≤–µ—Ä–∏ –≤ <b>—è—Ä–∫–æ –æ—Å–≤–µ—â—ë–Ω–Ω–æ–π</b> –æ–±–ª–∞—Å—Ç–∏ —Ä–∞–¥–∏—É—Å–æ–º 30'. –ï—Å–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —É –Ω–µ–≥–æ –µ—Å—Ç—å –æ—á–∫–∏ –†–ó–ú, –∏–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –∫–Ω–∏–≥–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π, –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∏—Ö —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º."}},$={stk:{5:{name:"–®–∫–≤–∞–ª —É–¥–∞—Ä–æ–≤",description:"–ü–ò –º–æ–∂–µ—Ç —Å–æ–≤–µ—Ä—à–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∞—Ç–∞–∫—É –≤ —Å–≤–æ–π —Ö–æ–¥ —á–∞—Å—Ç—å—é –æ–¥–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è. –ê—Ç–∞–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞–Ω–µ—Å–µ–Ω—ã <b>–æ–¥–Ω–∏–º –∏ —Ç–µ–º –∂–µ –æ—Ä—É–∂–∏–µ–º</b> (<i>–∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è –ø–∞—Ä–Ω–æ–µ –æ—Ä—É–∂–∏–µ –∏ –±–µ–∑–æ—Ä—É–∂–Ω—ã–µ –∞—Ç–∞–∫–∏</i>). –ù–µ –¥–µ–π—Å—Ç–≤—É–µ—Ç —Å–æ —Å–∫—Ä—ã—Ç–æ–π –∏–ª–∏ —Ä–∞–∑—Ä—É—à–∏—Ç–µ–ª—å–Ω–æ–π –∞—Ç–∞–∫–æ–π."},10:{name:"–°—Ç–∏—Å–Ω—É—Ç—å –∑—É–±—ã",description:"–ü–ò –º–æ–∂–µ—Ç –ø–æ–≤—ã—Å–∏—Ç—å —Å–≤–æ–π –±–æ–ª–µ–≤–æ–π –ø–æ—Ä–æ–≥ –Ω–∞ 6 —Ä–∞—É–Ω–¥–æ–≤, –ø–æ–ª—É—á–∞—è –≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ —É—Ä–æ–Ω–∞ –æ—Ç –Ω–µ–º–∞–≥–∏—á–µ—Å–∫–∏—Ö –∞—Ç–∞–∫ –∏ –æ–≥–Ω—è. –í —ç—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –æ–Ω –Ω–µ –º–æ–∂–µ—Ç –≥–æ–≤–æ—Ä–∏—Ç—å, –∞ –≤—Å–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –µ–≥–æ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π –ø—Ä–µ–∫—Ä–∞—â–∞—é—Ç—Å—è. –ï—Å–ª–∏ –ü–ò –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç—É —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤ —Ç–µ—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –¥–Ω—è, –æ–Ω –ø–æ–ª—É—á–∏—Ç 1–∫4 —Ä–∞–Ω –∑–∞ –∫–∞–∂–¥–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ."}},lvk:{5:{name:"–õ–æ–≤–∫–∏–π —É–¥–∞—Ä",description:"–ü—Ä–∏ –ø—Ä–æ–º–∞—Ö–µ <b>–æ—Ä—É–∂–∏–µ–º –±–ª–∏–∂–Ω–µ–≥–æ –±–æ—è</b> –ü–ò –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∞—Ç–∞–∫—É –ª–æ–≤–∫–∏–º —É–¥–∞—Ä–æ–º. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Å—Ç–∏ –æ–¥–Ω—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∞—Ç–∞–∫—É –≤ —Å–≤–æ–π —Ö–æ–¥ <b>—Ç–µ–º –∂–µ –æ—Ä—É–∂–∏–µ–º</b>. –ü—Ä–∏ –≤—ã–ø–∞–¥–µ–Ω–∏–∏ 1 –≤–æ –≤—Ä–µ–º—è –±—Ä–æ—Å–∫–∞ –Ω–∞ –ø–æ–ø–∞–¥–∞–Ω–∏–µ –æ—Ä—É–∂–∏–µ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –ª–æ–º–∞–µ—Ç—Å—è –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–±—Ä–æ—Å–∞. –ë–∞–∑–æ–≤–∞—è –°–ö–† —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 5'."},10:{name:"–ü–æ–¥–ª—ã–π –ø—Ä–∏—ë–º",description:"–ï—Å–ª–∏ —É –ü–ò –µ—Å—Ç—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –Ω–∞ –∞—Ç–∞–∫—É –æ—Ä—É–∂–∏–µ–º –±–ª–∏–∂–Ω–µ–≥–æ –∏–ª–∏ –¥–∞–ª—å–Ω–µ–≥–æ –±–æ—è, —Ç–æ –æ–Ω –º–æ–∂–µ—Ç –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –Ω–µ–≥–æ, —á—Ç–æ–±—ã —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Å—Ç–µ–π —É—Ä–æ–Ω–∞ –æ—Ä—É–∂–∏—è –Ω–∞ –æ–¥–Ω—É. –ù–µ –¥–µ–π—Å—Ç–≤—É–µ—Ç —Å–æ —Å–∫—Ä—ã—Ç–æ–π –∏–ª–∏ —Ä–∞–∑—Ä—É—à–∏—Ç–µ–ª—å–Ω–æ–π –∞—Ç–∞–∫–æ–π. –ë–∞–∑–æ–≤–∞—è –°–ö–† —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –µ—â—ë –Ω–∞ 5'."}},rzm:{5:[{name:"–ü—Ä–æ—è–≤–ª–µ–Ω–∏–µ –≤–æ–ª–∏",description:"–ü–ò –º–æ–∂–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ–º –∑–∞—â–∏—Ç–∏—Ç—å —Å–µ–±—è –æ—Ç 1–∫6 –±–ª–∏–∂–∞–π—à–∏—Ö –Ω–µ–¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—É—â–µ—Å—Ç–≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–≥–æ –ú–í –Ω–∞ 1 —Ö–æ–¥. –ü–æ—Ä–∞–∂—ë–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤–∞ –¥–æ–ª–∂–Ω—ã —Å–æ–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –†–ó–ú (<i>—Å–ª–æ–∂–Ω–æ—Å—Ç—å 11 + –†–ó–ú –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</i>) —Å –±–æ–Ω—É—Å–æ–º, —Ä–∞–≤–Ω—ã–º –∏—Ö –£–†. –ü—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ —Ü–µ–ª—å –≤—ã–Ω—É–∂–¥–µ–Ω–∞ –¥–µ—Ä–∂–∞—Ç—å—Å—è –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ 10' –æ—Ç –ü–ò (–µ—Å–ª–∏ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ), –Ω–µ –ø—Ä–∏—á–∏–Ω—è—Ç—å –µ–º—É –≤—Ä–µ–¥–∞ –∏ –Ω–µ –≤—Å—Ç—É–ø–∞—Ç—å —Å –Ω–∏–º –≤ –∫–æ–Ω—Ç–∞–∫—Ç, –µ—Å–ª–∏ –æ–Ω —Å–∞–º –µ—ë –Ω–µ —Å–ø—Ä–æ–≤–æ—Ü–∏—Ä—É–µ—Ç. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –†–ó–ú —Ä–∞–∑ –≤ –¥–µ–Ω—å. –ü–ò –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ú–í <b>–ø–æ—Ä—è–¥–æ–∫</b> –∏–ª–∏ <b>—Ö–∞–æ—Å</b>, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ —É–º–µ–Ω–∏–µ. –í —Å–ª—É—á–∞–µ —Å–º–µ–Ω—ã –ú–í –Ω–∞ <b>–±–∞–ª–∞–Ω—Å</b>, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ <b>–ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞</b>."},{name:"–ü—Ä–æ—è–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞",description:"–ü–ò —Å–≤—è–∑—ã–≤–∞–µ—Ç —Å–≤–æ—é –¥—É—à—É —Å –º–∞–ª—ã–º –¥—É—Ö–æ–º-—Ñ–∞–º–∏–ª—å—è—Ä–æ–º. –í—Å—ë, –Ω–∞ —á—Ç–æ —Å–ø–æ—Å–æ–±–µ–Ω –¥—É—Ö ‚Äì –∏—Å—Ü–µ–ª—è—Ç—å 1–∫8 –û–ó —Å–æ–≥–ª–∞—Å–Ω–æ–≥–æ —Å—É—â–µ—Å—Ç–≤–∞ –∏–ª–∏ 1 —Ä–∞–Ω—É, –Ω–∞–Ω–æ—Å—è –≤–ª–∞–¥–µ–ª—å—Ü—É 1 —Ä–∞–Ω—É –∑–∞ –∫–∞–∂–¥–æ–µ –∏—Å—Ü–µ–ª–µ–Ω–∏–µ. –ü–ò –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ú–í <b>–±–∞–ª–∞–Ω—Å</b>, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ —É–º–µ–Ω–∏–µ. –í —Å–ª—É—á–∞–µ —Å–º–µ–Ω—ã –ú–í –Ω–∞ <b>–ø–æ—Ä—è–¥–æ–∫</b> –∏–ª–∏ <b>—Ö–∞–æ—Å</b> –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ <b>–ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ –≤–æ–ª–∏</b>."}],10:{name:"–ú–∞–≥–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ",description:"–ü–ò –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–Ω–∏–≥–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π –∏–∑ —Å–≤–∏—Ç–∫–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—É—Å—Ç–∞—è –∫–Ω–∏–≥–∞, –∞ —Ç–∞–∫–∂–µ –æ–¥–Ω–∞ –Ω–µ–¥–µ–ª—è (–∏–ª–∏ 28 –≤–∞—Ö—Ç) –∏ 500 –º–æ–Ω–µ—Ç –∑–∞ –∫–∞–∂–¥—ã–π –∫—Ä—É–≥ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è. –ï—Å–ª–∏ –ü–ò –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ–º —Å–≤–∏—Ç–∫–∞ –Ω–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ, —Ç–æ –æ–Ω –¥–æ–ª–∂–µ–Ω —Å–æ–≤–µ—Ä—à–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –†–ó–ú (<i>—Å–ª–æ–∂–Ω–æ—Å—Ç—å 11 + –∫—Ä—É–≥ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è</i>) –∫–∞–∂–¥—É—é –≤–∞—Ö—Ç—É, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –ø—Ä–æ–¥–≤–∏–Ω—É–ª—Å—è –ª–∏ –æ–Ω –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–Ω–∏–≥–∏ –∏–ª–∏ –Ω–µ—Ç. –ü—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è, —á—Ç–æ –≤–∞—Ö—Ç–∞ –ø–æ—Ç—Ä–∞—á–µ–Ω–∞ –≤–ø—É—Å—Ç—É—é. –í –∫–æ–Ω—Ü–µ –≤—Å–µ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç 1-–∏–∑-6 —à–∞–Ω—Å –Ω–µ—É–¥–∞—á–∏ ‚Äì –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –∏ —Å–≤–∏—Ç–æ–∫ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —É–Ω–∏—á—Ç–æ–∂–∞—é—Ç—Å—è."}},har:{5:{name:"–õ–∏–¥–µ—Ä—Å—Ç–≤–æ",description:"–•–ê–† —Ä–∞–∑ –≤ –¥–µ–Ω—å –ü–ò –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å 1–∫4 –∫ —Å–≤–æ–µ–º—É —Å–ª–µ–¥—É—é—â–µ–º—É –±—Ä–æ—Å–∫—É –∞—Ç–∞–∫–∏ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏. –≠—Ç–æ—Ç –±–æ–Ω—É—Å —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Å–æ—é–∑–Ω–∏–∫—É –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 40', –ø–æ—Ç—Ä–∞—Ç–∏–≤ –¥–µ–π—Å—Ç–≤–∏–µ –≤ —Å–≤–æ–π —Ö–æ–¥."},10:{name:"–í–æ–æ–¥—É—à–µ–≤–ª–µ–Ω–∏–µ",description:"–í—Å–µ –Ω–∞—ë–º–Ω–∏–∫–∏ –ü–ò –ø–æ–ª—É—á–∞—é—Ç +2 –∫ –ë–î (<i>–ø—Ä–∏ –º–∞–∫—Å–∏–º—É–º–µ –≤ 12</i>). –†–∞–∑ –≤ –¥–µ–Ω—å –ü–ò –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ—É—Å–ø–µ—Ç—å –≤ –ª—é–±–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ –ø—Ä–æ—Ç–∏–≤ —Å—Ç—Ä–∞—Ö–∞, –æ—á–∞—Ä–æ–≤–∞–Ω–∏—è, —É—Å—ã–ø–ª–µ–Ω–∏—è –∏ –ø–æ–¥–æ–±–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–∞—Ö, –≤–ª–∏—è—é—â–∏—Ö –Ω–∞ —Ä–∞–∑—É–º, –∏–ª–∏ –ø–æ–º–æ—á—å —Å–æ—é–∑–Ω–∏–∫—É –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 20' –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–¥–æ–ª–µ—Ç—å —ç—Ç–æ—Ç —ç—Ñ—Ñ–µ–∫—Ç."}}};async function C(n,u,s){k.value=!0,f.value=null;try{return{id:(await ce(N(q,"campaigns",n,"characters"),{...u,ownerId:s,createdAt:re()})).id,...u}}catch(a){throw f.value=a.message,a}finally{k.value=!1}}async function A(n,u,s,a){k.value=!0,f.value=null;try{const d=b.value.find(i=>i.id===u);if(!d||d.ownerId!==a)throw new Error("–í—ã –Ω–µ –º–æ–∂–µ—Ç–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞");await Ie(oe(q,"campaigns",n,"characters",u),{...s,updatedAt:re()})}catch(d){throw f.value=d.message,d}finally{k.value=!1}}async function t(n,u,s){k.value=!0,f.value=null;try{const a=b.value.find(d=>d.id===u);if(!a||a.ownerId!==s)throw new Error("–í—ã –Ω–µ –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞");await ke(oe(q,"campaigns",n,"characters",u))}catch(a){throw f.value=a.message,a}finally{k.value=!1}}function T(n){w&&w();const u=Le(N(q,"campaigns",n,"characters"));w=be(u,s=>{b.value=s.docs.map(a=>({id:a.id,...a.data()}))},s=>{f.value=s.message})}function V(){w&&(w(),w=null),b.value=[]}function M(n){return b.value.filter(u=>u.ownerId===n)}return{characters:b,loading:k,error:f,races:m,statAbilities:$,createCharacter:C,updateCharacter:A,deleteCharacter:t,subscribeToCharacters:T,unsubscribeFromCharacters:V,getMyCharacters:M}}),ut={class:"game-sidebar"},ct={class:"sidebar-section"},dt=["title"],vt={class:"toggle-icon"},pt={class:"toggle-label"},mt={class:"sidebar-section"},ft={class:"btn-arrow"},bt={key:0,class:"character-menu"},yt={class:"sidebar-section sidebar-info"},gt={class:"info-item"},ht={class:"info-label"},kt={__name:"GameSidebar",props:{campaignId:{type:String,required:!0}},emits:["toggle-map-type","create-token","create-character","view-sheets","view-my-characters"],setup(b,{emit:k}){const f=k,w=ve(),m=h("global"),$=h(!1);function C(){m.value=m.value==="global"?"local":"global",f("toggle-map-type",m.value)}function A(){$.value=!$.value}function t(){f("create-token")}function T(){f("view-sheets")}function V(){f("view-my-characters")}function M(){f("create-character")}return(n,u)=>(l(),o("div",ut,[e("div",ct,[e("button",{class:"map-toggle",onClick:C,title:m.value==="global"?"–ì–ª–æ–±–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞":"–ö–∞—Ä—Ç–∞ –º–µ—Å—Ç–Ω–æ—Å—Ç–∏"},[e("span",vt,v(m.value==="global"?"üåç":"üó∫Ô∏è"),1),e("span",pt,v(m.value==="global"?"–ì–ª–æ–±–∞–ª—å–Ω–∞—è":"–ú–µ—Å—Ç–Ω–æ—Å—Ç—å"),1)],8,dt)]),e("div",mt,[e("button",{class:z(["characters-btn",{active:$.value}]),onClick:A},[u[0]||(u[0]=e("span",{class:"btn-icon"},"üë•",-1)),u[1]||(u[1]=e("span",{class:"btn-label"},"–ü–µ—Ä—Å–æ–Ω–∞–∂–∏",-1)),e("span",ft,v($.value?"‚ñ≤":"‚ñº"),1)],2),$.value?(l(),o("div",bt,[x(w).isGM?(l(),o(D,{key:0},[e("button",{class:"menu-item",onClick:t},[...u[2]||(u[2]=[e("span",null,"‚ú®",-1),se(" –°–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω ",-1)])]),e("button",{class:"menu-item",onClick:T},[...u[3]||(u[3]=[e("span",null,"üìã",-1),se(" –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–∏—Å—Ç—ã ",-1)])])],64)):(l(),o(D,{key:1},[e("button",{class:"menu-item",onClick:M},[...u[4]||(u[4]=[e("span",null,"‚ú®",-1),se(" –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ ",-1)])]),e("button",{class:"menu-item",onClick:t},[...u[5]||(u[5]=[e("span",null,"üé≠",-1),se(" –°–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω ",-1)])]),e("button",{class:"menu-item",onClick:V},[...u[6]||(u[6]=[e("span",null,"üìú",-1),se(" –ú–æ–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏ ",-1)])])],64))])):I("",!0)]),u[8]||(u[8]=e("div",{class:"sidebar-divider"},null,-1)),e("div",yt,[e("div",gt,[u[7]||(u[7]=e("span",{class:"info-icon"},"üé≠",-1)),e("span",ht,v(x(w).isGM?"–ú–∞—Å—Ç–µ—Ä":"–ò–≥—Ä–æ–∫"),1)])])]))}},wt=ae(kt,[["__scopeId","data-v-f747d9cd"]]),$t=$e("drawings",()=>{const b=de(),k=h([]),f=h([]),w=h(!1),m=h(null);let $=null,C=null;function A(a){$&&$(),C&&C(),w.value=!0,$=be(N(q,"campaigns",a,"drawings"),d=>{k.value=d.docs.map(i=>({id:i.id,...i.data()})),w.value=!1},d=>{console.error("Drawings subscription error:",d),m.value=d.message,w.value=!1}),C=be(N(q,"campaigns",a,"texts"),d=>{f.value=d.docs.map(i=>({id:i.id,...i.data()}))},d=>{console.error("Texts subscription error:",d),m.value=d.message})}async function t(a,d){try{const i={...d,userId:b.userId,createdAt:re()};await ce(N(q,"campaigns",a,"drawings"),i)}catch(i){throw console.error("Failed to save drawing:",i),m.value=i.message,i}}async function T(a,d){try{const i={...d,userId:b.userId,createdAt:re()};await ce(N(q,"campaigns",a,"texts"),i)}catch(i){throw console.error("Failed to save text:",i),m.value=i.message,i}}async function V(a,d){try{await ke(oe(q,"campaigns",a,"drawings",d))}catch(i){throw console.error("Failed to delete drawing:",i),m.value=i.message,i}}async function M(a,d){try{await ke(oe(q,"campaigns",a,"texts",d))}catch(i){throw console.error("Failed to delete text:",i),m.value=i.message,i}}async function n(a){try{w.value=!0;const d=Me(q);(await me(N(q,"campaigns",a,"drawings"))).docs.forEach(L=>d.delete(L.ref)),(await me(N(q,"campaigns",a,"texts"))).docs.forEach(L=>d.delete(L.ref)),await d.commit(),k.value=[],f.value=[]}catch(d){throw console.error("Failed to clear drawings:",d),m.value=d.message,d}finally{w.value=!1}}async function u(a,d){try{w.value=!0;const i=Me(q);(await me(N(q,"campaigns",a,"drawings"))).docs.forEach(W=>{const J=W.data();(J.mapType===d||!J.mapType&&d==="global")&&i.delete(W.ref)}),(await me(N(q,"campaigns",a,"texts"))).docs.forEach(W=>{const J=W.data();(J.mapType===d||!J.mapType&&d==="global")&&i.delete(W.ref)}),await i.commit(),k.value=k.value.filter(W=>W.mapType!==d),f.value=f.value.filter(W=>W.mapType!==d)}catch(i){throw console.error("Failed to clear drawings by map type:",i),m.value=i.message,i}finally{w.value=!1}}function s(){$&&($(),$=null),C&&(C(),C=null),k.value=[],f.value=[]}return{drawings:k,texts:f,loading:w,error:m,subscribeToDrawings:A,saveDrawing:t,saveText:T,deleteDrawing:V,deleteText:M,clearAllDrawings:n,clearDrawingsByMapType:u,unsubscribeFromDrawings:s}}),Pe=$e("tokens",()=>{const b=de(),k=h([]),f=h(!1),w=h(null);let m=null;function $(n){m&&m(),f.value=!0,m=be(N(q,"campaigns",n,"tokens"),u=>{k.value=u.docs.map(s=>({id:s.id,...s.data()})),f.value=!1},u=>{console.error("Tokens subscription error:",u),w.value=u.message,f.value=!1})}async function C(n,u){try{f.value=!0;const s={name:u.name,image:u.image,imageType:u.imageType,borderColor:u.borderColor||"#4a5568",x:u.x||100,y:u.y||100,mapType:u.mapType||"global",size:50,createdBy:b.userId,createdAt:re()};return{id:(await ce(N(q,"campaigns",n,"tokens"),s)).id,...s}}catch(s){throw console.error("Failed to create token:",s),w.value=s.message,s}finally{f.value=!1}}async function A(n,u,s,a){try{await Ie(oe(q,"campaigns",n,"tokens",u),{x:s,y:a})}catch(d){throw console.error("Failed to update token position:",d),w.value=d.message,d}}async function t(n,u,s){try{await Ie(oe(q,"campaigns",n,"tokens",u),s)}catch(a){throw console.error("Failed to update token:",a),w.value=a.message,a}}async function T(n,u){try{await ke(oe(q,"campaigns",n,"tokens",u))}catch(s){throw console.error("Failed to delete token:",s),w.value=s.message,s}}function V(n){return k.value.filter(u=>u.mapType===n)}function M(){m&&(m(),m=null),k.value=[]}return{tokens:k,loading:f,error:w,subscribeToTokens:$,createToken:C,updateTokenPosition:A,updateToken:t,deleteToken:T,getTokensByMapType:V,unsubscribeFromTokens:M}}),Ct=["width","height"],xt=["transform"],_t=["d"],St=["x","y"],Tt=["width","height"],Mt=["onMousedown"],It=["onClick"],At={key:1,class:"token-emoji"},Ut=["src","alt"],Vt={class:"token-name"},zt={class:"mode-panel"},Ht={key:0,class:"draw-tools"},Dt={key:0,class:"size-control"},Rt={class:"size-value"},Lt={key:1,class:"size-control"},qt={class:"size-value"},Et={class:"zoom-controls"},Pt={class:"zoom-level"},Wt={class:"map-type-indicator"},Se=50,Te=100,te=40,ue=50,De=.2,Re=3,Ft={__name:"GameMap",props:{mapType:{type:String,default:"global"},campaignId:{type:String,required:!0}},setup(b){const k=b,f=$t(),w=Pe(),m=ve(),$=B(()=>k.mapType==="global"),C=B(()=>w.tokens.filter(y=>y.mapType===k.mapType)),A=B(()=>$.value?Se:Te),t=h("pan"),T=h("pen"),V=h("#000000"),M=h(3),n=h(16),u=h(1),s=h(0),a=h(0),d=h(!1),i=h(0),U=h(0),L=h(null);h(0),h(0);const W=h(0),J=h(0),P=h(!1),r=h([]),c=h(null),_=h(null),G=h(null),ne=h(null),le=B(()=>$.value?te*1.732*Se+te:ue*Te),pe=B(()=>$.value?te*1.5*Se+te:ue*Te),X=B(()=>{const y=[],g=A.value;for(let p=0;p<g;p++)for(let E=0;E<g;E++)y.push({row:p,col:E,id:`${p}-${E}`});return y});function j(y,g){const p=te*1.732,ee=te*2*.75,ie=g*p+(y%2===1?p/2:0)+te,he=y*ee+te;return{x:ie,y:he}}function ye(y,g){return{x:g*ue,y:y*ue}}function We(){const y=te,g=y*1.732/2,p=y/2;return`M 0 ${-y} L ${g} ${-p} L ${g} ${p} L 0 ${y} L ${-g} ${p} L ${-g} ${-p} Z`}const Fe=B(()=>`translate(${s.value}px, ${a.value}px) scale(${u.value})`);function Oe(y){y.button===0&&(t.value==="pan"?(d.value=!0,i.value=y.clientX-s.value,U.value=y.clientY-a.value,G.value.style.cursor="grabbing"):t.value==="draw"&&je(y))}function Ve(y){if(t.value==="pan"&&d.value)s.value=y.clientX-i.value,a.value=y.clientY-U.value;else if(t.value==="draw"&&P.value)Xe(y);else if(t.value==="token"&&L.value){const g=G.value.getBoundingClientRect(),p=(y.clientX-g.left-s.value)/u.value-W.value,E=(y.clientY-g.top-a.value)/u.value-J.value,ee=C.value.find(ie=>ie.id===L.value);ee&&(ee.x=p,ee.y=E)}}function ze(y){if(t.value==="pan")d.value=!1,G.value&&(G.value.style.cursor="grab");else if(t.value==="draw")Ye();else if(t.value==="token"&&L.value){const g=C.value.find(p=>p.id===L.value);g&&w.updateTokenPosition(k.campaignId,g.id,g.x,g.y),L.value=null}}function Ge(y,g){if(t.value!=="token")return;y.stopPropagation(),L.value=g.id;const p=G.value.getBoundingClientRect(),E=(y.clientX-p.left-s.value)/u.value,ee=(y.clientY-p.top-a.value)/u.value;W.value=E-g.x,J.value=ee-g.y}function Ne(y){confirm(`–£–¥–∞–ª–∏—Ç—å —Ç–æ–∫–µ–Ω "${y.name}"?`)&&w.deleteToken(k.campaignId,y.id)}function Be(y){y.preventDefault();const g=y.deltaY>0?-.1:.1,p=Math.max(De,Math.min(Re,u.value+g));if(p!==u.value){const E=G.value.getBoundingClientRect(),ee=y.clientX-E.left,ie=y.clientY-E.top,he=p/u.value;s.value=ee-(ee-s.value)*he,a.value=ie-(ie-a.value)*he,u.value=p}}function xe(y){const g=c.value.getBoundingClientRect(),p=(y.clientX-g.left)/u.value,E=(y.clientY-g.top)/u.value;return{x:p,y:E}}function je(y){if(T.value==="text"){Ze(y);return}P.value=!0;const g=xe(y);r.value=[g],_.value&&(_.value.beginPath(),_.value.moveTo(g.x,g.y),T.value==="eraser"?(_.value.globalCompositeOperation="destination-out",_.value.strokeStyle="rgba(0,0,0,1)",_.value.lineWidth=M.value*5):(_.value.globalCompositeOperation="source-over",_.value.strokeStyle=V.value,_.value.lineWidth=M.value),_.value.lineCap="round",_.value.lineJoin="round")}function Xe(y){if(!P.value||!_.value)return;const g=xe(y);r.value.push(g),_.value.lineTo(g.x,g.y),_.value.stroke()}async function Ye(){P.value&&(P.value=!1,r.value.length>1&&await f.saveDrawing(k.campaignId,{type:T.value==="eraser"?"eraser":"pen",path:r.value,color:T.value==="eraser"?"#ffffff":V.value,size:T.value==="eraser"?M.value*5:M.value,mapType:k.mapType}),r.value=[])}async function Ze(y){const g=prompt("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç:");if(!g)return;const p=xe(y);await f.saveText(k.campaignId,{text:g,x:p.x,y:p.y,color:V.value,fontSize:n.value,mapType:k.mapType})}function He(y){return y.createdAt?y.createdAt.toMillis?y.createdAt.toMillis():y.createdAt.seconds?y.createdAt.seconds*1e3:new Date(y.createdAt).getTime():0}function ge(){if(!_.value)return;_.value.clearRect(0,0,le.value,pe.value);const y=k.mapType;[...f.drawings.filter(p=>p.mapType===y||!p.mapType).map(p=>({...p,itemType:"drawing"})),...f.texts.filter(p=>p.mapType===y||!p.mapType).map(p=>({...p,itemType:"text"}))].sort((p,E)=>He(p)-He(E)).forEach(p=>{if(p.itemType==="drawing"&&p.path&&p.path.length>1){_.value.beginPath(),_.value.moveTo(p.path[0].x,p.path[0].y);for(let E=1;E<p.path.length;E++)_.value.lineTo(p.path[E].x,p.path[E].y);p.type==="eraser"?(_.value.globalCompositeOperation="destination-out",_.value.strokeStyle="rgba(0,0,0,1)"):(_.value.globalCompositeOperation="source-over",_.value.strokeStyle=p.color||"#000000"),_.value.lineWidth=p.size||3,_.value.lineCap="round",_.value.lineJoin="round",_.value.stroke()}else p.itemType==="text"&&(_.value.globalCompositeOperation="source-over",_.value.font=`${p.fontSize||16}px Inter, sans-serif`,_.value.fillStyle=p.color||"#000000",_.value.fillText(p.text,p.x,p.y))}),_.value.globalCompositeOperation="source-over"}fe(()=>f.drawings,ge,{deep:!0}),fe(()=>f.texts,ge,{deep:!0});function _e(y){t.value=y,G.value&&(y==="pan"?G.value.style.cursor="grab":y==="draw"?G.value.style.cursor="crosshair":G.value.style.cursor="default")}function Je(){u.value=Math.min(Re,u.value+.2)}function Ke(){u.value=Math.max(De,u.value-.2)}function Qe(){u.value=1,s.value=0,a.value=0}async function et(){const y=k.mapType==="global"?"–≥–ª–æ–±–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç—ã":"–∫–∞—Ä—Ç—ã –º–µ—Å—Ç–Ω–æ—Å—Ç–∏";confirm(`–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Ä–∏—Å—É–Ω–∫–∏ —Å ${y}?`)&&(await f.clearDrawingsByMapType(k.campaignId,k.mapType),ge())}return qe(()=>{window.addEventListener("mouseup",ze),window.addEventListener("mousemove",Ve),Ae(()=>{c.value&&(_.value=c.value.getContext("2d"),f.subscribeToDrawings(k.campaignId))}),w.subscribeToTokens(k.campaignId)}),Ee(()=>{window.removeEventListener("mouseup",ze),window.removeEventListener("mousemove",Ve),f.unsubscribeFromDrawings(),w.unsubscribeFromTokens()}),fe(()=>k.mapType,()=>{Ae(ge)}),(y,g)=>(l(),o("div",{class:"game-map-wrapper",ref_key:"mapWrapper",ref:ne},[e("div",{ref_key:"mapContainer",ref:G,class:"map-container",onMousedown:Oe,onWheel:Be},[e("div",{class:"map-transform",style:we({transform:Fe.value})},[(l(),o("svg",{class:"map-svg",width:le.value,height:pe.value},[$.value?(l(!0),o(D,{key:0},R(X.value,p=>(l(),o("g",{key:p.id,transform:`translate(${j(p.row,p.col).x}, ${j(p.row,p.col).y})`},[e("path",{d:We(),class:"cell-path"},null,8,_t)],8,xt))),128)):(l(!0),o(D,{key:1},R(X.value,p=>(l(),o("rect",{key:p.id,x:ye(p.row,p.col).x,y:ye(p.row,p.col).y,width:ue,height:ue,class:"cell-rect"},null,8,St))),128))],8,Ct)),e("canvas",{ref_key:"drawingCanvas",ref:c,class:"drawing-canvas",width:le.value,height:pe.value},null,8,Tt),(l(!0),o(D,null,R(C.value,p=>(l(),o("div",{key:p.id,class:z(["map-token",{dragging:L.value===p.id,draggable:t.value==="token"}]),style:we({left:p.x+"px",top:p.y+"px",borderColor:p.borderColor}),onMousedown:E=>Ge(E,p)},[t.value==="token"?(l(),o("button",{key:0,class:"token-delete-btn",onClick:Q(E=>Ne(p),["stop"]),title:"–£–¥–∞–ª–∏—Ç—å —Ç–æ–∫–µ–Ω"}," ‚úï ",8,It)):I("",!0),p.imageType==="emoji"?(l(),o("span",At,v(p.image),1)):(l(),o("img",{key:2,src:p.image,alt:p.name,class:"token-image"},null,8,Ut)),e("span",Vt,v(p.name),1)],46,Mt))),128))],4)],544),e("div",zt,[e("button",{class:z({active:t.value==="pan"}),onClick:g[0]||(g[0]=p=>_e("pan")),title:"–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã"}," ‚úã ",2),e("button",{class:z({active:t.value==="token"}),onClick:g[1]||(g[1]=p=>_e("token")),title:"–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤"}," üé≠ ",2),e("button",{class:z({active:t.value==="draw"}),onClick:g[2]||(g[2]=p=>_e("draw")),title:"–†–∏—Å–æ–≤–∞–Ω–∏–µ"}," ‚úèÔ∏è ",2)]),t.value==="draw"?(l(),o("div",Ht,[e("button",{class:z({active:T.value==="pen"}),onClick:g[3]||(g[3]=p=>T.value="pen"),title:"–ö–∏—Å—Ç—å"}," üñäÔ∏è ",2),e("button",{class:z({active:T.value==="text"}),onClick:g[4]||(g[4]=p=>T.value="text"),title:"–¢–µ–∫—Å—Ç"}," üî§ ",2),e("button",{class:z({active:T.value==="eraser"}),onClick:g[5]||(g[5]=p=>T.value="eraser"),title:"–õ–∞—Å—Ç–∏–∫"}," üßΩ ",2),g[9]||(g[9]=e("div",{class:"tool-divider"},null,-1)),S(e("input",{type:"color","onUpdate:modelValue":g[6]||(g[6]=p=>V.value=p),class:"color-picker",title:"–¶–≤–µ—Ç"},null,512),[[H,V.value]]),T.value!=="text"?(l(),o("div",Dt,[S(e("input",{type:"range","onUpdate:modelValue":g[7]||(g[7]=p=>M.value=p),min:"1",max:"20",class:"size-slider",title:"–†–∞–∑–º–µ—Ä –∫–∏—Å—Ç–∏"},null,512),[[H,M.value]]),e("span",Rt,v(M.value)+"px",1)])):(l(),o("div",Lt,[S(e("input",{type:"range","onUpdate:modelValue":g[8]||(g[8]=p=>n.value=p),min:"10",max:"72",class:"size-slider",title:"–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞"},null,512),[[H,n.value]]),e("span",qt,v(n.value)+"px",1)])),g[10]||(g[10]=e("div",{class:"tool-divider"},null,-1)),x(m).isGM?(l(),o("button",{key:2,onClick:et,class:"clear-btn",title:"–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ"}," üóëÔ∏è ")):I("",!0)])):I("",!0),e("div",Et,[e("button",{onClick:Je,title:"–ü—Ä–∏–±–ª–∏–∑–∏—Ç—å"},"+"),e("span",Pt,v(Math.round(u.value*100))+"%",1),e("button",{onClick:Ke,title:"–û—Ç–¥–∞–ª–∏—Ç—å"},"‚àí"),e("button",{onClick:Qe,title:"–°–±—Ä–æ—Å–∏—Ç—å",class:"reset-btn"},"‚åÇ")]),e("div",Wt,v($.value?"üåç –ì–ª–æ–±–∞–ª—å–Ω–∞—è":"üó∫Ô∏è –ú–µ—Å—Ç–Ω–æ—Å—Ç—å"),1)],512))}},Ot=ae(Ft,[["__scopeId","data-v-f54ba334"]]),Gt={class:"game-chat"},Nt={class:"chat-header"},Bt={key:0,class:"chat-loading"},jt={key:1,class:"chat-empty"},Xt={class:"message-header"},Yt={class:"message-time"},Zt={key:0,class:"roll-result"},Jt={class:"roll-dice"},Kt={class:"roll-total"},Qt={key:0,class:"roll-details"},es={key:1,class:"message-text"},ts={class:"dice-grid"},ss=["onClick","title"],as=["disabled"],ls={__name:"GameChat",props:{campaignId:{type:String,required:!0}},setup(b){const k=b,f=Ue(),w=ve(),m=h(""),$=h(null),C=h(!1),A=["1d2","1d4","1d6","1d8","1d10","1d12","1d20","1d100"];fe(()=>f.messages.length,()=>{Ae(()=>{$.value&&($.value.scrollTop=$.value.scrollHeight)})});function t(a,d){const i=[];for(let L=0;L<a;L++)i.push(Math.floor(Math.random()*d)+1);const U=i.reduce((L,W)=>L+W,0);return{rolls:i,total:U}}function T(a){const d=a.toLowerCase().match(/^(\d+)d(\d+)$/);if(!d)return null;const i=parseInt(d[1]),U=parseInt(d[2]);return i<1||i>100||![2,4,6,8,10,12,20,100].includes(U)?null:{count:i,sides:U}}async function V(a){const d=T(a);if(!d)return;const{rolls:i,total:U}=t(d.count,d.sides),L=i.length>1?`[${i.join(" + ")}]`:"";await f.sendDiceRoll(k.campaignId,a,U,L)}async function M(){if(!m.value.trim())return;const a=m.value.trim();if(a.toLowerCase().startsWith("/roll ")){const d=a.substring(6).trim(),i=T(d);if(i){const{rolls:U,total:L}=t(i.count,i.sides),W=U.length>1?`[${U.join(" + ")}]`:"";await f.sendDiceRoll(k.campaignId,d,L,W)}else await f.sendMessage(k.campaignId,"‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ò—Å–ø–æ–ª—å–∑—É–π: /roll XdY (–Ω–∞–ø—Ä–∏–º–µ—Ä /roll 2d6)");m.value="";return}await f.sendMessage(k.campaignId,a),m.value=""}async function n(){confirm("–û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å —á–∞—Ç?")&&await f.clearChat(k.campaignId)}function u(a){return a?(a.toDate?a.toDate():new Date(a)).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}):""}function s(a){return{"message-roll":a.type==="roll","message-system":a.type==="system","message-own":a.userId===w.profile?.id}}return(a,d)=>(l(),o("div",Gt,[e("div",Nt,[d[2]||(d[2]=e("h3",null,"üí¨ –ß–∞—Ç",-1)),x(w).isGM?(l(),o("button",{key:0,class:"btn-clear",onClick:n,title:"–û—á–∏—Å—Ç–∏—Ç—å —á–∞—Ç"}," üßπ ")):I("",!0)]),e("div",{class:"chat-messages",ref_key:"chatContainer",ref:$},[x(f).loading?(l(),o("div",Bt," –ó–∞–≥—Ä—É–∑–∫–∞... ")):x(f).messages.length===0?(l(),o("div",jt,[...d[3]||(d[3]=[e("span",null,"–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π",-1)])])):(l(!0),o(D,{key:2},R(x(f).messages,i=>(l(),o("div",{key:i.id,class:z(["chat-message",s(i)])},[e("div",Xt,[e("span",{class:z(["message-author",{"author-gm":i.userRole==="gm"}])},v(i.userName),3),e("span",Yt,v(u(i.createdAt)),1)]),i.type==="roll"?(l(),o("div",Zt,[e("span",Jt,"üé≤ "+v(i.diceNotation),1),d[4]||(d[4]=e("span",{class:"roll-equals"},"=",-1)),e("span",Kt,v(i.result),1),i.details?(l(),o("span",Qt,v(i.details),1)):I("",!0)])):(l(),o("div",es,v(i.text),1))],2))),128))],512),e("div",{class:z(["dice-panel",{open:C.value}])},[e("div",ts,[(l(),o(D,null,R(A,i=>e("button",{key:i,class:"dice-btn",onClick:U=>V(i),title:"–ë—Ä–æ—Å–∏—Ç—å "+i}," üé≤ "+v(i),9,ss)),64))]),d[5]||(d[5]=e("div",{class:"dice-hint"},[se(" –ò–ª–∏ –Ω–∞–ø–∏—à–∏ "),e("code",null,"/roll 2d6"),se(" –≤ —á–∞—Ç–µ ")],-1))],2),e("form",{class:"chat-input",onSubmit:Q(M,["prevent"])},[e("button",{type:"button",class:z(["btn-dice-toggle",{active:C.value}]),onClick:d[0]||(d[0]=i=>C.value=!C.value),title:"–ë—Ä–æ—Å–∏—Ç—å –∫—É–±–∏–∫–∏"}," üé≤ ",2),S(e("input",{"onUpdate:modelValue":d[1]||(d[1]=i=>m.value=i),type:"text",placeholder:"–°–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ /roll 2d6...",maxlength:"500"},null,512),[[H,m.value]]),e("button",{type:"submit",disabled:!m.value.trim()}," ‚û§ ",8,as)],32)]))}},ns=ae(ls,[["__scopeId","data-v-7238aff5"]]),os={class:"modal"},rs={class:"form-group"},is={class:"form-group"},us={class:"image-type-toggle"},cs={key:0,class:"form-group"},ds={class:"emoji-grid"},vs=["onClick"],ps={key:1,class:"form-group"},ms={class:"form-group"},fs={class:"color-grid"},bs=["onClick"],ys={class:"form-group"},gs={class:"token-preview-container"},hs={key:0,class:"token-emoji"},ks=["src"],ws={key:2,class:"token-placeholder"},$s={class:"token-name-preview"},Cs={key:2,class:"error-message"},xs={class:"modal-actions"},_s=["disabled"],Ss={__name:"CreateTokenModal",props:{campaignId:{type:String,required:!0},mapType:{type:String,required:!0}},emits:["close","created"],setup(b,{emit:k}){const f=b,w=k,m=Pe(),$=h(""),C=h("emoji"),A=h("üßô"),t=h(""),T=h("#e8d5b7"),V=h(!1),M=h(""),n=["üßô","üßô‚Äç‚ôÄÔ∏è","üßù","üßù‚Äç‚ôÇÔ∏è","üßù‚Äç‚ôÄÔ∏è","üßõ","üßõ‚Äç‚ôÄÔ∏è","üßü‚Äç‚ôÇÔ∏è","üßü‚Äç‚ôÄÔ∏è","üßú","üßú‚Äç‚ôÇÔ∏è","üßö","ü¶∏","ü¶∏‚Äç‚ôÇÔ∏è","ü¶π","ü¶π‚Äç‚ôÇÔ∏è","üë∏","ü§¥","üëë","ü§∫","üíÇ","üßû","üßû‚Äç‚ôÄÔ∏è","üë©‚Äçü¶≥","üë®‚Äçü¶≥","üë©‚Äçü¶∞","üëß","üë®‚Äçü¶±","üë©‚Äçü¶±","üë®‚Äçü¶≤","üßî","üë¶","üë®‚Äçüé§","üë©‚Äçüé§","üèÉ","üèÉ‚Äç‚ôÄÔ∏è","üßé","üßé‚Äç‚ôÇÔ∏è","üßé‚Äç‚ôÄÔ∏è","üö∂","üö∂‚Äç‚ôÄÔ∏è","ü§†","ü§°","üë§","üë•","üó£Ô∏è","üëÅÔ∏è","üôâ","üêâ","üê≤","üëπ","üë∫","üëø","üòà","üíÄ","‚ò†Ô∏è","üëª","üëΩ","üëæ","ü§ñ","üéÉ","ü¶á","üï∑Ô∏è","üï∏Ô∏è","ü¶Ç","üêç","üê∫","ü¶ä","üêó","üêª","ü¶Å","üêØ","üêÖ","üêÜ","ü¶é","üêä","üê¢","ü¶ï","ü¶ñ","üêô","ü¶ë","ü¶à","üêã","üê≥","ü¶Ä","ü¶û","ü¶ê","üê°","üê†","üêü","ü¶Ö","ü¶â","ü¶á","üê¶","üêß","ü¶Ü","ü¶¢","ü¶©","ü¶ö","ü¶ú","üê¥","ü¶Ñ","üêé","ü¶å","üêê","üêë","ü¶ô","üêò","ü¶è","ü¶õ","üêÄ","üêÅ","üêøÔ∏è","ü¶î","üê∞","üêá","ü¶ù","ü¶®","ü¶°","üêà","üêï","üê∂","üê±","üê∏","üêõ","üêú","üêù","üêû","ü¶ã","üêå","üå≤","üå≥","üå¥","üåµ","üåæ","üåø","‚òòÔ∏è","üçÄ","üçÅ","üçÇ","üçÉ","üå∫","üåª","üåπ","ü•Ä","üå∑","üåº","üíê","üéã","üéç","üçÑ","üíé","üî•","üíß","üåä","‚ùÑÔ∏è","‚òÅÔ∏è","‚õàÔ∏è","üåà","‚öîÔ∏è","üó°Ô∏è","üî™","ü™ì","üî®","‚õèÔ∏è","üõ†Ô∏è","üèπ","üéØ","üõ°Ô∏è","‚öôÔ∏è","üîó","‚õìÔ∏è","üîÆ","‚ú®","‚≠ê","üåü","üí´","‚ö°","‚òÑÔ∏è","üåô","üåë","üåï","üìø","üßø","üïØÔ∏è","üìú","üìñ","üìö","üóùÔ∏è","üîë","üí∞","üéÅ","üíç","üëë","üèÜ","ü•á","üß≠","üó∫Ô∏è","üìç","üè¥‚Äç‚ò†Ô∏è","‚öì","üì¶","üéí","üëú","üè∫","‚öóÔ∏è","üß™","üï∞Ô∏è","‚è≥","‚åõ","üß∏","üé≠","üé™","üçñ","üçó","ü•©","üßÄ","üçû","ü•ñ","ü•ê","üçé","üçá","üç∫","üç∑","ü•§","‚òï","üè∞","üèØ","‚õ™","üïå","üõï","‚õ©Ô∏è","üóø","üèõÔ∏è","üèöÔ∏è","üè°","‚õ∫","üóª","üåã","üèîÔ∏è","üèùÔ∏è","üèúÔ∏è","‚õµ","üö£","üõ∂","üêé","‚ù§Ô∏è","üß°","üíõ","üíö","üíô","üíú","üñ§","ü§ç","ü§é","üíî","‚ùå","‚≠ï","‚úÖ","‚ùì","‚ùó","üí¢","üí•","üí¶","üí®","üï≥Ô∏è","üö´","‚ö†Ô∏è","‚ò¢Ô∏è","‚ò£Ô∏è","üî¥","üü†","üü°","üü¢","üîµ","üü£","‚ö´","‚ö™"],u=["#e8d5b7","#ef4444","#22c55e","#3b82f6","#a855f7","#f97316","#06b6d4","#ec4899","#4a5568","#000000"],s=B(()=>C.value==="emoji"?A.value:t.value);async function a(){if(!$.value.trim()){M.value="–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ç–æ–∫–µ–Ω–∞";return}if(C.value==="url"&&!t.value.trim()){M.value="–í–≤–µ–¥–∏—Ç–µ URL –∫–∞—Ä—Ç–∏–Ω–∫–∏";return}V.value=!0,M.value="";try{const d=await m.createToken(f.campaignId,{name:$.value.trim(),image:s.value,imageType:C.value,borderColor:T.value,mapType:f.mapType,x:200,y:200});w("created",d),w("close")}catch(d){M.value=d.message}finally{V.value=!1}}return(d,i)=>(l(),o("div",{class:"modal-overlay",onClick:i[6]||(i[6]=Q(U=>d.$emit("close"),["self"]))},[e("div",os,[e("button",{class:"modal-close",onClick:i[0]||(i[0]=U=>d.$emit("close"))},"‚úï"),i[13]||(i[13]=e("div",{class:"modal-header"},[e("h2",null,"‚ú® –°–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω"),e("p",null,"–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∏–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–∞ –∫–∞—Ä—Ç—É")],-1)),e("form",{onSubmit:Q(a,["prevent"]),class:"modal-form"},[e("div",rs,[i[7]||(i[7]=e("label",{for:"tokenName"},"–ò–º—è —Ç–æ–∫–µ–Ω–∞",-1)),S(e("input",{id:"tokenName","onUpdate:modelValue":i[1]||(i[1]=U=>$.value=U),type:"text",placeholder:"–≠–ª—å—Ñ-—Ä–µ–π–Ω–¥–∂–µ—Ä, –ì–æ–±–ª–∏–Ω #1...",maxlength:"30",autofocus:""},null,512),[[H,$.value]])]),e("div",is,[i[8]||(i[8]=e("label",null,"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",-1)),e("div",us,[e("button",{type:"button",class:z({active:C.value==="emoji"}),onClick:i[2]||(i[2]=U=>C.value="emoji")}," üòÄ –≠–º–æ–¥–∑–∏ ",2),e("button",{type:"button",class:z({active:C.value==="url"}),onClick:i[3]||(i[3]=U=>C.value="url")}," üîó URL ",2)])]),C.value==="emoji"?(l(),o("div",cs,[e("label",null,"–í—ã–±–µ—Ä–∏—Ç–µ —ç–º–æ–¥–∑–∏ ("+v(n.length)+" —à—Ç.)",1),e("div",ds,[(l(),o(D,null,R(n,U=>e("button",{key:U,type:"button",class:z(["emoji-option",{selected:A.value===U}]),onClick:L=>A.value=U},v(U),11,vs)),64))])])):(l(),o("div",ps,[i[9]||(i[9]=e("label",{for:"imageUrl"},"URL –∫–∞—Ä—Ç–∏–Ω–∫–∏",-1)),S(e("input",{id:"imageUrl","onUpdate:modelValue":i[4]||(i[4]=U=>t.value=U),type:"url",placeholder:"https://example.com/token.png"},null,512),[[H,t.value]]),i[10]||(i[10]=e("p",{class:"url-hint"},"–í—Å—Ç–∞–≤—å—Ç–µ –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",-1))])),e("div",ms,[i[11]||(i[11]=e("label",null,"–¶–≤–µ—Ç —Ä–∞–º–∫–∏",-1)),e("div",fs,[(l(),o(D,null,R(u,U=>e("button",{key:U,type:"button",class:z(["color-option",{selected:T.value===U}]),style:we({backgroundColor:U}),onClick:L=>T.value=U},null,14,bs)),64))])]),e("div",ys,[i[12]||(i[12]=e("label",null,"–ü—Ä–µ–≤—å—é",-1)),e("div",gs,[e("div",{class:"token-preview",style:we({borderColor:T.value})},[C.value==="emoji"?(l(),o("span",hs,v(A.value),1)):t.value?(l(),o("img",{key:1,src:t.value,alt:"Token",class:"token-image"},null,8,ks)):(l(),o("span",ws,"?"))],4),e("span",$s,v($.value||"–ò–º—è —Ç–æ–∫–µ–Ω–∞"),1)])]),M.value?(l(),o("p",Cs,v(M.value),1)):I("",!0),e("div",xs,[e("button",{type:"button",class:"btn-secondary",onClick:i[5]||(i[5]=U=>d.$emit("close"))}," –û—Ç–º–µ–Ω–∞ "),e("button",{type:"submit",class:"btn-primary",disabled:V.value},v(V.value?"–°–æ–∑–¥–∞—ë–º...":"–°–æ–∑–¥–∞—Ç—å"),9,_s)])],32)])]))}},Ts=ae(Ss,[["__scopeId","data-v-b6eee162"]]),Ms=["innerHTML"],Is={__name:"Tooltip",props:{content:{type:String,required:!0},position:{type:String,default:"top",validator:b=>["top","bottom","left","right"].includes(b)}},setup(b){const k=h(!1);return(f,w)=>(l(),o("div",{class:"tooltip-wrapper",onMouseenter:w[0]||(w[0]=m=>k.value=!0),onMouseleave:w[1]||(w[1]=m=>k.value=!1)},[at(f.$slots,"default",{},void 0),Z(lt,{name:"tooltip-fade"},{default:F(()=>[k.value?(l(),o("div",{key:0,class:z(["tooltip-content",[b.position]]),innerHTML:b.content},null,10,Ms)):I("",!0)]),_:1})],32))}},O=ae(Is,[["__scopeId","data-v-dd6b9b40"]]),As={class:"modal-content character-modal"},Us={class:"form-section"},Vs={class:"form-row"},zs={class:"form-group flex-2"},Hs={class:"form-group"},Ds=["value"],Rs={class:"form-group"},Ls={class:"form-group"},qs={class:"form-group"},Es={class:"race-selector"},Ps=["onClick"],Ws={key:0,class:"race-ability"},Fs={class:"ability-tag"},Os={class:"form-section"},Gs={class:"stats-grid"},Ns={class:"stat-block"},Bs=["value"],js={key:0,class:"stat-abilities"},Xs={class:"ability-tag small"},Ys={class:"ability-tag small"},Zs={class:"stat-block"},Js=["value"],Ks={key:0,class:"stat-abilities"},Qs={class:"ability-tag small"},ea={class:"ability-tag small"},ta={class:"stat-block"},sa=["value"],aa={key:0,class:"stat-abilities"},la={class:"ability-tag small"},na={class:"ability-tag small"},oa={class:"stat-block"},ra=["value"],ia={key:0,class:"stat-abilities"},ua={class:"ability-tag small"},ca={class:"ability-tag small"},da={class:"form-section"},va={class:"combat-grid"},pa={class:"combat-row"},ma={class:"form-group"},fa={class:"form-group"},ba=["value"],ya={class:"combat-row"},ga={class:"form-group"},ha={class:"form-group"},ka={class:"combat-row"},wa={class:"form-group"},$a={class:"form-group"},Ca={class:"combat-row"},xa={class:"form-group"},_a={class:"calculated-value"},Sa={class:"form-group"},Ta={class:"form-section"},Ma={class:"form-group"},Ia={class:"worldview-selector"},Aa={class:"form-group"},Ua={class:"form-group"},Va={class:"form-section"},za={class:"inventory-grid"},Ha={class:"inventory-column"},Da={class:"slot-number"},Ra=["onUpdate:modelValue","placeholder","title"],La={class:"inventory-column"},qa={class:"slot-number"},Ea=["onUpdate:modelValue","placeholder","title"],Pa={key:0,class:"speed-hint"},Wa={key:1,class:"speed-hint"},Fa={class:"form-section"},Oa={class:"form-group"},Ga={key:0,class:"error-message"},Na={class:"form-actions"},Ba=["disabled"],ja={__name:"CreateCharacterModal",props:{campaignId:{type:String,required:!0}},emits:["close","created"],setup(b,{emit:k}){const f=b,w=k,m=Ce(),$=de(),C=h(!1),A=h(""),t=h({name:"",level:1,experience:"",craft:"",race:null,stats:{stk:0,lvk:0,rzm:0,har:0},armorClass:11,armorParts:0,maxSpeed:"",currentSpeed:"",maxHp:"",currentHp:"",currentWounds:"",worldview:null,quirks:"",traits:"",inventory:Array(20).fill(""),notes:""});fe(()=>t.value.armorParts,u=>{t.value.armorClass=11+u});const T=B(()=>{const u=t.value.level;return u===1?5:u<=3?6:u<=5?7:u<=7?8:u<=9?9:10}),V=B(()=>t.value.race?m.races[t.value.race]:null),M=B(()=>t.value.name.trim()&&t.value.race);async function n(){if(M.value){C.value=!0,A.value="";try{const u=await m.createCharacter(f.campaignId,{name:t.value.name.trim(),level:t.value.level,experience:t.value.experience,craft:t.value.craft.trim(),race:t.value.race,stats:{...t.value.stats},armorParts:t.value.armorParts,armorClass:t.value.armorClass,maxSpeed:t.value.maxSpeed,currentSpeed:t.value.currentSpeed,maxHp:t.value.maxHp,currentHp:t.value.currentHp,maxWounds:T.value,currentWounds:t.value.currentWounds,worldview:t.value.worldview,quirks:t.value.quirks,traits:t.value.traits,inventory:[...t.value.inventory],notes:t.value.notes},$.user.uid);w("created",u),w("close")}catch(u){A.value=u.message}finally{C.value=!1}}}return(u,s)=>(l(),o("div",{class:"modal-overlay",onClick:s[23]||(s[23]=Q(a=>u.$emit("close"),["self"]))},[e("div",As,[e("button",{class:"close-btn",onClick:s[0]||(s[0]=a=>u.$emit("close"))},"‚úï"),s[54]||(s[54]=e("h2",null,"–°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",-1)),e("form",{onSubmit:Q(n,["prevent"]),class:"character-form"},[e("div",Us,[s[31]||(s[31]=e("h3",null,"–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",-1)),e("div",Vs,[e("div",zs,[s[24]||(s[24]=e("label",{for:"charName"},"–ò–ú–Ø",-1)),S(e("input",{id:"charName","onUpdate:modelValue":s[1]||(s[1]=a=>t.value.name=a),type:"text",placeholder:"–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",required:"",maxlength:"50"},null,512),[[H,t.value.name]])]),e("div",Hs,[s[25]||(s[25]=e("label",{for:"charLevel"},"–£–†",-1)),S(e("select",{id:"charLevel","onUpdate:modelValue":s[2]||(s[2]=a=>t.value.level=a)},[(l(),o(D,null,R(10,a=>e("option",{key:a,value:a},v(a),9,Ds)),64))],512),[[K,t.value.level,void 0,{number:!0}]])]),e("div",Rs,[s[26]||(s[26]=e("label",{for:"charExp"},"–û–ü–´–¢",-1)),S(e("input",{id:"charExp","onUpdate:modelValue":s[3]||(s[3]=a=>t.value.experience=a),type:"text",placeholder:"0/100"},null,512),[[H,t.value.experience]])])]),e("div",Ls,[s[27]||(s[27]=e("label",{for:"charCraft"},"–†–ï–ú–ï–°–õ–û",-1)),S(e("input",{id:"charCraft","onUpdate:modelValue":s[4]||(s[4]=a=>t.value.craft=a),type:"text",placeholder:"–í–≤–µ–¥–∏—Ç–µ —Ä–µ–º—ë—Å–ª–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é",maxlength:"100"},null,512),[[H,t.value.craft]])]),e("div",qs,[s[30]||(s[30]=e("label",null,"–ù–ê–†–û–î",-1)),e("div",Es,[(l(!0),o(D,null,R(x(m).races,(a,d)=>(l(),o("button",{key:d,type:"button",class:z(["race-btn",{selected:t.value.race===d}]),onClick:i=>t.value.race=d},v(a.name),11,Ps))),128))]),t.value.race?(l(),o("div",Ws,[Z(O,{content:V.value.description,position:"bottom"},{default:F(()=>[e("div",Fs,[s[28]||(s[28]=e("span",{class:"ability-icon"},"‚ú®",-1)),se(" "+v(V.value.ability)+" ",1),s[29]||(s[29]=e("span",{class:"tooltip-hint"},"(?)",-1))])]),_:1},8,["content"])])):I("",!0)])]),e("div",Os,[s[36]||(s[36]=e("h3",null,"–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏",-1)),e("div",Gs,[e("div",Ns,[s[32]||(s[32]=e("div",{class:"stat-header"},[e("label",{for:"statStk"},"–°–¢–ö"),e("span",{class:"stat-name"},"–°—Ç–æ–π–∫–æ—Å—Ç—å")],-1)),S(e("select",{id:"statStk","onUpdate:modelValue":s[5]||(s[5]=a=>t.value.stats.stk=a)},[(l(),o(D,null,R(11,a=>e("option",{key:a-1,value:a-1},v(a-1),9,Bs)),64))],512),[[K,t.value.stats.stk,void 0,{number:!0}]]),t.value.stats.stk>=5?(l(),o("div",js,[Z(O,{content:x(m).statAbilities.stk[5].description,position:"bottom"},{default:F(()=>[e("div",Xs," ‚öîÔ∏è "+v(x(m).statAbilities.stk[5].name),1)]),_:1},8,["content"]),t.value.stats.stk>=10?(l(),Y(O,{key:0,content:x(m).statAbilities.stk[10].description,position:"bottom"},{default:F(()=>[e("div",Ys," üí™ "+v(x(m).statAbilities.stk[10].name),1)]),_:1},8,["content"])):I("",!0)])):I("",!0)]),e("div",Zs,[s[33]||(s[33]=e("div",{class:"stat-header"},[e("label",{for:"statLvk"},"–õ–í–ö"),e("span",{class:"stat-name"},"–õ–æ–≤–∫–æ—Å—Ç—å")],-1)),S(e("select",{id:"statLvk","onUpdate:modelValue":s[6]||(s[6]=a=>t.value.stats.lvk=a)},[(l(),o(D,null,R(11,a=>e("option",{key:a-1,value:a-1},v(a-1),9,Js)),64))],512),[[K,t.value.stats.lvk,void 0,{number:!0}]]),t.value.stats.lvk>=5?(l(),o("div",Ks,[Z(O,{content:x(m).statAbilities.lvk[5].description,position:"bottom"},{default:F(()=>[e("div",Qs," üéØ "+v(x(m).statAbilities.lvk[5].name),1)]),_:1},8,["content"]),t.value.stats.lvk>=10?(l(),Y(O,{key:0,content:x(m).statAbilities.lvk[10].description,position:"bottom"},{default:F(()=>[e("div",ea," üó°Ô∏è "+v(x(m).statAbilities.lvk[10].name),1)]),_:1},8,["content"])):I("",!0)])):I("",!0)]),e("div",ta,[s[34]||(s[34]=e("div",{class:"stat-header"},[e("label",{for:"statRzm"},"–†–ó–ú"),e("span",{class:"stat-name"},"–†–∞–∑—É–º")],-1)),S(e("select",{id:"statRzm","onUpdate:modelValue":s[7]||(s[7]=a=>t.value.stats.rzm=a)},[(l(),o(D,null,R(11,a=>e("option",{key:a-1,value:a-1},v(a-1),9,sa)),64))],512),[[K,t.value.stats.rzm,void 0,{number:!0}]]),t.value.stats.rzm>=5?(l(),o("div",aa,[(l(!0),o(D,null,R(x(m).statAbilities.rzm[5],(a,d)=>(l(),Y(O,{key:d,content:a.description,position:"bottom"},{default:F(()=>[e("div",la," üîÆ "+v(a.name),1)]),_:2},1032,["content"]))),128)),t.value.stats.rzm>=10?(l(),Y(O,{key:0,content:x(m).statAbilities.rzm[10].description,position:"bottom"},{default:F(()=>[e("div",na," üìö "+v(x(m).statAbilities.rzm[10].name),1)]),_:1},8,["content"])):I("",!0)])):I("",!0)]),e("div",oa,[s[35]||(s[35]=e("div",{class:"stat-header"},[e("label",{for:"statHar"},"–•–ê–†"),e("span",{class:"stat-name"},"–•–∞—Ä–∏–∑–º–∞")],-1)),S(e("select",{id:"statHar","onUpdate:modelValue":s[8]||(s[8]=a=>t.value.stats.har=a)},[(l(),o(D,null,R(11,a=>e("option",{key:a-1,value:a-1},v(a-1),9,ra)),64))],512),[[K,t.value.stats.har,void 0,{number:!0}]]),t.value.stats.har>=5?(l(),o("div",ia,[Z(O,{content:x(m).statAbilities.har[5].description,position:"bottom"},{default:F(()=>[e("div",ua," üëë "+v(x(m).statAbilities.har[5].name),1)]),_:1},8,["content"]),t.value.stats.har>=10?(l(),Y(O,{key:0,content:x(m).statAbilities.har[10].description,position:"bottom"},{default:F(()=>[e("div",ca," üéñÔ∏è "+v(x(m).statAbilities.har[10].name),1)]),_:1},8,["content"])):I("",!0)])):I("",!0)])])]),e("div",da,[s[47]||(s[47]=e("h3",null,"–ë–æ–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã",-1)),e("div",va,[e("div",pa,[e("div",ma,[s[37]||(s[37]=e("label",{for:"armorClass"},"–ö–î",-1)),S(e("input",{id:"armorClass","onUpdate:modelValue":s[9]||(s[9]=a=>t.value.armorClass=a),type:"number",min:"0",placeholder:"11"},null,512),[[H,t.value.armorClass,void 0,{number:!0}]]),s[38]||(s[38]=e("span",{class:"calc-hint"},"–±–∞–∑–æ–≤–æ–µ: 11 + –ß–î",-1))]),e("div",fa,[s[39]||(s[39]=e("label",{for:"armorParts"},"–ß–î",-1)),S(e("select",{id:"armorParts","onUpdate:modelValue":s[10]||(s[10]=a=>t.value.armorParts=a)},[(l(),o(D,null,R(8,a=>e("option",{key:a-1,value:a-1},v(a-1),9,ba)),64))],512),[[K,t.value.armorParts,void 0,{number:!0}]])])]),e("div",ya,[e("div",ga,[s[40]||(s[40]=e("label",{for:"maxSpeed"},"–º–∞–∫—Å –°–ö–†",-1)),S(e("input",{id:"maxSpeed","onUpdate:modelValue":s[11]||(s[11]=a=>t.value.maxSpeed=a),type:"text",placeholder:"30'"},null,512),[[H,t.value.maxSpeed]])]),e("div",ha,[s[41]||(s[41]=e("label",{for:"currentSpeed"},"–°–ö–†",-1)),S(e("input",{id:"currentSpeed","onUpdate:modelValue":s[12]||(s[12]=a=>t.value.currentSpeed=a),type:"text",placeholder:"30'"},null,512),[[H,t.value.currentSpeed]])])]),e("div",ka,[e("div",wa,[s[42]||(s[42]=e("label",{for:"maxHp"},"–º–∞–∫—Å –û–ó",-1)),S(e("input",{id:"maxHp","onUpdate:modelValue":s[13]||(s[13]=a=>t.value.maxHp=a),type:"text",placeholder:"10"},null,512),[[H,t.value.maxHp]])]),e("div",$a,[s[43]||(s[43]=e("label",{for:"currentHp"},"–û–ó",-1)),S(e("input",{id:"currentHp","onUpdate:modelValue":s[14]||(s[14]=a=>t.value.currentHp=a),type:"text",placeholder:"10"},null,512),[[H,t.value.currentHp]])])]),e("div",Ca,[e("div",xa,[s[44]||(s[44]=e("label",null,"–º–∞–∫—Å –†–ê–ù",-1)),e("div",_a,v(T.value),1),s[45]||(s[45]=e("span",{class:"calc-hint"},"–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –£–†",-1))]),e("div",Sa,[s[46]||(s[46]=e("label",{for:"currentWounds"},"–†–ê–ù–´",-1)),S(e("input",{id:"currentWounds","onUpdate:modelValue":s[15]||(s[15]=a=>t.value.currentWounds=a),type:"text",placeholder:"0"},null,512),[[H,t.value.currentWounds]])])])])]),e("div",Ta,[s[51]||(s[51]=e("h3",null,"–õ–∏—á–Ω–æ—Å—Ç—å",-1)),e("div",Ma,[s[48]||(s[48]=e("label",null,"–ú–ò–†–û–í–û–ó–ó–†–ï–ù–ò–ï",-1)),e("div",Ia,[e("button",{type:"button",class:z(["worldview-btn",{selected:t.value.worldview==="order"}]),onClick:s[16]||(s[16]=a=>t.value.worldview="order")}," ‚öñÔ∏è –ü–æ—Ä—è–¥–æ–∫ ",2),e("button",{type:"button",class:z(["worldview-btn",{selected:t.value.worldview==="balance"}]),onClick:s[17]||(s[17]=a=>t.value.worldview="balance")}," ‚òØÔ∏è –ë–∞–ª–∞–Ω—Å ",2),e("button",{type:"button",class:z(["worldview-btn",{selected:t.value.worldview==="chaos"}]),onClick:s[18]||(s[18]=a=>t.value.worldview="chaos")}," üåÄ –•–∞–æ—Å ",2)])]),e("div",Aa,[s[49]||(s[49]=e("label",{for:"quirks"},"–ü–†–ò–ß–£–î–´",-1)),S(e("input",{id:"quirks","onUpdate:modelValue":s[19]||(s[19]=a=>t.value.quirks=a),type:"text",placeholder:"–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞..."},null,512),[[H,t.value.quirks]])]),e("div",Ua,[s[50]||(s[50]=e("label",{for:"traits"},"–ß–ï–†–¢–´",-1)),S(e("textarea",{id:"traits","onUpdate:modelValue":s[20]||(s[20]=a=>t.value.traits=a),placeholder:"–í–Ω–µ—à–Ω–æ—Å—Ç—å, —Ö–∞—Ä–∞–∫—Ç–µ—Ä, –∏—Å—Ç–æ—Ä–∏—è...",rows:"5"},null,512),[[H,t.value.traits]])])]),e("div",Va,[s[52]||(s[52]=e("h3",null,"–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å",-1)),e("div",za,[e("div",Ha,[(l(),o(D,null,R(10,a=>e("div",{key:a,class:"inventory-slot"},[e("span",Da,v(a),1),S(e("input",{"onUpdate:modelValue":d=>t.value.inventory[a-1]=d,type:"text",placeholder:"–ü—Ä–µ–¥–º–µ—Ç "+a,title:t.value.inventory[a-1]},null,8,Ra),[[H,t.value.inventory[a-1]]])])),64))]),e("div",La,[(l(),o(D,null,R(10,a=>e("div",{key:a+10,class:z(["inventory-slot",{"speed-penalty":a===1||a===6}])},[e("span",qa,v(a+10),1),S(e("input",{"onUpdate:modelValue":d=>t.value.inventory[a+9]=d,type:"text",placeholder:"–ü—Ä–µ–¥–º–µ—Ç "+(a+10),title:t.value.inventory[a+9]},null,8,Ea),[[H,t.value.inventory[a+9]]]),a===1?(l(),o("span",Pa,"–°–ö–† -5'")):a===6?(l(),o("span",Wa,"–°–ö–† -10'")):I("",!0)],2)),64))])])]),e("div",Fa,[s[53]||(s[53]=e("h3",null,"–ó–∞–º–µ—Ç–∫–∏",-1)),e("div",Oa,[S(e("textarea",{id:"notes","onUpdate:modelValue":s[21]||(s[21]=a=>t.value.notes=a),placeholder:"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏, –ø–ª–∞–Ω—ã, –∏–¥–µ–∏...",rows:"6"},null,512),[[H,t.value.notes]])])]),A.value?(l(),o("div",Ga,v(A.value),1)):I("",!0),e("div",Na,[e("button",{type:"button",class:"btn-cancel",onClick:s[22]||(s[22]=a=>u.$emit("close"))}," –û—Ç–º–µ–Ω–∞ "),e("button",{type:"submit",class:"btn-create",disabled:C.value||!M.value},v(C.value?"–°–æ–∑–¥–∞–Ω–∏–µ...":"–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞"),9,Ba)])],32)])]))}},Xa=ae(ja,[["__scopeId","data-v-c598cbb4"]]),Ya={class:"panel-header"},Za={class:"characters-list"},Ja={key:0,class:"empty-state"},Ka=["onClick"],Qa={class:"char-icon"},el={class:"char-info"},tl={class:"char-name"},sl={class:"char-details"},al={__name:"CharactersList",props:{isOpen:{type:Boolean,default:!1},characters:{type:Array,default:()=>[]},title:{type:String,default:"–ü–µ—Ä—Å–æ–Ω–∞–∂–∏"},emptyMessage:{type:String,default:"–ù–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π"}},emits:["close","select"],setup(b,{emit:k}){const f=k,w=Ce();function m(C){return{human:"üßî",gmur:"‚õèÔ∏è",div:"üßù"}[C]||"üë§"}function $(C){f("select",C)}return(C,A)=>(l(),o("div",{class:z(["characters-panel",{open:b.isOpen}])},[e("div",Ya,[e("h3",null,v(b.title),1),e("button",{class:"close-panel-btn",onClick:A[0]||(A[0]=t=>C.$emit("close"))},"‚úï")]),e("div",Za,[b.characters.length===0?(l(),o("div",Ja,[A[1]||(A[1]=e("span",{class:"empty-icon"},"üìú",-1)),e("p",null,v(b.emptyMessage),1)])):I("",!0),(l(!0),o(D,null,R(b.characters,t=>(l(),o("button",{key:t.id,class:"character-item",onClick:T=>$(t)},[e("span",Qa,v(m(t.race)),1),e("div",el,[e("span",tl,v(t.name),1),e("span",sl,v(x(w).races[t.race]?.name)+" ‚Ä¢ –£–† "+v(t.level),1)]),A[2]||(A[2]=e("span",{class:"char-arrow"},"‚Üí",-1))],8,Ka))),128))])],2))}},ll=ae(al,[["__scopeId","data-v-d32bb188"]]),nl={class:"modal-content character-sheet"},ol={class:"sheet-header"},rl={key:0,class:"sheet-actions"},il={class:"sheet-section"},ul={class:"info-grid"},cl={class:"info-item"},dl={key:1,class:"info-value"},vl={class:"info-item"},pl=["value"],ml={key:1,class:"info-value"},fl={class:"info-item"},bl={key:1,class:"info-value"},yl={class:"info-item wide"},gl={key:1,class:"info-value"},hl={class:"info-item wide"},kl={key:0,class:"race-selector-mini"},wl=["onClick"],$l={key:1,class:"info-value race-value"},Cl={class:"race-ability-badge"},xl={class:"sheet-section"},_l={class:"stats-display"},Sl=["value"],Tl={key:1,class:"stat-value"},Ml={key:2,class:"roll-hint"},Il={key:3,class:"stat-abilities-list"},Al={class:"ability-badge"},Ul={class:"ability-badge"},Vl=["value"],zl={key:1,class:"stat-value"},Hl={key:2,class:"roll-hint"},Dl={key:3,class:"stat-abilities-list"},Rl={class:"ability-badge"},Ll={class:"ability-badge"},ql=["value"],El={key:1,class:"stat-value"},Pl={key:2,class:"roll-hint"},Wl={key:3,class:"stat-abilities-list"},Fl={class:"ability-badge"},Ol={class:"ability-badge"},Gl=["value"],Nl={key:1,class:"stat-value"},Bl={key:2,class:"roll-hint"},jl={key:3,class:"stat-abilities-list"},Xl={class:"ability-badge"},Yl={class:"ability-badge"},Zl={class:"sheet-section"},Jl={class:"combat-display"},Kl={class:"combat-item"},Ql={key:1,class:"combat-value calculated"},en={class:"combat-item"},tn=["value"],sn={key:1,class:"combat-value"},an={class:"combat-item"},ln={key:1,class:"combat-value"},nn={class:"combat-item"},on={key:1,class:"combat-value"},rn={class:"combat-item"},un={key:1,class:"combat-value"},cn={class:"combat-item"},dn={key:1,class:"combat-value"},vn={class:"combat-item"},pn={class:"combat-value calculated"},mn={class:"combat-item"},fn={key:1,class:"combat-value"},bn={class:"sheet-section"},yn={class:"personality-display"},gn={class:"info-item"},hn={key:0,class:"worldview-selector-mini"},kn={class:"info-item wide"},wn={key:1,class:"info-value"},$n={class:"info-item wide"},Cn={key:1,class:"info-value multiline"},xn={class:"sheet-section"},_n={class:"inventory-display"},Sn={class:"inventory-col"},Tn={class:"inv-num"},Mn=["onUpdate:modelValue","title"],In=["title"],An={class:"inventory-col"},Un={class:"inv-num"},Vn=["onUpdate:modelValue","title"],zn=["title"],Hn={key:2,class:"penalty-tag"},Dn={key:3,class:"penalty-tag"},Rn={class:"sheet-section"},Ln={key:1,class:"notes-content"},qn={key:0,class:"edit-actions"},En=["disabled"],Pn={key:1,class:"error-message"},Wn={__name:"CharacterSheet",props:{character:{type:Object,required:!0},campaignId:{type:String,required:!0},canEdit:{type:Boolean,default:!1}},emits:["close","updated","deleted"],setup(b,{emit:k}){const f=b,w=k,m=Ce(),$=de(),C=Ue(),A=ve(),t=h(!1),T=h(!1),V=h(""),M={order:"‚öñÔ∏è –ü–æ—Ä—è–¥–æ–∫",balance:"‚òØÔ∏è –ë–∞–ª–∞–Ω—Å",chaos:"üåÄ –•–∞–æ—Å"},n=nt({name:"",level:1,experience:"",craft:"",race:null,stats:{stk:0,lvk:0,rzm:0,har:0},armorClass:11,armorParts:0,maxSpeed:"",currentSpeed:"",maxHp:"",currentHp:"",currentWounds:"",worldview:null,quirks:"",traits:"",inventory:Array(20).fill(""),notes:""});function u(){n.armorClass=11+n.armorParts}const s=B(()=>f.canEdit&&!t.value&&!A.isGM);async function a(P,r,c){if(!s.value)return;const _=Math.floor(Math.random()*20)+1,G=_+c,ne=`1d20+${c} (${r})`,le=`[${_}] + ${c}`;await C.sendDiceRoll(f.campaignId,ne,G,le)}function d(){n.name=f.character.name||"",n.level=f.character.level||1,n.experience=f.character.experience||"",n.craft=f.character.craft||"",n.race=f.character.race,n.stats={...f.character.stats},n.armorClass=f.character.armorClass||11,n.armorParts=f.character.armorParts||0,n.maxSpeed=f.character.maxSpeed||"",n.currentSpeed=f.character.currentSpeed||"",n.maxHp=f.character.maxHp||"",n.currentHp=f.character.currentHp||"",n.currentWounds=f.character.currentWounds||"",n.worldview=f.character.worldview,n.quirks=f.character.quirks||"",n.traits=f.character.traits||"",n.inventory=[...f.character.inventory||Array(20).fill("")],n.notes=f.character.notes||"",t.value=!0}function i(){t.value=!1,V.value=""}function U(P){return P===1?5:P<=3?6:P<=5?7:P<=7?8:P<=9?9:10}async function L(){T.value=!0,V.value="";try{await m.updateCharacter(f.campaignId,f.character.id,{name:n.name.trim(),level:n.level,experience:n.experience,craft:n.craft.trim(),race:n.race,stats:{...n.stats},armorParts:n.armorParts,armorClass:n.armorClass,maxSpeed:n.maxSpeed,currentSpeed:n.currentSpeed,maxHp:n.maxHp,currentHp:n.currentHp,maxWounds:U(n.level),currentWounds:n.currentWounds,worldview:n.worldview,quirks:n.quirks,traits:n.traits,inventory:[...n.inventory],notes:n.notes},$.user.uid),t.value=!1,w("updated")}catch(P){V.value=P.message}finally{T.value=!1}}function W(){confirm(`–£–¥–∞–ª–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ "${f.character.name}"? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.`)&&J()}async function J(){try{await m.deleteCharacter(f.campaignId,f.character.id,$.user.uid),w("deleted"),w("close")}catch(P){V.value=P.message}}return(P,r)=>(l(),o("div",{class:"modal-overlay",onClick:r[30]||(r[30]=Q(c=>P.$emit("close"),["self"]))},[e("div",nl,[e("button",{class:"close-btn",onClick:r[0]||(r[0]=c=>P.$emit("close"))},"‚úï"),e("div",ol,[e("h2",null,"–õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞: "+v(b.character.name),1),b.canEdit?(l(),o("div",rl,[t.value?I("",!0):(l(),o("button",{key:0,class:"btn-edit",onClick:d}," ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å ")),t.value?I("",!0):(l(),o("button",{key:1,class:"btn-delete",onClick:W}," üóëÔ∏è –£–¥–∞–ª–∏—Ç—å "))])):I("",!0)]),e("div",{class:z(["sheet-content",{editing:t.value}])},[e("div",il,[r[36]||(r[36]=e("h3",null,"–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",-1)),e("div",ul,[e("div",cl,[r[31]||(r[31]=e("span",{class:"info-label"},"–ò–ú–Ø",-1)),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":r[1]||(r[1]=c=>n.name=c),type:"text"},null,512)),[[H,n.name]]):(l(),o("span",dl,v(b.character.name),1))]),e("div",vl,[r[32]||(r[32]=e("span",{class:"info-label"},"–£–†",-1)),t.value?S((l(),o("select",{key:0,"onUpdate:modelValue":r[2]||(r[2]=c=>n.level=c)},[(l(),o(D,null,R(10,c=>e("option",{key:c,value:c},v(c),9,pl)),64))],512)),[[K,n.level,void 0,{number:!0}]]):(l(),o("span",ml,v(b.character.level),1))]),e("div",fl,[r[33]||(r[33]=e("span",{class:"info-label"},"–û–ü–´–¢",-1)),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":r[3]||(r[3]=c=>n.experience=c),type:"text"},null,512)),[[H,n.experience]]):(l(),o("span",bl,v(b.character.experience||"‚Äî"),1))]),e("div",yl,[r[34]||(r[34]=e("span",{class:"info-label"},"–†–ï–ú–ï–°–õ–û",-1)),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":r[4]||(r[4]=c=>n.craft=c),type:"text"},null,512)),[[H,n.craft]]):(l(),o("span",gl,v(b.character.craft||"‚Äî"),1))]),e("div",hl,[r[35]||(r[35]=e("span",{class:"info-label"},"–ù–ê–†–û–î",-1)),t.value?(l(),o("div",kl,[(l(!0),o(D,null,R(x(m).races,(c,_)=>(l(),o("button",{key:_,type:"button",class:z(["race-btn-mini",{selected:n.race===_}]),onClick:G=>n.race=_},v(c.name),11,wl))),128))])):(l(),o("span",$l,[se(v(x(m).races[b.character.race]?.name)+" ",1),Z(O,{content:x(m).races[b.character.race]?.description,position:"bottom"},{default:F(()=>[e("span",Cl,"‚ú® "+v(x(m).races[b.character.race]?.ability),1)]),_:1},8,["content"])]))])])]),e("div",xl,[r[45]||(r[45]=e("h3",null,"–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏",-1)),e("div",_l,[e("div",{class:z(["stat-item",{clickable:s.value}]),onClick:r[7]||(r[7]=c=>!t.value&&a("stk","–°–¢–ö",b.character.stats?.stk||0))},[r[37]||(r[37]=e("span",{class:"stat-abbr"},"–°–¢–ö",-1)),r[38]||(r[38]=e("span",{class:"stat-name"},"–°—Ç–æ–π–∫–æ—Å—Ç—å",-1)),t.value?S((l(),o("select",{key:0,"onUpdate:modelValue":r[5]||(r[5]=c=>n.stats.stk=c),onClick:r[6]||(r[6]=Q(()=>{},["stop"]))},[(l(),o(D,null,R(11,c=>e("option",{key:c-1,value:c-1},v(c-1),9,Sl)),64))],512)),[[K,n.stats.stk,void 0,{number:!0}]]):(l(),o("span",Tl,v(b.character.stats?.stk||0),1)),s.value&&!t.value?(l(),o("span",Ml,"üé≤ –ö–ª–∏–∫–Ω–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏")):I("",!0),(t.value?n.stats.stk:b.character.stats?.stk)>=5?(l(),o("div",Il,[Z(O,{content:x(m).statAbilities.stk[5].description,position:"bottom"},{default:F(()=>[e("span",Al,"‚öîÔ∏è "+v(x(m).statAbilities.stk[5].name),1)]),_:1},8,["content"]),(t.value?n.stats.stk:b.character.stats?.stk)>=10?(l(),Y(O,{key:0,content:x(m).statAbilities.stk[10].description,position:"bottom"},{default:F(()=>[e("span",Ul,"üí™ "+v(x(m).statAbilities.stk[10].name),1)]),_:1},8,["content"])):I("",!0)])):I("",!0)],2),e("div",{class:z(["stat-item",{clickable:s.value}]),onClick:r[10]||(r[10]=c=>!t.value&&a("lvk","–õ–í–ö",b.character.stats?.lvk||0))},[r[39]||(r[39]=e("span",{class:"stat-abbr"},"–õ–í–ö",-1)),r[40]||(r[40]=e("span",{class:"stat-name"},"–õ–æ–≤–∫–æ—Å—Ç—å",-1)),t.value?S((l(),o("select",{key:0,"onUpdate:modelValue":r[8]||(r[8]=c=>n.stats.lvk=c),onClick:r[9]||(r[9]=Q(()=>{},["stop"]))},[(l(),o(D,null,R(11,c=>e("option",{key:c-1,value:c-1},v(c-1),9,Vl)),64))],512)),[[K,n.stats.lvk,void 0,{number:!0}]]):(l(),o("span",zl,v(b.character.stats?.lvk||0),1)),s.value&&!t.value?(l(),o("span",Hl,"üé≤ –ö–ª–∏–∫–Ω–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏")):I("",!0),(t.value?n.stats.lvk:b.character.stats?.lvk)>=5?(l(),o("div",Dl,[Z(O,{content:x(m).statAbilities.lvk[5].description,position:"bottom"},{default:F(()=>[e("span",Rl,"üéØ "+v(x(m).statAbilities.lvk[5].name),1)]),_:1},8,["content"]),(t.value?n.stats.lvk:b.character.stats?.lvk)>=10?(l(),Y(O,{key:0,content:x(m).statAbilities.lvk[10].description,position:"bottom"},{default:F(()=>[e("span",Ll,"üó°Ô∏è "+v(x(m).statAbilities.lvk[10].name),1)]),_:1},8,["content"])):I("",!0)])):I("",!0)],2),e("div",{class:z(["stat-item",{clickable:s.value}]),onClick:r[13]||(r[13]=c=>!t.value&&a("rzm","–†–ó–ú",b.character.stats?.rzm||0))},[r[41]||(r[41]=e("span",{class:"stat-abbr"},"–†–ó–ú",-1)),r[42]||(r[42]=e("span",{class:"stat-name"},"–†–∞–∑—É–º",-1)),t.value?S((l(),o("select",{key:0,"onUpdate:modelValue":r[11]||(r[11]=c=>n.stats.rzm=c),onClick:r[12]||(r[12]=Q(()=>{},["stop"]))},[(l(),o(D,null,R(11,c=>e("option",{key:c-1,value:c-1},v(c-1),9,ql)),64))],512)),[[K,n.stats.rzm,void 0,{number:!0}]]):(l(),o("span",El,v(b.character.stats?.rzm||0),1)),s.value&&!t.value?(l(),o("span",Pl,"üé≤ –ö–ª–∏–∫–Ω–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏")):I("",!0),(t.value?n.stats.rzm:b.character.stats?.rzm)>=5?(l(),o("div",Wl,[(l(!0),o(D,null,R(x(m).statAbilities.rzm[5],(c,_)=>(l(),Y(O,{key:_,content:c.description,position:"bottom"},{default:F(()=>[e("span",Fl,"üîÆ "+v(c.name),1)]),_:2},1032,["content"]))),128)),(t.value?n.stats.rzm:b.character.stats?.rzm)>=10?(l(),Y(O,{key:0,content:x(m).statAbilities.rzm[10].description,position:"bottom"},{default:F(()=>[e("span",Ol,"üìö "+v(x(m).statAbilities.rzm[10].name),1)]),_:1},8,["content"])):I("",!0)])):I("",!0)],2),e("div",{class:z(["stat-item",{clickable:s.value}]),onClick:r[16]||(r[16]=c=>!t.value&&a("har","–•–ê–†",b.character.stats?.har||0))},[r[43]||(r[43]=e("span",{class:"stat-abbr"},"–•–ê–†",-1)),r[44]||(r[44]=e("span",{class:"stat-name"},"–•–∞—Ä–∏–∑–º–∞",-1)),t.value?S((l(),o("select",{key:0,"onUpdate:modelValue":r[14]||(r[14]=c=>n.stats.har=c),onClick:r[15]||(r[15]=Q(()=>{},["stop"]))},[(l(),o(D,null,R(11,c=>e("option",{key:c-1,value:c-1},v(c-1),9,Gl)),64))],512)),[[K,n.stats.har,void 0,{number:!0}]]):(l(),o("span",Nl,v(b.character.stats?.har||0),1)),s.value&&!t.value?(l(),o("span",Bl,"üé≤ –ö–ª–∏–∫–Ω–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏")):I("",!0),(t.value?n.stats.har:b.character.stats?.har)>=5?(l(),o("div",jl,[Z(O,{content:x(m).statAbilities.har[5].description,position:"bottom"},{default:F(()=>[e("span",Xl,"üëë "+v(x(m).statAbilities.har[5].name),1)]),_:1},8,["content"]),(t.value?n.stats.har:b.character.stats?.har)>=10?(l(),Y(O,{key:0,content:x(m).statAbilities.har[10].description,position:"bottom"},{default:F(()=>[e("span",Yl,"üéñÔ∏è "+v(x(m).statAbilities.har[10].name),1)]),_:1},8,["content"])):I("",!0)])):I("",!0)],2)])]),e("div",Zl,[r[54]||(r[54]=e("h3",null,"–ë–æ–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã",-1)),e("div",Jl,[e("div",Kl,[r[46]||(r[46]=e("span",{class:"combat-label"},"–ö–î",-1)),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":r[17]||(r[17]=c=>n.armorClass=c),type:"number",min:"0"},null,512)),[[H,n.armorClass,void 0,{number:!0}]]):(l(),o("span",Ql,v(b.character.armorClass),1))]),e("div",en,[r[47]||(r[47]=e("span",{class:"combat-label"},"–ß–î",-1)),t.value?S((l(),o("select",{key:0,"onUpdate:modelValue":r[18]||(r[18]=c=>n.armorParts=c),onChange:u},[(l(),o(D,null,R(8,c=>e("option",{key:c-1,value:c-1},v(c-1),9,tn)),64))],544)),[[K,n.armorParts,void 0,{number:!0}]]):(l(),o("span",sn,v(b.character.armorParts),1))]),e("div",an,[r[48]||(r[48]=e("span",{class:"combat-label"},"–º–∞–∫—Å –°–ö–†",-1)),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":r[19]||(r[19]=c=>n.maxSpeed=c),type:"text"},null,512)),[[H,n.maxSpeed]]):(l(),o("span",ln,v(b.character.maxSpeed||"‚Äî"),1))]),e("div",nn,[r[49]||(r[49]=e("span",{class:"combat-label"},"–°–ö–†",-1)),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":r[20]||(r[20]=c=>n.currentSpeed=c),type:"text"},null,512)),[[H,n.currentSpeed]]):(l(),o("span",on,v(b.character.currentSpeed||"‚Äî"),1))]),e("div",rn,[r[50]||(r[50]=e("span",{class:"combat-label"},"–º–∞–∫—Å –û–ó",-1)),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":r[21]||(r[21]=c=>n.maxHp=c),type:"text"},null,512)),[[H,n.maxHp]]):(l(),o("span",un,v(b.character.maxHp||"‚Äî"),1))]),e("div",cn,[r[51]||(r[51]=e("span",{class:"combat-label"},"–û–ó",-1)),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":r[22]||(r[22]=c=>n.currentHp=c),type:"text"},null,512)),[[H,n.currentHp]]):(l(),o("span",dn,v(b.character.currentHp||"‚Äî"),1))]),e("div",vn,[r[52]||(r[52]=e("span",{class:"combat-label"},"–º–∞–∫—Å –†–ê–ù",-1)),e("span",pn,v(b.character.maxWounds),1)]),e("div",mn,[r[53]||(r[53]=e("span",{class:"combat-label"},"–†–ê–ù–´",-1)),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":r[23]||(r[23]=c=>n.currentWounds=c),type:"text"},null,512)),[[H,n.currentWounds]]):(l(),o("span",fn,v(b.character.currentWounds||"0"),1))])])]),e("div",bn,[r[58]||(r[58]=e("h3",null,"–õ–∏—á–Ω–æ—Å—Ç—å",-1)),e("div",yn,[e("div",gn,[r[55]||(r[55]=e("span",{class:"info-label"},"–ú–ò–†–û–í–û–ó–ó–†–ï–ù–ò–ï",-1)),t.value?(l(),o("div",hn,[e("button",{type:"button",class:z(["wv-btn",{selected:n.worldview==="order"}]),onClick:r[24]||(r[24]=c=>n.worldview="order")},"‚öñÔ∏è –ü–æ—Ä—è–¥–æ–∫",2),e("button",{type:"button",class:z(["wv-btn",{selected:n.worldview==="balance"}]),onClick:r[25]||(r[25]=c=>n.worldview="balance")},"‚òØÔ∏è –ë–∞–ª–∞–Ω—Å",2),e("button",{type:"button",class:z(["wv-btn",{selected:n.worldview==="chaos"}]),onClick:r[26]||(r[26]=c=>n.worldview="chaos")},"üåÄ –•–∞–æ—Å",2)])):(l(),o("span",{key:1,class:z(["info-value worldview-badge",b.character.worldview])},v(M[b.character.worldview]||"‚Äî"),3))]),e("div",kn,[r[56]||(r[56]=e("span",{class:"info-label"},"–ü–†–ò–ß–£–î–´",-1)),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":r[27]||(r[27]=c=>n.quirks=c),type:"text"},null,512)),[[H,n.quirks]]):(l(),o("span",wn,v(b.character.quirks||"‚Äî"),1))]),e("div",$n,[r[57]||(r[57]=e("span",{class:"info-label"},"–ß–ï–†–¢–´",-1)),t.value?S((l(),o("textarea",{key:0,"onUpdate:modelValue":r[28]||(r[28]=c=>n.traits=c),rows:"4"},null,512)),[[H,n.traits]]):(l(),o("p",Cn,v(b.character.traits||"‚Äî"),1))])])]),e("div",xn,[r[59]||(r[59]=e("h3",null,"–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å",-1)),e("div",_n,[e("div",Sn,[(l(),o(D,null,R(10,c=>e("div",{key:c,class:"inv-slot"},[e("span",Tn,v(c),1),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":_=>n.inventory[c-1]=_,type:"text",title:n.inventory[c-1]},null,8,Mn)),[[H,n.inventory[c-1]]]):(l(),o("span",{key:1,class:"inv-item",title:b.character.inventory?.[c-1]},v(b.character.inventory?.[c-1]||"‚Äî"),9,In))])),64))]),e("div",An,[(l(),o(D,null,R(10,c=>e("div",{key:c+10,class:z(["inv-slot",{penalty:c===1||c===6}])},[e("span",Un,v(c+10),1),t.value?S((l(),o("input",{key:0,"onUpdate:modelValue":_=>n.inventory[c+9]=_,type:"text",title:n.inventory[c+9]},null,8,Vn)),[[H,n.inventory[c+9]]]):(l(),o("span",{key:1,class:"inv-item",title:b.character.inventory?.[c+9]},v(b.character.inventory?.[c+9]||"‚Äî"),9,zn)),c===1?(l(),o("span",Hn,"–°–ö–† -5'")):c===6?(l(),o("span",Dn,"–°–ö–† -10'")):I("",!0)],2)),64))])])]),e("div",Rn,[r[60]||(r[60]=e("h3",null,"–ó–∞–º–µ—Ç–∫–∏",-1)),t.value?S((l(),o("textarea",{key:0,"onUpdate:modelValue":r[29]||(r[29]=c=>n.notes=c),rows:"5"},null,512)),[[H,n.notes]]):(l(),o("p",Ln,v(b.character.notes||"–ù–µ—Ç –∑–∞–º–µ—Ç–æ–∫"),1))])],2),t.value?(l(),o("div",qn,[e("button",{class:"btn-cancel",onClick:i},"–û—Ç–º–µ–Ω–∞"),e("button",{class:"btn-save",onClick:L,disabled:T.value},v(T.value?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...":"üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å"),9,En)])):I("",!0),V.value?(l(),o("div",Pn,v(V.value),1)):I("",!0)])]))}},Fn=ae(Wn,[["__scopeId","data-v-2d5b83d3"]]),On={class:"campaign-page"},Gn={key:0,class:"loading-screen"},Nn={key:1,class:"error-screen"},Bn={class:"game-header"},jn={class:"campaign-title"},Xn={class:"campaign-code",title:"–ö–æ–¥ –¥–ª—è –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"},Yn={class:"header-info"},Zn={class:"game-content"},Jn={class:"chat-panel"},Kn={__name:"CampaignPage",setup(b){const k=ot(),f=rt(),w=de(),m=ve(),$=it(),C=Ue(),A=Ce(),t=B(()=>k.params.id),T=h(!0),V=h(null),M=h("global"),n=h(!1),u=h(!1),s=h(!1),a=h(!1),d=h(null),i=h(!1),U=B(()=>A.getMyCharacters(w.user?.uid)),L=B(()=>A.characters);qe(async()=>{try{await $.getCampaign(t.value),C.subscribeToChat(t.value),A.subscribeToCharacters(t.value),T.value=!1}catch(X){V.value=X.message,T.value=!1}}),Ee(()=>{C.unsubscribeFromChat(),A.unsubscribeFromCharacters()});function W(X){M.value=X}function J(){n.value=!0}function P(){u.value=!0}function r(){i.value=!1,s.value=!0}function c(){i.value=!0,s.value=!0}function _(){s.value=!1}function G(X){d.value=X,a.value=!0,s.value=!1}function ne(){a.value=!1,d.value=null}function le(){f.push("/dashboard")}const pe=B(()=>{const X=$.currentCampaign;if(!X)return!1;const j=w.userId;return X.masterId===j||X.players?.includes(j)});return(X,j)=>(l(),o("div",On,[T.value?(l(),o("div",Gn,[...j[2]||(j[2]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–º–ø–∞–Ω–∏–∏...",-1)])])):V.value||!pe.value?(l(),o("div",Nn,[j[3]||(j[3]=e("div",{class:"error-icon"},"üö´",-1)),e("h2",null,v(V.value||"–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–º–ø–∞–Ω–∏–∏"),1),e("button",{onClick:le,class:"btn-back"},"‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è")])):(l(),o(D,{key:2},[e("header",Bn,[e("button",{class:"btn-back-small",onClick:le,title:"–ù–∞–∑–∞–¥"}," ‚Üê "),e("div",jn,[e("h1",null,v(x($).currentCampaign?.name),1),e("span",Xn," üîë "+v(x($).currentCampaign?.joinCode),1)]),e("div",Yn,[e("span",{class:z(["user-role",{"role-gm":x(m).isGM}])},v(x(m).isGM?"üé≠ GM":"‚öîÔ∏è Player"),3)])]),e("div",Zn,[Z(wt,{"campaign-id":t.value,onToggleMapType:W,onCreateToken:J,onCreateCharacter:P,onViewMyCharacters:r,onViewSheets:c},null,8,["campaign-id"]),Z(Ot,{"map-type":M.value,"campaign-id":t.value},null,8,["map-type","campaign-id"]),e("div",Jn,[Z(ns,{"campaign-id":t.value},null,8,["campaign-id"])])])],64)),n.value?(l(),Y(Ts,{key:3,"campaign-id":t.value,"map-type":M.value,onClose:j[0]||(j[0]=ye=>n.value=!1)},null,8,["campaign-id","map-type"])):I("",!0),u.value?(l(),Y(Xa,{key:4,"campaign-id":t.value,onClose:j[1]||(j[1]=ye=>u.value=!1)},null,8,["campaign-id"])):I("",!0),Z(ll,{"is-open":s.value,characters:i.value?L.value:U.value,title:i.value?"–í—Å–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏":"–ú–æ–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏","empty-message":i.value?"–ù–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –≤ –∫–∞–º–ø–∞–Ω–∏–∏":"–£ –≤–∞—Å –Ω–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π",onClose:_,onSelect:G},null,8,["is-open","characters","title","empty-message"]),a.value&&d.value?(l(),Y(Fn,{key:5,character:d.value,"campaign-id":t.value,"can-edit":!x(m).isGM&&d.value?.ownerId===x(w).user?.uid,onClose:ne,onUpdated:ne,onDeleted:ne},null,8,["character","campaign-id","can-edit"])):I("",!0)]))}},so=ae(Kn,[["__scopeId","data-v-6dadc7ad"]]);export{so as default};
